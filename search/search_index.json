{"config":{"lang":["en"],"separator":"[\\s\\u200b\\u3000\\-\u3001\u3002\uff0c\uff0e\uff1f\uff01\uff1b]+","pipeline":["stemmer"]},"docs":[{"location":"","title":"\ud83d\udc4b Hello World!","text":"<p><code>// \u6b22\u8fce\u6765\u5230\u8fd9\u4e2a\u4e0d\u592a\u6b63\u7ecf\u7684\u4ee3\u7801\u89d2\u843d // \u5982\u679c\u4f60\u5728\u5bfb\u627e\u4e00\u4e2a\u517c\u5177\u5e72\u8d27\u4e0e\u8da3\u5473\u7684\u6280\u672f\u535a\u5ba2 // \u90a3\u4e48\u606d\u559c\u4f60,\u4f60\u6765\u5bf9\u5730\u65b9\u4e86!</code></p> <p>\u6211\u662f\u4e00\u540d\u6280\u672f\u7231\u597d\u8005\u3002\u5728\u8fd9\u4e2a\u6570\u5b57\u4e16\u754c\u91cc\u65e5\u591c\u7801\u5b57\u7684\u540c\u65f6,\u4e5f\u60f3\u901a\u8fc7\u8fd9\u4e2a\u5c0f\u5929\u5730\u5206\u4eab\u4e00\u4e9b\u6280\u672f\u5fc3\u5f97\u548c\u7ecf\u9a8c\u603b\u7ed3\u3002</p>"},{"location":"#_1","title":"\ud83e\udd14 \u4e3a\u4ec0\u4e48\u8981\u5199\u8fd9\u4e2a\u535a\u5ba2?","text":"<p>\u8bf4\u5b9e\u8bdd,\u6700\u521d\u53ea\u662f\u60f3\u627e\u4e2a\u5730\u65b9\u8bb0\u5f55\u4e00\u4e0b\u81ea\u5df1\u8e29\u8fc7\u7684\u5751(\u662f\u7684,\u975e\u5e38\u591a\u7684\u5751)\u3002\u540e\u6765\u53d1\u73b0,\u539f\u6765\u81ea\u5df1\u7684\u7ecf\u9a8c\u771f\u7684\u53ef\u4ee5\u5e2e\u52a9\u5230\u5176\u4ed6\u4eba,\u4e8e\u662f\u5c31\u575a\u6301\u4e86\u4e0b\u6765\u3002</p>"},{"location":"#_2","title":"\ud83d\udcda \u8fd9\u91cc\u6709\u4ec0\u4e48?","text":"<ul> <li>\ud83d\udcdd \u6280\u672f\u6587\u7ae0 - \u4ece\u5165\u95e8\u5230\u653e\u5f03\u7684\u5168\u8fc7\u7a0b\u8bb0\u5f55</li> <li>\ud83d\udd27 \u5b9e\u7528\u5de5\u5177 - \u63d0\u9ad8\u6548\u7387\u7684\u5404\u79cd\u5c0f\u6280\u5de7</li> <li>\ud83d\udca1 \u7ecf\u9a8c\u5206\u4eab - \u8e29\u5751\u65e5\u8bb0\u548c\u89e3\u51b3\u65b9\u6848</li> <li>\ud83c\udfae \u968f\u7b14\u611f\u609f - \u7801\u519c\u7684\u65e5\u5e38\u5410\u69fd</li> </ul>"},{"location":"#_3","title":"\ud83c\udfaf \u535a\u5ba2\u7279\u8272","text":"<p><code>// \u8fd9\u4e2a\u535a\u5ba2\u7684\u7279\u70b9: // 1. \u4e0d\u88c5\u903c - \u7528\u6700\u901a\u4fd7\u7684\u8bed\u8a00\u8bb2\u6280\u672f // 2. \u6709\u6001\u5ea6 - \u5b9e\u4e8b\u6c42\u662f,\u62d2\u7edd\u7a7a\u8c08 // 3. \u91cd\u5b9e\u8df5 - \u7406\u8bba\u7ed3\u5408\u5b9e\u9645,\u6ce8\u91cd\u5e94\u7528 // 4. \u7231\u5206\u4eab - \u5f00\u6e90\u7cbe\u795e,\u77e5\u8bc6\u5171\u4eab</code></p>"},{"location":"#_4","title":"\ud83e\udd1d \u4ea4\u4e2a\u670b\u53cb?","text":"<p>\u5982\u679c\u4f60\u4e5f\u662f: - \u70ed\u7231\u6280\u672f\u7684\u6781\u5ba2 - \u559c\u6b22\u94bb\u7814\u7684\u5de5\u7a0b\u5e08 - \u6216\u8005\u5c31\u662f\u4e2a\u5bf9\u7f16\u7a0b\u611f\u5174\u8da3\u7684\u666e\u901a\u4eba</p> <p>\u90a3\u5c31\u7559\u4e0b\u6765\u770b\u770b\u5427! \u8bf4\u4e0d\u5b9a\u6211\u4eec\u80fd\u6210\u4e3a\u5fd7\u540c\u9053\u5408\u7684\u670b\u53cb\u5462~</p>"},{"location":"#_5","title":"\ud83d\udce2 \u53cb\u60c5\u63d0\u793a","text":"<p><code>// WARNING:  // \u672c\u535a\u5ba2\u542b\u6709\u5927\u91cf\u6280\u672f\u5e72\u8d27 // \u53ef\u80fd\u4f1a\u5bfc\u81f4\u6280\u672f\u6c34\u5e73\u4e0d\u81ea\u89c9\u63d0\u5347 // \u8bf7\u8c28\u614e\u9605\u8bfb</code></p> <p>\"\u4ee3\u7801\u5199\u5230\u53cc\u624b\u53d1\u8f6f,  \u5374\u4f9d\u7136\u6539\u4e0d\u5b8cBug\u7684\u65f6\u5019,  \u522b\u5fd8\u4e86\u6765\u8fd9\u91cc\u627e\u627e\u89e3\u51b3\u65b9\u6848!\"</p> <p>PS: \u5982\u679c\u4f60\u53d1\u73b0\u6587\u7ae0\u4e2d\u6709\u9519\u8bef,\u8bf7\u4e0d\u8981\u5ba2\u6c14,\u76f4\u63a5\u6307\u51fa\u6765\u3002\u6bd5\u7adf\u5728\u7a0b\u5e8f\u5458\u7684\u4e16\u754c\u91cc,\"debug\"\u5c31\u662f\u6211\u4eec\u7684\u65e5\u5e38\u5de5\u4f5c\u561b! \ud83d\ude09</p>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/01-%E5%AE%89%E8%A3%85%E4%B8%8E%E5%9F%BA%E6%9C%AC%E4%BB%8B%E7%BB%8D/","title":"\u301001\u3011\u5b89\u88c5\u4e0e\u57fa\u672c\u4ecb\u7ecd","text":"<p>\u5728\u5b89\u88c5\u67d0\u4e9b\u5f00\u6e90\u5e93\u7684\u65f6\u5019\uff0c\u5982\u679c\u6d89\u53ca\u5230\u6e90\u7801\u7f16\u8bd1\uff0c\u7ecf\u5e38\u4f1a\u4f7f\u7528 CMake \u5b8c\u6210\u6784\u5efa\u3001\u5b89\u88c5\uff0c\u521d\u6b21\u63a5\u89e6 CMake \u65f6\uff0c\u6211\u4eec\u5148\u56de\u7b54</p> <ul> <li>CMake \u662f\u4ec0\u4e48</li> <li>\u4e3a\u4ec0\u4e48\u7528 CMake</li> <li>\u600e\u4e48\u7528 CMake</li> </ul> <p>\u8fd9\u4e09\u4e2a\u95ee\u9898\u3002\u5728\u5bf9 CMake \u6709\u4e2a\u5927\u6982\u5370\u8c61\u4e4b\u540e\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u7ee7\u7eed\u63a2\u7d22\u66f4\u9ad8\u7ea7\u3001\u66f4\u73b0\u4ee3\u7684\u7528\u6cd5\u3002</p>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/01-%E5%AE%89%E8%A3%85%E4%B8%8E%E5%9F%BA%E6%9C%AC%E4%BB%8B%E7%BB%8D/#1-cmake","title":"1. CMake \u662f\u4ec0\u4e48","text":"<p>\u4e0b\u6587\u662f\u4e00\u53e5\u6765\u81ea\u767e\u5ea6\u767e\u79d1\u7684\u5b9a\u4e49\uff0c\u6211\u4eec\u7b80\u5355\u505a\u4e2a\u5206\u6bb5\uff0c\u5e76\u6682\u65f6\u5220\u9664\u4e0d\u5fc5\u8981\u7684\u5185\u5bb9\u3002</p> <ul> <li>CMake \u662f\u4e00\u4e2a\u8de8\u5e73\u53f0\u7684\u5b89\u88c5\uff08\u7f16\u8bd1\uff09\u5de5\u5177\uff0c\u53ef\u4ee5\u7528\u7b80\u5355\u7684\u8bed\u53e5\u6765\u63cf\u8ff0\u6240\u6709\u5e73\u53f0\u7684\u5b89\u88c5(\u7f16\u8bd1\u8fc7\u7a0b)</li> <li>\u4ed6\u80fd\u591f\u8f93\u51fa\u5404\u79cd\u5404\u6837\u7684 makefile \u6216\u8005 project \u6587\u4ef6</li> <li>CMake \u5e76\u4e0d\u76f4\u63a5\u5efa\u6784\u51fa\u6700\u7ec8\u7684\u8f6f\u4ef6\uff0c\u800c\u662f\u4ea7\u751f\u6807\u51c6\u7684\u5efa\u6784\u6863\uff08\u5982 Unix \u7684 Makefile \u6216 Windows Visual C++ \u7684 projects/workspaces\uff09\uff0c\u7136\u540e\u518d\u4f9d\u4e00\u822c\u7684\u5efa\u6784\u65b9\u5f0f\u4f7f\u7528</li> </ul> <p>\u9996\u5148\u6211\u4eec\u53ef\u4ee5\u660e\u786e\uff0cCMake \u662f\u4e00\u4e2a==\u8de8\u5e73\u53f0\u5de5\u5177==\u3002\u7b80\u5355\u7684\u3001\u72ed\u9698\u7684\u8bf4\uff0c\u8de8\u5e73\u53f0\u5c31\u662f\u53ef\u4ee5\u5728 Windows\u3001Linux \u53d1\u884c\u7248\u4e43\u81f3 MacOS \u7b49\u64cd\u4f5c\u7cfb\u7edf\u4e0a\u4f7f\u7528\u3002</p> <p>\u5176\u6b21\uff0cCMake \u4f7f\u7528\u4e0e Python \u6027\u8d28\u7b49\u540c\u7684\u811a\u672c\u8bed\u8a00\u3002Python \u4e00\u822c\u5728\u6267\u884c\u67d0\u4e2a <code>py</code> \u6587\u4ef6\u7684\u65f6\u5019\uff0c\u4f1a\u4f7f\u7528</p> <pre><code>python3 main.py\n</code></pre> <p>\u8fd9\u79cd\u8bed\u53e5\uff0c\u5b8c\u6210\u5bf9 <code>main.py</code> \u7684\u9010\u884c\u89e3\u6790\uff0cCMake \u540c\u6837\uff0c\u5728\u8fd0\u884c</p> <pre><code>cmake .. # .. \u5c31\u8868\u793a\u4e0a\u4e00\u7ea7\u6587\u4ef6\u5939\n</code></pre> <p>\u540e\uff0c\u53ef\u4ee5\u89e3\u6790\u6765\u81ea\u4e0a\u4e00\u7ea7\u6587\u4ef6\u5939\u4e2d <code>CMakeLists.txt</code> \u91cc\u7684\u5185\u5bb9\uff0c\u5e76\u5c06\u4ea7\u7269\u8f93\u51fa\u5230\u5f53\u524d\u6587\u4ef6\u5939\u3002\u56e0\u6b64\uff0cCMake \u89e3\u6790\u7684\u6587\u4ef6\u4e00\u822c\u90fd\u662f\u540d\u4e3a <code>CMakeLists.txt</code> \u7684\u6587\u4ef6\uff0c\u5f53\u7136\u8fd8\u6709\u5176\u4ed6\u7c7b\u578b\u7684\u6587\u4ef6\uff0c\u5728\u540e\u6587\u4f1a\u8be6\u7ec6\u4ecb\u7ecd\u3002</p> <p>\u6700\u540e\uff0c\u9700\u8981\u5f3a\u8c03\u4e00\u70b9\uff0cCMake \u5e76\u4e0d\u662f\u4e00\u4e2a\u7f16\u8bd1\u5668\uff0c\u5b83\u53ea\u662f\u4e00\u4e2a\u7f16\u8bd1\u5de5\u5177\uff0c\u6b63\u5982\u767e\u5ea6\u767e\u79d1\u6240\u8bf4\uff0cCMake \u4e0d\u76f4\u63a5\u5efa\u6784\u51fa\u6700\u7ec8\u7684\u8f6f\u4ef6\uff0cCMake \u4e3b\u8981\u4f5c\u7528\u5c31\u662f\u80fd\u591f\u4f7f\u7528\u7edf\u4e00\u7684\u8bed\u6cd5\uff0c\u5728\u7279\u5b9a\u5e73\u53f0\u4e0b\uff0c\u751f\u6210\u80fd\u591f\u6307\u5bfc\u7f16\u8bd1\u5668\u5b8c\u6210\u7f16\u8bd1\u5de5\u4f5c\u7684\u6587\u4ef6\uff0c\u8fd9\u4e00\u6587\u4ef6\u6211\u4eec\u79f0\u4e4b\u4e3a==\u5efa\u6784\u6863==\uff0c\u7528\u4e8e\u751f\u6210\u5efa\u6784\u6863\u7684\u7edf\u4e00\u8bed\u6cd5\u7684\u6587\u4ef6\uff0c\u5373 <code>CMakeLists.txt</code> \u6587\u4ef6\uff0c\u6211\u4eec\u79f0\u4e4b\u4e3a==\u7ec4\u6001\u6863==\u3002</p>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/01-%E5%AE%89%E8%A3%85%E4%B8%8E%E5%9F%BA%E6%9C%AC%E4%BB%8B%E7%BB%8D/#2-cmake","title":"2. \u4e3a\u4ec0\u4e48\u7528 CMake","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/01-%E5%AE%89%E8%A3%85%E4%B8%8E%E5%9F%BA%E6%9C%AC%E4%BB%8B%E7%BB%8D/#21","title":"2.1 \u8bed\u6cd5\u7edf\u4e00","text":"<p>\u4e0d\u540c\u7684\u5e73\u53f0\u7f16\u8bd1\u5668\u3001\u7cfb\u7edf\u73af\u5883\u3001\u53ef\u6267\u884c\u6587\u4ef6\u683c\u5f0f\u90fd\u4e0d\u76f8\u540c\uff0c\u751f\u6210\u53ef\u6267\u884c\u7a0b\u5e8f\u7684\u65b9\u5f0f\u4e5f\u4e0d\u5c3d\u76f8\u540c\uff0c\u4f8b\u5982\uff0c\u5bf9\u4e8e\u540c\u6837\u7684\u4e00\u4e2a <code>main.cpp</code></p> <ul> <li>\u5728 Ubuntu \u4e0a\uff0c\u4e00\u822c\u4f1a\u4f7f\u7528 gcc/g++ \u7f16\u8bd1\u5668\u5b8c\u6210 C/C++ \u6587\u4ef6\u7684\u7f16\u8bd1\uff0c\u6267\u884c   <pre><code>g++ main.cpp -o demo\n</code></pre>   \u6700\u7ec8\u751f\u6210\u4e00\u4e2a\u4e8c\u8fdb\u5236\u7684\u53ef\u6267\u884c\u7a0b\u5e8f <code>demo</code></li> <li>\u5728 Windows \u4e0a\uff0c\u5f97\u76ca\u4e8e Visual Studio \u5f3a\u5927\u7684 IDE\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528\u5728\u8be5 IDE \u4e0a\u96c6\u6210\u597d\u7f16\u8bd1\u5668\uff08MSVC\uff09\u5b8c\u6210\u6e90\u6587\u4ef6\u7684\u7f16\u8bd1\uff0c\u4e00\u822c\u70b9\u51fb Visual Studio \u7684\u751f\u6210\u89e3\u51b3\u65b9\u6848\uff0c\u53ef\u4ee5\u5728\u9879\u76ee\u7684\u6587\u4ef6\u5939\u4e0b\u751f\u6210\u4e00\u4e2a <code>.exe</code> \u6587\u4ef6\uff0c\u8fd9\u5c31\u662f\u5728 Windows \u4e0a\u6700\u7ec8\u751f\u6210\u7684\u4e8c\u8fdb\u5236\u53ef\u6267\u884c\u7a0b\u5e8f</li> </ul> <p>\u4f46\u4f7f\u7528 CMake \u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u7edf\u4e00\u7684\u8bed\u53e5\u751f\u6210\u5efa\u6784\u6863\u3002</p> <ul> <li>\u5728 Ubuntu \u4e0a\uff0c\u751f\u6210\u80fd\u591f\u88ab Unix makefile \u89e3\u6790\u7684 <code>Makefile</code> \u6587\u4ef6\uff0c\u8fd9\u4e00\u6587\u4ef6\u53ef\u4ee5\u6307\u5bfc gcc/g++ \u7f16\u8bd1\u5668\u5b8c\u6210\u6784\u5efa\uff08\u7f16\u8bd1\uff09\u5de5\u4f5c\uff0c<code>Makefile</code> \u6587\u4ef6\u5c31\u662f\u5efa\u6784\u6863\u3002</li> <li>\u5728 Windows \u4e0a\uff0c\u751f\u6210\u80fd\u591f\u88ab Visual Studio MSBuild \u89e3\u6790\u7684 <code>*.sln</code> \u89e3\u51b3\u65b9\u6848\u6587\u4ef6\uff0c\u8fd9\u4e00\u6587\u4ef6\u53ef\u4ee5\u6307\u5bfc MSVC \u7f16\u8bd1\u5668\u5b8c\u6210\u6784\u5efa\uff08\u7f16\u8bd1\uff09\u5de5\u4f5c\uff0c<code>*.sln</code> \u6587\u4ef6\u5c31\u662f\u5efa\u6784\u6863\u3002</li> </ul>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/01-%E5%AE%89%E8%A3%85%E4%B8%8E%E5%9F%BA%E6%9C%AC%E4%BB%8B%E7%BB%8D/#22","title":"2.2 \u529f\u80fd\u5f3a\u5927","text":"<p>\u8fc4\u4eca\u4e3a\u6b62\uff0cCMake <code>3.x</code> \u7cfb\u5217\u5df2\u7ecf\u53d1\u5e03\u4e86\u8d85\u8fc7 30 \u4e2a\u7248\u672c\uff0c\u622a\u81f3 <code>2024/11/29</code> \u7684\u6700\u65b0\u7248\u672c\u662f <code>3.31.1</code>\uff0c\u540e\u7eed\u7684\u4ecb\u7ecd\u5747\u4ee5 <code>3.16</code> \u4e3a\u6700\u5c0f\u7248\u672c\u3002\u901a\u8fc7 CMake \u53ef\u4ee5\u5728\u751f\u6210\u5efa\u6784\u6863\u4e4b\u524d\u5b9e\u73b0</p> <ul> <li>\u7b2c\u4e09\u65b9\u4f9d\u8d56\u5e93\u7684\u4e0b\u8f7d\u3001\u5305\u542b</li> <li>\u6587\u4ef6\u89e3\u6790\u3001\u751f\u6210</li> <li>C/C++ \u5b8f\u7684\u751f\u6210</li> </ul>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/01-%E5%AE%89%E8%A3%85%E4%B8%8E%E5%9F%BA%E6%9C%AC%E4%BB%8B%E7%BB%8D/#3-cmake","title":"3. \u600e\u4e48\u7528 CMake","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/01-%E5%AE%89%E8%A3%85%E4%B8%8E%E5%9F%BA%E6%9C%AC%E4%BB%8B%E7%BB%8D/#31","title":"3.1 \u5b89\u88c5","text":"<p>\u9996\u5148\u5b89\u88c5 CMake\uff0c\u8fd9\u91cc\u7ed9\u51fa\u4e24\u79cd\u5b89\u88c5\u65b9\u5f0f</p>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/01-%E5%AE%89%E8%A3%85%E4%B8%8E%E5%9F%BA%E6%9C%AC%E4%BB%8B%E7%BB%8D/#311","title":"3.1.1 \u8f6f\u4ef6\u6e90\u5b89\u88c5","text":"<p>\u8fd9\u79cd\u5b89\u88c5\u65b9\u5f0f\u6700\u5feb\uff0c\u4f46\u7248\u672c\u6bd4\u8f83\u53d7\u9650\uff0c\u5728\u8f83\u65b0\u7684 Linux \u53d1\u884c\u7248\u4e0a\u7248\u672c\u4f1a\u65b0\u4e00\u70b9\u3002\u8fd9\u91cc\u4ee5 Debian \u7cfb\u53d1\u884c\u7248\u4e3a\u4f8b\uff0c\u53ef\u4f7f\u7528 APT \u5305\u7ba1\u7406\u5de5\u5177\u8fdb\u884c\u5b89\u88c5</p> <pre><code>sudo apt install cmake cmake-qt-gui cmake-curses-gui\n</code></pre> <p>\u6765\u5b89\u88c5 CMake \u5de5\u5177\uff0c\u4f8b\u5982\uff0c\u5728 Ubuntu</p> <ul> <li>18.04 \u4e0b\uff0c\u5bf9\u5e94\u7684\u7248\u672c\u4e3a <code>3.10</code></li> <li>20.04 \u4e0b\uff0c\u5bf9\u5e94\u7684\u7248\u672c\u4e3a <code>3.16</code></li> <li>22.04 \u4e0b\uff0c\u5bf9\u5e94\u7684\u7248\u672c\u4e3a <code>3.22</code></li> </ul>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/01-%E5%AE%89%E8%A3%85%E4%B8%8E%E5%9F%BA%E6%9C%AC%E4%BB%8B%E7%BB%8D/#312","title":"3.1.2 \u4e0b\u8f7d\u4e8c\u8fdb\u5236\u5305","text":"<p>\u53ef\u76f4\u63a5\u5728 Github \u4e2d\u6253\u5f00 CMake Release\uff0c\u627e\u5230\u4f60\u60f3\u4e0b\u8f7d\u7684\u7248\u672c\uff0c\u70b9\u51fb\u5bf9\u5e94\u7684\u538b\u7f29\u5305\uff0c\u4f8b\u5982\u5728 x64 \u73af\u5883\u4e0b\u7684 Linux \u53ef\u9009\u62e9 <code>cmake-x.xx.x-linux-x86_64.tar.gz</code>\uff0c\u4e0b\u8f7d\u540e\u8fdb\u884c\u89e3\u538b\uff0c\u5c31\u5f97\u5230\u4e86\u6240\u6709 CMake \u5de5\u5177\u3002\u6b64\u5916\uff0c\u53ef\u81ea\u884c\u5b89\u88c5\u5230\u7cfb\u7edf\u8def\u5f84\u4e0b\uff0c\u4ee5 <code>cmake-3.29.0-linux-x86_64.tar.gz</code> \u4e3a\u4f8b\uff0c\u53ef\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4</p> <pre><code>tar xf cmake-3.29.0-linux-x86_64.tar.gz # \u89e3\u538b\ncd cmake-3.29.0-linux-x86_64\nsudo cp -r * /usr/local                 # \u5b89\u88c5\u81f3 /usr/local\n</code></pre> <p>Tip</p> <p>Windows \u7528\u6237\u53ef\u5728 CMake \u5b98\u7f51 \u4e0b\u8f7d\u5bf9\u5e94\u7684 <code>*.msi</code> \u5b89\u88c5\u5305\uff0c\u5b89\u88c5\u5b8c\u6210\u540e\uff0c\u5c31\u53ef\u4ee5\u5728\u547d\u4ee4\u884c\u4e2d\u4f7f\u7528 <code>cmake</code> \u547d\u4ee4\u4e86\u3002</p>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/01-%E5%AE%89%E8%A3%85%E4%B8%8E%E5%9F%BA%E6%9C%AC%E4%BB%8B%E7%BB%8D/#32-cmake","title":"3.2 CMake \u751f\u6210\u5efa\u6784\u6863\u7684\u6b65\u9aa4","text":"<p>\u7136\u540e\u6211\u4eec\u518d\u5bf9\u4e0a\u6587\u901a\u8fc7<code>main.cpp</code>\u751f\u6210\u5efa\u6784\u6863\u7684\u8fc7\u7a0b\u505a\u4e2a\u4ecb\u7ecd\uff0c\u4e86\u89e3 CMake \u751f\u6210\u5efa\u6784\u6863\u7684\u57fa\u672c\u6b65\u9aa4\u3002</p> <p>\u9996\u5148\u5728<code>main.cpp</code>\u540c\u7ea7\u76ee\u5f55\u4e0b\u521b\u5efa<code>CMakeLists.txt</code>\u6587\u4ef6\uff0c\u8fd9\u5c31\u662f CMake \u751f\u6210\u5efa\u6784\u6863\u6240\u53c2\u8003\uff08\u89e3\u6790\uff09\u7684\u6587\u4ef6\uff0c\u5e76\u5728\u5176\u4e2d\u5199\u5165</p> <pre><code># \u6307\u5b9a CMake \u7684\u6700\u5c0f\u7248\u672c\u53f7\uff0c\u4f4e\u4e8e\u6b64\u7248\u672c\u7684 CMake \u5c06\u7ec8\u6b62\u5efa\u6784\u6863\u7684\u751f\u6210\u8fc7\u7a0b\ncmake_minimum_required(VERSION 3.16)\n\n# \u521b\u5efa\u9879\u76ee\nproject(\n  Demo          # \u8bbe\u7f6e\u9879\u76ee\u540d\n  LANGUAGES CXX # \u6307\u5b9a\u8bed\u8a00\uff0c\u672a\u6307\u5b9a\u7684\u8bed\u8a00\u5c06\u4e0d\u53c2\u4e0e\u6784\u5efa\uff0c\u4f8b\u5982 test.c \u6587\u4ef6\n)\n\n# \u521b\u5efa\u53ef\u6267\u884c\u6587\u4ef6\nadd_executable(\n  demo     # \u76ee\u6807\u540d\n  main.cpp # \u7528\u5230\u7684\u6e90\u6587\u4ef6\n)\n</code></pre> <p>\u521b\u5efa\u597d\u540e\uff0c\u5728\u9879\u76ee\u4e0b\u521b\u5efa<code>build</code>\u6587\u4ef6\u5939\uff0c\u5728\u8be5\u6587\u4ef6\u5939\u4e0b\u6253\u5f00\u7ec8\u7aef\uff08Windows \u4e0b\u53ef\u4ee5\u662f PowerShell\uff09\uff0c\u8f93\u5165</p> <pre><code>cmake ..\n</code></pre> <p>\u5373\u53ef\u5728\u5f53\u524d\u6587\u4ef6\u5939\u4e0b\u751f\u6210\u5bf9\u5e94\u7684\u5efa\u6784\u6863\u3002</p> <p>\u4ee5\u4e0a\u5c31\u662f\u5229\u7528 CMake \u751f\u6210\u5efa\u6784\u6863\u7684\u57fa\u672c\u6d41\u7a0b\uff0c\u8fd9\u91cc\u9700\u8981\u6ce8\u610f\u5728<code>add_executable</code>\u4e2d\u6211\u4eec\u6d89\u53ca\u5230\u4e86\u4e00\u4e2a\u65b0\u7684\u540d\u8bcd\uff1a\u76ee\u6807\uff08target\uff09\uff0c\u76ee\u6807\u662f CMake \u62bd\u8c61\u51fa\u6765\u7684\u4e00\u4e2a\u6982\u5ff5\uff0c\u53ef\u4ee5\u7b80\u5355\u7684\u7406\u89e3\u4e3a\u5177\u6709</p> <ul> <li>\u540d\u79f0</li> <li>\u5305\u542b\u7684\u6587\u4ef6\u5939</li> <li>\u5176\u4f59\u7f16\u8bd1\u5c5e\u6027</li> <li>\u4f9d\u8d56\u7684\u5176\u4ed6\u76ee\u6807</li> </ul> <p>\u7684\u4e00\u4e2a\u7c7b\uff0c\u53ef\u4ee5\u4f7f\u7528C++\u7684\u7c7b\u6765\u63cf\u8ff0\u76ee\u6807\u8fd9\u4e00\u6982\u5ff5</p> <pre><code>// CMake \u76ee\u6807\nstruct Target\n{\n    string name;                        // \u540d\u79f0\n    vector&lt;string&gt; include_directories; // \u5305\u542b\u7684\u6587\u4ef6\u5939\n    vector&lt;string&gt; properties;          // \u5176\u4f59\u7f16\u8bd1\u5c5e\u6027\n    vector&lt;Target *&gt; targets;           // \u4f9d\u8d56\u7684\u5176\u4ed6\u76ee\u6807\n};\n</code></pre> <p>\u901a\u8fc7\u4e0a\u6587\u53ef\u4ee5\u5f97\u77e5\uff0c\u76ee\u6807\u5177\u6709\u4f9d\u8d56\u5173\u7cfb\uff0c\u56e0\u6b64\u76ee\u6807\u4e0d\u4ec5\u53ea\u6709\u53ef\u6267\u884c\u6587\u4ef6\u8fd9\u4e00\u5f62\u5f0f\uff0c\u8fd8\u5177\u6709\u522b\u7684\u5f62\u5f0f\uff0c\u5728\u301005\u3011\u76ee\u6807\u6784\u5efa\u4f1a\u8be6\u7ec6\u7ed9\u51fa\u76ee\u6807\u5305\u542b\u7684\u5185\u5bb9\u3002</p> <p>Tip</p> <p>CMake \u751f\u6210\u5efa\u6784\u6863\u7684\u8fc7\u7a0b\u53ef\u4ee5\u7b80\u5355\u6982\u62ec\u6210</p> <ol> <li>\u521b\u5efa\u9879\u76ee</li> <li>\u76ee\u6807\u6784\u5efa</li> <li>\u5bfc\u51fa\u914d\u7f6e\uff08\u5982\u679c\u6709\u5b89\u88c5\u7684\u9700\u6c42\uff0c\u5219\u9700\u8981\u505a\uff09</li> </ol> <p>\u8be6\u7ec6\u7684\u5185\u5bb9\u4f1a\u5728\u540e\u6587\u4ecb\u7ecd\u3002</p> <p>\u00b7\u00b7\u00b7</p>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/02-CMake%20%E7%9A%84%E6%96%87%E4%BB%B6%E5%88%86%E5%B8%83/","title":"\u301002\u3011CMake \u7684\u6587\u4ef6\u5206\u5e03","text":"<p>\u5728\u6b63\u5f0f\u5f00\u59cb\u5b66\u4e60 CMake \u4e4b\u524d\uff0c\u9700\u8981\u6e05\u695a CMake \u6587\u4ef6\u4e00\u822c\u5728\u9879\u76ee\u4e2d\u662f\u5982\u4f55\u5206\u5e03\u7684\uff0c\u53ea\u6709\u6e05\u695a\u5404\u4e2a\u6587\u4ef6\u662f\u5982\u4f55\u5206\u5e03\u7684\uff0c\u624d\u80fd\u6b63\u786e\u4e14\u5408\u7406\u7684\u4e66\u5199 <code>CMakeLists.txt</code> \u6587\u4ef6\u3002</p>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/02-CMake%20%E7%9A%84%E6%96%87%E4%BB%B6%E5%88%86%E5%B8%83/#1-cmakeliststxt","title":"1. \u6309\u6a21\u5757\u5206\u5c42\u7684 CMakeLists.txt","text":"<p>\u4e00\u822c\u6765\u8bf4\uff0c\u81ea\u5df1\u5728\u4f7f\u7528 CMake \u7684\u65f6\u5019\uff0c\u5982\u679c\u9879\u76ee\u4e0d\u5927\uff0c\u5f80\u5f80\u90fd\u559c\u6b22\u4ec5\u4f7f\u7528\u4e00\u4e2a <code>CMakeLists.txt</code> \u6765\u7ba1\u7406\u6240\u6709\u7684\u5c5e\u6027\u914d\u7f6e\u3002\u4f46\u968f\u7740\u9879\u76ee\u8d8a\u505a\u8d8a\u5927\uff0c\u4e00\u4e2a <code>CMakeLists.txt</code> \u5728\u53ef\u8bfb\u6027\u3001\u53ef\u7ef4\u62a4\u6027\u4e0a\u90fd\u4f1a\u6709\u6240\u964d\u4f4e\u3002\u4e3a\u6b64\u9700\u8981\u5bf9\u6bcf\u4e2a\u7279\u5b9a\u7684\u6a21\u5757\u7f16\u5199 <code>CMakeLists.txt</code>\u3002\u53ef\u4ee5\u53c2\u8003 OpenCV \u7684 <code>CMakeLists.txt</code> \u5e03\u5c40\u3002</p> <pre><code>.\n\u251c\u2500\u2500 cmake\n\u2502   \u2514\u2500\u2500 ...\n\u251c\u2500\u2500 CMakeLists.txt\n\u251c\u2500\u2500 include\n\u2502   \u251c\u2500\u2500 CMakeLists.txt (\u7528\u4e8e\u5168\u5c40\u5305\u542b\u7684 opencv.hpp \u7684\u5bfc\u51fa)\n\u2502   \u2514\u2500\u2500 ...\n\u251c\u2500\u2500 modules\n\u2502   \u2514\u2500\u2500 core\n\u2502       \u251c\u2500\u2500 CMakeLists.txt\n\u2502       \u251c\u2500\u2500 include\n\u2502       \u2502   \u2514\u2500\u2500 ...\n\u2502       \u251c\u2500\u2500 src\n\u2502       \u2502   \u2514\u2500\u2500 ...\n\u2502       \u2514\u2500\u2500 test\n\u2502           \u2514\u2500\u2500 ...\n\u251c\u2500\u2500 README.md\n\u2514\u2500\u2500 samples\n</code></pre> <p>\u5f88\u663e\u7136\uff0c\u6bcf\u7ea7\u6a21\u5757\uff08\u76ee\u5f55\uff09\u7684\u6587\u4ef6\u5939\u4e0b\u90fd\u4f1a\u5b58\u5728\u4e00\u4e2a <code>CMakeLists.txt</code>\u3002</p> <ul> <li>\u6700\u5e95\u5c42\u7684 <code>CMakeLists.txt</code> \u662f\u4e3a\u4e86\u7ba1\u7406\u8be5\u6a21\u5757\u529f\u80fd\u7684\u7f16\u8bd1\u3001\u6d4b\u8bd5\u6587\u4ef6\u7f16\u8bd1\uff0c\u4ee5\u53ca\u63d0\u4f9b\u6307\u5b9a\u7684\u63a5\u53e3\uff08\u53ef\u4ee5\u662f\u5e93\uff0c\u4e5f\u53ef\u4ee5\u662f\u82e5\u5e72 CMake \u53d8\u91cf\uff09\u7ed9\u5916\u90e8\u3002OpenCV \u4e2d\u4f7f\u7528\u8bed\u53e5 <code>ocv_add_module()</code> \u6765\u6dfb\u52a0\u6a21\u5757\u3002\u4f8b\u5982\uff1a</li> </ul> <pre><code># \u5b9a\u4e49\u4e8e &lt;opencv-path&gt;/modules/core/CMakeLists.txt \u4e2d\u7684\u5185\u5bb9\nocv_add_module(core\n               OPTIONAL opencv_cudev\n               WRAP java objc python js)\n</code></pre> <p>\u8fd9\u4e2a\u8bed\u53e5\u5e76\u4e0d\u662f CMake \u539f\u751f\u8bed\u6cd5\u4e2d\u81ea\u5e26\u7684\uff0c\u800c\u662f\u9879\u76ee\u81ea\u884c\u8bbe\u8ba1\u7684\u5b8f\u3002CMake \u4e2d\u7684\u5b8f\u4e0eC/C++\u4e2d\u4f7f\u7528 <code>#define</code> \u521b\u5efa\u7684\u5b8f\u539f\u7406\u7c7b\u4f3c\uff0c\u90fd\u662f\u8d77\u5230\u4e86\u6587\u672c\u66ff\u6362\u7684\u4f5c\u7528\u3002\u6839\u636e\u8fd9\u4e2a\u5b8f\u4ee5\u53ca\u6b64 <code>CMakeLists.txt</code> \u7684\u5176\u4f59\u529f\u80fd\uff0c\u53ef\u4ee5\u521b\u5efa\u8be5 <code>core</code> \u6a21\u5757\u7684\u76ee\u6807\uff1a<code>opencv_core</code>\uff0c\u5e76\u4e3a\u6b64\u6dfb\u52a0\u5408\u9002\u7684\u4f9d\u8d56\u9879\u3002</p> <ul> <li>OpenCV 4.x \u7cfb\u5217\u7248\u672c\u8bbe\u7f6e\u4e24\u7ea7\u76ee\u5f55\u7684 <code>CMakeList.txt</code>\u3002\u6839\u76ee\u5f55\u4e0b\u5373\u6700\u9ad8\u7ea7\u76ee\u5f55\u7684 <code>CMakeLists.txt</code> \u4e00\u822c\u662f\u5bf9\u4e8e\u6574\u4e2a\u9879\u76ee\u6709\u5173\u7f16\u8bd1\u9009\u9879\u7684\u8bbe\u7f6e\uff0c\u4ee5\u53ca\u5bf9\u7cfb\u7edf\u3001\u5e73\u53f0\u3001\u7f16\u8bd1\u5668\u7b49\u7f16\u8bd1\u73af\u5883\u4fe1\u606f\u7684\u517c\u5bb9\u5904\u7406\u3002OpenCV \u9879\u76ee\u6839\u76ee\u5f55\u7684 <code>CMakeLists.txt</code> \u524d\u4e00\u5927\u6bb5\u90fd\u662f\u5728\u5bf9\u5f53\u524d\u5e73\u53f0\u3001\u7f16\u8bd1\u914d\u7f6e\u7684\u4fe1\u606f\u505a\u5904\u7406\uff0c\u4f8b\u5982\uff1a</li> </ul> <pre><code># \u5b9a\u4e49\u4e8e &lt;opencv-path&gt;/CMakeLists.txt \u4e2d\u7684\u5185\u5bb9\nif(CMAKE_SYSTEM_NAME MATCHES WindowsPhone OR CMAKE_SYSTEM_NAME MATCHES WindowsStore)\n  cmake_minimum_required(VERSION 3.1 FATAL_ERROR)\n  cmake_policy(VERSION 2.8)\nelse()\n  cmake_minimum_required(VERSION \"${MIN_VER_CMAKE}\" FATAL_ERROR)\nendif()\n</code></pre>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/02-CMake%20%E7%9A%84%E6%96%87%E4%BB%B6%E5%88%86%E5%B8%83/#2-cmake","title":"2. \u5176\u4f59 CMake \u6587\u4ef6","text":"<p>CMake \u4e2d\u9664\u4e86\u89e3\u6790 CMakeLists.txt \u6587\u4ef6\uff0c\u8fd8\u5141\u8bb8\u89e3\u6790\u6269\u5c55\u540d\u4e3a <code>.cmake</code> \u7684\u6587\u4ef6\u3002\u4e00\u822c\u6709\u4e24\u79cd\u64cd\u4f5c\u53ef\u4ee5\u5bf9\u8fd9\u7c7b\u6587\u4ef6\u8fdb\u884c\u8bbf\u95ee\uff0c\u5206\u522b\u662f</p> <ol> <li><code>find_package()</code>\uff0c\u7528\u4e8e\u53d1\u73b0\u7b2c\u4e09\u65b9\u4f9d\u8d56\u5e93</li> <li><code>include()</code>\uff0c\u7528\u4e8e\u5305\u542b\u672c\u5730\u7684\u6216 CMake \u6807\u51c6\u4e2d\u63d0\u4f9b\u7684 <code>*.cmake</code> \u6587\u4ef6\uff0c\u4e00\u822c\u8fd9\u7c7b\u6587\u4ef6\u4f1a\u63d0\u4f9b\u4e00\u7cfb\u5217\u5b8f\u6216\u51fd\u6570\u6765\u8f85\u52a9\u6211\u4eec\u5b8c\u6210\u5efa\u6784\u6863\u7684\u751f\u6210\u3002</li> </ol> <p>\u5176\u4e2d\u7b2c\u4e00\u79cd\u65b9\u6848\u4f1a\u5728\u301008\u3011find_package \u8be6\u89e3\u4e2d\u4ecb\u7ecd\u3002</p>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/02-CMake%20%E7%9A%84%E6%96%87%E4%BB%B6%E5%88%86%E5%B8%83/#21-cmake","title":"2.1 <code>*.cmake</code> \u6587\u4ef6","text":"<p>OpenCV \u4e2d\uff0c\u81ea\u5b9a\u4e49\u7684<code>*.cmake</code>\u6587\u4ef6\u5168\u90e8\u5b58\u653e\u5728<code>&lt;opencv-path&gt;/cmake</code>\u6587\u4ef6\u5939\u4e0b\uff0c\u5e38\u89c1\u7684\u540d\u79f0\u6709</p> <ul> <li><code>Findxxx.cmake</code></li> <li><code>OpenCVxxx.cmake</code></li> </ul> <p>\u7b2c\u4e00\u79cd\u662f\u672c\u5730\u9879\u76ee\u4e2d\u7528\u4e8e <code>find_package()</code> \u7684\uff0c\u4f8b\u5982 FindONNX.cmake \u7b49\u6587\u4ef6\u3002\u7b2c\u4e8c\u79cd\u5219\u662f\u6dfb\u52a0\u4e86\u5404\u79cd\u5404\u6837\u7684\u80fd\u591f\u51cf\u5c11\u91cd\u590d\u64cd\u4f5c\u7684\u5b8f\u4e0e\u51fd\u6570\uff0c<code>ocv_add_module()</code> \u5c31\u662f\u5176\u4e2d\u4e4b\u4e00\uff0c\u4ed6\u88ab\u5b9a\u4e49\u5728 <code>OpenCVModule.cmake</code> \u4e2d\uff0c\u8fd9\u79cd\u4e00\u822c\u9700\u8981\u6267\u884c <code>include()</code> \u64cd\u4f5c\uff0c\u4f8b\u5982\uff1a</p> <pre><code># \u5b9a\u4e49\u4e8e &lt;opencv-path&gt;/CMakeLists.txt \u4e2d\u7684\u5185\u5bb9\n# --- OpenCL ---\nif(WITH_OPENCL)\n  include(cmake/OpenCVDetectOpenCL.cmake)\nendif()\n\n# --- Halide ---\nif(WITH_HALIDE)\n  include(cmake/OpenCVDetectHalide.cmake)\nendif()\n\n# --- VkCom ---\nif(WITH_VULKAN)\n  include(cmake/OpenCVDetectVulkan.cmake)\nendif()\n\n# --- WebNN ---\nif(WITH_WEBNN)\n  include(cmake/OpenCVDetectWebNN.cmake)\nendif()\n</code></pre>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/02-CMake%20%E7%9A%84%E6%96%87%E4%BB%B6%E5%88%86%E5%B8%83/#22-in","title":"2.2 <code>*.in</code> \u6587\u4ef6","text":"<p><code>*.in</code> \u6a21\u677f\u6587\u4ef6\u4e00\u822c\u662f\u7528\u4e8e\u5728 cmake \u6267\u884c\u9636\u6bb5\uff08\u51c6\u786e\u6765\u8bf4\uff0c\u5e94\u8be5\u662f\u914d\u7f6e\u9636\u6bb5\uff09\u5c06\u5176\u5d4c\u5165\u7684 CMake \u53d8\u91cf\u3001\u5217\u8868\u5c55\u5f00\uff0c\u5e76\u751f\u6210\u76ee\u6807\u6587\u4ef6\u7684\u8fc7\u7a0b\u4e2d\u7684\u3002\u8fd9\u4e00\u6b65\u901a\u5e38\u662f\u7531 <code>configure_file()</code> \u5b8c\u6210\uff0c\u4f1a\u5728\u301006\u3011\u53d8\u91cf\u53c2\u4e0e C++ \u7684\u7f16\u8bd1 \u4e2d\u8fdb\u884c\u4ecb\u7ecd\u3002<code>*.in</code> \u7684\u540e\u7f00\u662f\u7ea6\u5b9a\u4fd7\u6210\u7684\uff0c\u5f53\u7136\u4e5f\u53ef\u4ee5\u4f7f\u7528\u5176\u4ed6\u5f62\u5f0f\u7684\u540e\u7f00\u3002</p> <p>OpenCV\u4e2d\u7684\u6b64\u7c7b\u6587\u4ef6\u4e00\u822c\u653e\u5728 <code>&lt;opencv-path&gt;/cmake/template</code> \u6587\u4ef6\u5939\u4e0b\uff0c\u4e3b\u8981\u662f\u7528\u4e8e\u5728\u6267\u884c</p> <pre><code>cmake ..\n</code></pre> <p>\u7684\u65f6\u5019\u5c06\u6a21\u677f\u6587\u4ef6\u8f6c\u6362\u4e3a\u5177\u4f53\u7684\u6587\u4ef6\u3002\u53e6\u5916\uff0c\u5728</p> <pre><code>cmake --install .\n</code></pre> <p>\u7684\u65f6\u5019\u4f1a\u5c06\u751f\u6210\u7684 <code>OpenCVConfig.cmake</code> \u7b49\u4e00\u7cfb\u5217\u6587\u4ef6\u5b89\u88c5\u81f3\u76ee\u6807\u8def\u5f84\u4e0b\uff0c\u800c <code>OpenCVConfig.cmake</code> \u6587\u4ef6\u7684\u4ea7\u751f\uff0c\u5c31\u9700\u8981 <code>&lt;opencv-path&gt;/cmake/template</code> \u6587\u4ef6\u5939\u4e0b\u7684 <code>OpenCVConfig.cmake.in</code> \u6587\u4ef6\u3002</p> <p>::: important \u603b\u7ed3 1. \u9879\u76ee\u7684\u6839\u76ee\u5f55\u4ee5\u53ca\u5404\u6a21\u5757\u90fd\u4f1a\u7ba1\u7406\u4e00\u4e2a <code>CMakeLists.txt</code> \u6587\u4ef6 2. CMake \u8fd8\u4f1a\u89e3\u6790 <code>*.cmake</code> \u540e\u7f00\u7684\u6587\u4ef6 3. <code>*.in</code> \u6587\u4ef6\u4e00\u822c\u4f5c\u4e3a\u6a21\u677f\u6587\u4ef6\uff0c\u4e00\u822c\u5728 CMake \u89e3\u6790\u671f\u95f4\u8f6c\u6362\u4e3a\u5177\u4f53\u7684\u6587\u4ef6 :::</p>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/03-%E5%8F%98%E9%87%8F%E7%9A%84%E8%AE%BE%E7%BD%AE%E4%B8%8E%E5%BC%95%E7%94%A8/","title":"\u301003\u3011\u53d8\u91cf\u7684\u8bbe\u7f6e\u4e0e\u5f15\u7528","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/03-%E5%8F%98%E9%87%8F%E7%9A%84%E8%AE%BE%E7%BD%AE%E4%B8%8E%E5%BC%95%E7%94%A8/#1","title":"1. \u524d\u8a00","text":"<p>\u4ece\u6e90\u7801\u7f16\u8bd1 OpenCV \u65f6\u90fd\u4f1a\u7528\u5230 CMake \u4e2d\u7684\u53d8\u91cf\uff0c\u5e76\u4e14\u8fd8\u7ecf\u5e38\u901a\u8fc7\u8fd9\u4e9b\u53d8\u91cf\u6765\u4e3a OpenCV \u9879\u76ee\u7684\u6784\u5efa\u3001\u5b89\u88c5\u8fc7\u7a0b\u8fdb\u884c\u914d\u7f6e\u3002\u914d\u7f6e\u7684\u8fc7\u7a0b\u4e2d\uff0c\u5982\u4f55\u5411\u7528\u6237\u5c55\u793a\u5fc5\u8981\u7684\u53c2\u6570\u4ee5\u53ca\u5c4f\u853d\u4e00\u4e9b\u5c40\u90e8\u4f7f\u7528\u7684\u53c2\u6570\u663e\u5f97\u5341\u5206\u91cd\u8981\u3002</p> <p>C++ \u4e2d\u7684\u53d8\u91cf\u5177\u5907\u81ea\u52a8\u5b58\u50a8\u671f\u3001\u9759\u6001\u5b58\u50a8\u671f\u3001\u7ebf\u7a0b\u5b58\u50a8\u671f\u4ee5\u53ca\u52a8\u6001\u5b58\u50a8\u671f\uff0cCMake \u4e5f\u5177\u6709\u7c7b\u4f3c\u7684\u6548\u679c\uff0c\u53d8\u91cf\u5728\u5212\u5206\u4e0a\u5177\u6709</p> <ul> <li>\u666e\u901a\u53d8\u91cf</li> <li>\u7f13\u5b58\u53d8\u91cf</li> <li>\u73af\u5883\u53d8\u91cf</li> </ul> <p>3 \u79cd\uff0c\u6b64\u5185\u5bb9\u7684\u8be6\u7ec6\u63cf\u8ff0\u53ef\u53c2\u8003\u53d8\u91cf\u3002</p>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/03-%E5%8F%98%E9%87%8F%E7%9A%84%E8%AE%BE%E7%BD%AE%E4%B8%8E%E5%BC%95%E7%94%A8/#2","title":"2. \u666e\u901a\u53d8\u91cf","text":"<p>\u6b64\u7c7b\u53d8\u91cf\u5177\u6709\u4e0eC/C++\u8bed\u8a00\u4e2d\u7684\u81ea\u52a8\u5b58\u50a8\u671f\u7c7b\u4f3c\u7684\u6548\u679c\uff0c\u4e00\u822c\u60c5\u51b5\u4e0b\uff0c</p> <ul> <li>\u5728\u51fd\u6570<code>function</code>\u4e2d\u521b\u5efa\u7684\u53d8\u91cf\u4e0d\u4f1a\u5728\u51fd\u6570\u4ee5\u5916\u751f\u6548\u6216\u88ab\u8bbf\u95ee\uff0c\u53ef\u7c7b\u6bd4 C/C++ \u7684\u51fd\u6570\uff1b</li> <li><code>CMakeLists.txt</code>\u53ef\u4ee5\u7ee7\u627f\u7236\u76ee\u5f55\u6587\u4ef6\u4e2d\u5b9a\u4e49\u7684\u53d8\u91cf\uff0c\u5728\u5904\u7406<code>CMakeLists.txt</code>\u6587\u4ef6\u4e4b\u524d\uff0cCMake \u4f1a\u590d\u5236\u7236\u76ee\u5f55\u4e2d\u5b9a\u4e49\u7684\u6240\u6709\u53d8\u91cf\uff08\u5982\u679c\u6709\uff09\uff0c\u4ee5\u521d\u59cb\u5316\u5f53\u524d\u4f5c\u7528\u57df\u3002</li> </ul>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/03-%E5%8F%98%E9%87%8F%E7%9A%84%E8%AE%BE%E7%BD%AE%E4%B8%8E%E5%BC%95%E7%94%A8/#21","title":"2.1 \u5b9a\u4e49","text":"<p>\u4e00\u822c\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u5373\u53ef\u5b9a\u4e49\u4e00\u4e2a\u666e\u901a\u53d8\u91cf</p> <pre><code>set(val1 \"aaa\")    # val1 \u5185\u5bb9\u4e3a 1 \u4e2a\u503c\uff1aaaa\nset(val2 \"bb\" bbb) # val2 \u5185\u5bb9\u4e3a 2 \u4e2a\u503c\uff1abb;bbb\nset(val3 aa;bb)    # val3 \u5185\u5bb9\u4e3a 2 \u4e2a\u503c\uff1aaa;bb\nset(val4 aa;bb cc) # val4 \u5185\u5bb9\u4e3a 3 \u4e2a\u503c\uff1aaa;bb;cc\n</code></pre> <p>::: warning 1. \u5373\u4f7f <code>bbb</code> \u4e0d\u52a0 <code>\"\"</code> \u53f7\uff0c\u4e5f\u8868\u793a\u4e00\u4e2a\u5b57\u7b26\u4e32\uff0c\u56e0\u4e3a CMake \u7684\u53d8\u91cf\u59cb\u7ec8\u662f\u5b57\u7b26\u4e32\u7c7b\u578b\u7684\uff0c\u4f46\u4e0d\u59a8\u788d\u67d0\u4e9b\u547d\u4ee4\u53ef\u4ee5\u5c06\u5176\u89e3\u91ca\u4e3a\u5176\u4ed6\u7c7b\u578b\uff1b 2. \u5efa\u8bae\u53d8\u91cf\u7684\u5185\u5bb9\u8981\u4e48\u90fd\u4f7f\u7528\u5f15\u53f7 <code>\"\"</code>\uff0c\u8981\u4e48\u90fd\u4e0d\u4f7f\u7528\uff0c\u4f8b\u5982 <code>val2</code> \u7684\u5199\u6cd5\u5c31\u4e0d\u597d 3. \u53d8\u91cf\u5185\u5bb9\u53ef\u4ee5\u901a\u8fc7\u7a7a\u683c <code></code> \u6216\u8005\u5206\u53f7 <code>;</code> \u8fdb\u884c\u5206\u9694\uff0c\u4e5f\u53ef\u4ee5\u6df7\u7528\uff0c\u4f8b\u5982 <code>val4</code> :::</p>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/03-%E5%8F%98%E9%87%8F%E7%9A%84%E8%AE%BE%E7%BD%AE%E4%B8%8E%E5%BC%95%E7%94%A8/#22","title":"2.2 \u5f15\u7528","text":"<p>\u53ef\u4ee5\u7406\u89e3\u4e3a\u53d6\u503c\u64cd\u4f5c\uff0c\u57fa\u672c\u7684\u5f62\u5f0f\u4e3a<code>${xxx}</code></p> <pre><code>set(AA xy mn)\nset(BB ${AA} cc) # BB \u5185\u5bb9\u4e3a 3 \u4e2a\u503c\uff1axy;mn;cc\nset(CC \"${BB}\")  # CC \u5185\u5bb9\u4e3a 3 \u4e2a\u503c\uff1axy;mn;cc\n</code></pre>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/03-%E5%8F%98%E9%87%8F%E7%9A%84%E8%AE%BE%E7%BD%AE%E4%B8%8E%E5%BC%95%E7%94%A8/#22_1","title":"2.2 \u89e3\u9664","text":"<p><code>unset()</code>\u8bed\u53e5\u5219\u662f\u89e3\u9664\u5b9a\u4e49\u7684\u529f\u80fd\uff0c\u4f8b\u5982\uff1a</p> <pre><code># \u5b9a\u4e49\u4e8e &lt;opencv-path&gt;/CMakeLists.txt \u4e2d\u7684\u5185\u5bb9\nunset(_hal_includes)\n</code></pre> <p>\u5b83\u53ef\u4ee5\u5c06\u53d8\u91cf\u7684\u5185\u5bb9\u6e05\u9664\uff0c\u4e0b\u6b21\u518d\u6b21\u4f7f\u7528\u540c\u540d\u7684\u53d8\u91cf\u9700\u8981\u91cd\u65b0 <code>set</code></p>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/03-%E5%8F%98%E9%87%8F%E7%9A%84%E8%AE%BE%E7%BD%AE%E4%B8%8E%E5%BC%95%E7%94%A8/#23","title":"2.3 \u4f5c\u7528\u57df\u63d0\u5347","text":"<p>\u4e00\u822c\u60c5\u51b5\u4e0b\uff0c\u5b50\u76ee\u5f55\u7684\u53d8\u91cf\u65e0\u6cd5\u5728\u7236\u76ee\u5f55 <code>CMakeLists.txt</code> \u4e2d\u751f\u6548\uff0c\u4f46\u662f\u7236\u76ee\u5f55\u7684 <code>CMakeLists.txt</code> \u4e2d\u5b9a\u4e49\u597d\u7684\u53d8\u91cf\u53ef\u4ee5\u88ab\u5b50\u76ee\u5f55\u7684 <code>CMakeLists.txt</code> \u6240\u7ee7\u627f\uff0c\u4f46\u5f00\u8f9f\u4e86\u65b0\u7684\u4f5c\u7528\u57df\u3002</p> <p>\u5982\u679c\u6211\u4eec\u5e0c\u671b\u5728\u5b50\u76ee\u5f55\u7684 <code>CMakeLists.txt</code> \u4e2d\u8bbe\u7f6e\u53d8\u91cf\uff0c\u5e76\u4e14\u80fd\u591f\u5728\u7236\u76ee\u5f55 <code>CMakeLists.txt</code> \u4e2d\u751f\u6548\uff0c\u6211\u4eec\u9700\u8981\u63d0\u5347\u4f5c\u7528\u57df\uff0c\u8bed\u6cd5\u662f</p> <pre><code>set(xxx PARENT_SCOPE)\n</code></pre> <p>\u4f8b\u5982\uff0c\u9879\u76ee\u6839\u76ee\u5f55\u4e0b\u7684 <code>CMakeLists.txt</code> \u4e2d\u5199\u5165\u4e86\u4ee5\u4e0b\u5185\u5bb9</p> <pre><code>message(STATUS \"var1 = ${var1}\")\nmessage(STATUS \"var2 = ${var2}\")\nadd_subdirectory(module)\nmessage(STATUS \"var1 = ${var1}\")\nmessage(STATUS \"var2 = ${var2}\")\n</code></pre> <p>\u800c\u5728 <code>module</code> \u6a21\u5757\u7684\u6587\u4ef6\u5bf9\u5e94\u7684 <code>CMakeLists.txt</code> \u4e2d\u5199\u5165</p> <pre><code>set(var1 \"abc\")\nset(var2 \"def\" PARENT_SCOPE)\n</code></pre> <p>\u5728\u6267\u884c CMake \u540e\uff0c\u8fd0\u884c\u7ed3\u679c\u4e3a</p> <pre><code>-- var1 =\n-- var2 =\n-- var1 =\n-- var2 = def\n</code></pre> <p>\u5728\u4f7f\u7528 <code>PARENT_SCOPE</code> \u540e\uff0c<code>var2</code> \u53d8\u91cf\u5728\u7236\u76ee\u5f55 <code>CMakeLists.txt</code> \u4e2d\u4e5f\u80fd\u751f\u6548\u3002</p>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/03-%E5%8F%98%E9%87%8F%E7%9A%84%E8%AE%BE%E7%BD%AE%E4%B8%8E%E5%BC%95%E7%94%A8/#3-cmake","title":"3. CMake \u53d8\u91cf","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/03-%E5%8F%98%E9%87%8F%E7%9A%84%E8%AE%BE%E7%BD%AE%E4%B8%8E%E5%BC%95%E7%94%A8/#31","title":"3.1 \u79cd\u7c7b","text":"<p>\u6b64\u4e3a CMake \u9ed8\u8ba4\u63d0\u4f9b\u7684\u53d8\u91cf\uff0c\u4e5f\u5c06\u8bb0\u8f7d\u5728 <code>CMakeCache.txt</code> \u4e2d\u3002\u5177\u4f53\u5305\u62ec</p> <ul> <li>\u63d0\u4f9b\u4fe1\u606f\u7684\u53d8\u91cf\uff0c\u4f8b\u5982 <code>CMAKE_BINARY_DIR</code>\u3001<code>PROJECT_NAME</code></li> <li>\u6539\u53d8\u884c\u4e3a\u7684\u53d8\u91cf\uff0c\u4f8b\u5982 <code>CMAKE_BUILD_TYPE</code></li> <li>\u63cf\u8ff0\u7cfb\u7edf\u7684\u53d8\u91cf\uff0c\u4f8b\u5982 <code>CMAKE_SYSTEM_PROCESSOR</code></li> <li>\u63a7\u5236\u6784\u5efa\u7684\u53d8\u91cf\uff0c\u4f8b\u5982 <code>LIBRARY_OUTPUT_PATH</code>\u3001<code>CMAKE_RUNTIME_OUTPUT_DIRECTORY</code></li> <li>\u8bed\u8a00\u7684\u53d8\u91cf\uff0c\u4f8b\u5982 <code>CMAKE_CXX_STANDARD</code></li> <li>CTest \u4e0e CPack \u7684\u53d8\u91cf</li> </ul>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/03-%E5%8F%98%E9%87%8F%E7%9A%84%E8%AE%BE%E7%BD%AE%E4%B8%8E%E5%BC%95%E7%94%A8/#32","title":"3.2 \u5b9a\u4e49","text":"<p>\u8fd9\u79cd\u53d8\u91cf\u5728\u5b9a\u4e49\u65f6\u4e0e\u666e\u901a\u53d8\u91cf\u7684\u5b9a\u4e49\u65b9\u5f0f\u4e00\u81f4\uff0c\u4f46\u6548\u679c\u4e0a\u662f\u7f13\u5b58\u53d8\u91cf\uff0c\u4f8b\u5982\uff1a</p> <pre><code>set(CMAKE_BUILD_TYPE Debug)\n</code></pre> <p>\u5728\u5e95\u5c42 <code>CMakeLists.txt</code> \u6587\u4ef6\u4e2d\u88ab\u8bbe\u7f6e\uff0c\u4f46\u80fd\u591f\u5728\u4e4b\u540e\u8bbf\u95ee\u5230\u7684\u5176\u4ed6 <code>CMakeLists.txt</code> \u4e2d\u7ee7\u7eed\u751f\u6548\u3002</p>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/03-%E5%8F%98%E9%87%8F%E7%9A%84%E8%AE%BE%E7%BD%AE%E4%B8%8E%E5%BC%95%E7%94%A8/#4","title":"4. \u7f13\u5b58\u53d8\u91cf","text":"<p>\u8fd9\u79cd\u53d8\u91cf\u5728\u5b9a\u4e49\u540e\u4fbf\u88ab\u6dfb\u52a0\u81f3\u4e86 <code>CMakeCache.txt</code> \u6587\u4ef6\u4e2d\uff0c\u4e4b\u540e\u8bbf\u95ee\u5b83\u7684\u65f6\u5019\uff0c\u5c06\u4ece <code>CMakeCache.txt</code> \u6587\u4ef6\u4e2d\u8c03\u51fa\uff0c\u56e0\u6b64\u5747\u80fd\u5f97\u5230\u6709\u6548\u8bbf\u95ee\u6570\u636e\u3002</p> <p>::: tip \u8fd9\u7c7b\u53d8\u91cf\u53ef\u4ee5\u7528 C/C++ \u5177\u6709\u52a8\u6001\u5b58\u50a8\u671f\u7684\u53d8\u91cf\u6765\u7c7b\u6bd4 :::</p>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/03-%E5%8F%98%E9%87%8F%E7%9A%84%E8%AE%BE%E7%BD%AE%E4%B8%8E%E5%BC%95%E7%94%A8/#41","title":"4.1 \u5b9a\u4e49","text":"<p>\u4e0a\u6587\u63d0\u5230 CMake \u53d8\u91cf\u90fd\u662f\u5b57\u7b26\u4e32\u7c7b\u578b\u7684\uff0c\u4f46\u4e0d\u59a8\u788d\u89e3\u91ca\u6210\u5176\u4ed6\u7c7b\u578b\uff0c\u5728\u7f13\u5b58\u53d8\u91cf\u4e2d\uff0c\u53ef\u4ee5\u89e3\u91ca\u6210\u5176\u4ed6\u7c7b\u578b\u53ef\u4f9b <code>cmake-gui</code> \u7b49\u5de5\u5177\u663e\u793a\u3002</p>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/03-%E5%8F%98%E9%87%8F%E7%9A%84%E8%AE%BE%E7%BD%AE%E4%B8%8E%E5%BC%95%E7%94%A8/#411-option","title":"4.1.1 option","text":"<p>\u5176\u4e2d\uff0c\u4f7f\u7528 <code>option</code> \u547d\u4ee4\u662f\u521b\u5efa <code>BOOL</code> \u578b\u7f13\u5b58\u53d8\u91cf\u7684\u4e00\u79cd\u65b9\u5f0f\uff0c\u4e00\u822c\u53ef\u4ee5\u4f5c\u4e3a\u7f16\u8bd1\u9009\u9879\uff0c\u5373\u4f7f\u5b98\u7f51\u4e2d\u6ca1\u6709\u5728\u7f13\u5b58\u53d8\u91cf\u4e2d\u4ecb\u7ecd\u8be5\u547d\u4ee4\u3002<code>option</code> \u7684\u4f7f\u7528\u65b9\u5f0f\u5982\u4e0b\uff1a</p> <pre><code>option(ORT_WITH_CUDA \"the library compile with CUDA\" OFF)\n</code></pre> <p>\u5b83\u53ea\u6709\u4e24\u79cd\u72b6\u6001\uff0c<code>TRUE</code>\u3001<code>FALSE</code> \u6216\u7528\u53e6\u4e00\u79cd\u8868\u793a\u65b9\u5f0f\uff1a<code>ON</code>\u3001<code>OFF</code>\uff0c\u6700\u5e38\u89c1\u7684 <code>option</code> \u53d8\u91cf\u5c31\u662f\u5728\u4f7f\u7528 <code>cmake-gui</code> \u5de5\u5177\u7684\u65f6\u5019\uff0c\u53f3\u4fa7\u680f\u4e2d\u53ef\u4ee5\u6253\u52fe\u7684\u65b9\u6846\u3002</p>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/03-%E5%8F%98%E9%87%8F%E7%9A%84%E8%AE%BE%E7%BD%AE%E4%B8%8E%E5%BC%95%E7%94%A8/#412","title":"4.1.2 \u81ea\u5b9a\u4e49\u7f13\u5b58\u53d8\u91cf","text":"<p>\u5373\u4f7f\u7528\u547d\u4ee4 <code>set(xxx CACHE)</code>\uff0c\u8fd9\u662f\u4e00\u822c\u7684\u8bbe\u7f6e\u7f13\u5b58\u53d8\u91cf\u7684\u65b9\u5f0f\uff0c\u53ef\u4ee5\u53c2\u8003 OpenCV \u4e2d\u7684\u4f8b\u5b50\uff1a</p> <pre><code># \u5b9a\u4e49\u4e8e &lt;opencv-path&gt;/cmake/OpenCVModule.cmake \u4e2d\u7684\u5185\u5bb9\nset(OPENCV_MODULES_BUILD \"\" CACHE INTERNAL \"List of OpenCV modules included into the build\")\n</code></pre> <p><code>CACHE</code> \u6307\u660e\u4e86\u8fd9\u662f\u4e00\u4e2a\u7f13\u5b58\u53d8\u91cf\uff0c<code>INTERNAL</code> \u7684\u6548\u679c\u4e0e <code>STRING</code> \u6548\u679c\u5927\u81f4\u76f8\u540c\uff0c\u4f46 <code>INTERNAL</code> \u65e0\u6cd5\u5728 CMake \u5de5\u5177\u4e2d\u663e\u793a\uff0c\u7528\u6237\u65e0\u6cd5\u901a\u8fc7 <code>cmake-gui</code> \u7b49\u5de5\u5177\u8fdb\u884c\u4fee\u6539\uff0c\u4f46 <code>STRING</code> \u53ef\u4ee5\u3002\u9664\u6b64\u4e4b\u5916\uff0c\u8fd8\u6709\u4ee5\u4e0b\u51e0\u4e2a\u5e38\u7528\u7684\u7c7b\u578b\uff1a<code>BOOL</code>\u3001<code>PATH</code>\u3001<code>FILEPATH</code>\u3002\u5176\u4e2d<code>BOOL</code>\u578b\u7f13\u5b58\u53d8\u91cf\u4e0e\u4f7f\u7528 <code>option</code> \u521b\u5efa\u7684\u53d8\u91cf\u6548\u679c\u7b49\u540c\u3002</p> <p>\u4e4b\u540e\u8ddf\u7684\u5b57\u7b26\u4e32\u5219\u662f\u8fd9\u4e2a\u53d8\u91cf\u7684\u6ce8\u91ca\uff0c\u5728 <code>cmake-gui</code> \u5de5\u5177\u4e2d\uff0c\u628a\u9f20\u6807\u653e\u7f6e\u5728\u5de6\u4fa7\u7684\u53d8\u91cf\u540d\u4e0a\uff0c\u5373\u53ef\u663e\u793a\u51fa\u8be5\u53d8\u91cf\u7684\u6ce8\u91ca\u3002</p>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/03-%E5%8F%98%E9%87%8F%E7%9A%84%E8%AE%BE%E7%BD%AE%E4%B8%8E%E5%BC%95%E7%94%A8/#413","title":"4.1.3 \u5b98\u7f51\u4ecb\u7ecd","text":"<ul> <li> <p><code>BOOL</code>\uff1a<code>ON/OFF</code> \u503c\u3002<code>cmake-gui</code> \u4f1a\u63d0\u4f9b\u4e00\u4e2a\u5f62\u5982\u7684\u590d\u9009\u6846\uff1b</p> </li> <li> <p><code>FILEPATH</code>\uff1a\u78c1\u76d8\u4e0a\u6587\u4ef6\u7684\u8def\u5f84\u3002<code>cmake-gui</code> \u4f1a\u63d0\u4f9b\u4e00\u4e2a\u5f62\u5982\u7684\u6587\u4ef6\u5bf9\u8bdd\u6846\uff1b</p> </li> <li> <p><code>PATH</code>\uff1a\u78c1\u76d8\u4e0a\u76ee\u5f55\u7684\u8def\u5f84\u3002<code>cmake-gui</code> \u4f1a\u63d0\u4f9b\u4e00\u4e2a\u6587\u4ef6\u5bf9\u8bdd\u6846\uff1b</p> </li> <li> <p><code>STRING</code>\uff1a\u4e00\u884c\u6587\u5b57\u3002<code>cmake-gui</code> \u4f1a\u63d0\u4f9b\u5f62\u5982\u7684\u6587\u672c\u5b57\u6bb5\uff0c\u5982\u679c\u8bbe\u7f6e\u4e86 <code>STRINGS</code> \u5c5e\u6027\u4e5f\u53ef\u4ee5\u63d0\u4f9b\u4e0b\u62c9\u9009\u9879\uff1b</p> </li> <li> <p><code>INTERNAL</code>\uff1a\u4e00\u884c\u6587\u5b57\u3002<code>cmake-gui</code> \u4f1a\u4e0d\u663e\u793a\u8be5\u7c7b\u578b\u7684\u53d8\u91cf\uff0c\u56e0\u6b64\u5728\u4f7f\u7528\u6b64\u7c7b\u578b\u65f6\u610f\u5473\u7740 <code>FORCE</code></p> </li> </ul>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/03-%E5%8F%98%E9%87%8F%E7%9A%84%E8%AE%BE%E7%BD%AE%E4%B8%8E%E5%BC%95%E7%94%A8/#42","title":"4.2 \u5f15\u7528","text":"<p>\u4e0e\u666e\u901a\u53d8\u91cf\u7684\u5f15\u7528\u65b9\u5f0f\u4e00\u81f4\uff0c\u5373 <code>${xxx}</code>\uff0c\u4f46 <code>${xxx}</code> \u4f1a\u5148\u641c\u7d22\u6709\u65e0\u666e\u901a\u53d8\u91cf\uff0c\u82e5\u627e\u4e0d\u5230\u624d\u4f1a\u7ee7\u7eed\u641c\u7d22\u7f13\u5b58\u53d8\u91cf\u3002\u82e5\u5f3a\u5236\u6307\u5b9a\u641c\u7d22\u7f13\u5b58\u53d8\u91cf\uff0c\u5219\u9700\u8981\u4f7f\u7528 <code>$CACHE{xxx}</code>\uff0c\u4f8b\u5982</p> <pre><code>set(val1 \"aaa\")\nset(val2 \"bbb\" CACHE STRING \"Test String\")\n\nmessage(STATUS ${val1})      # -- aaa\nmessage(STATUS ${val2})      # -- bbb\nmessage(STATUS $CACHE{val1}) # --\nmessage(STATUS $CACHE{val2}) # -- bbb\n</code></pre>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/03-%E5%8F%98%E9%87%8F%E7%9A%84%E8%AE%BE%E7%BD%AE%E4%B8%8E%E5%BC%95%E7%94%A8/#43","title":"4.3 \u89e3\u9664","text":"<p>\u540c\u6837\u4e5f\u662f\u4f7f\u7528<code>unset</code>\u8bed\u53e5\u3002\u4f46\u7565\u6709\u4e0d\u540c\u7684\u662f\uff0c\u9700\u8981\u52a0\u4e0a<code>CACHE</code>\uff1a</p> <pre><code># \u5b9a\u4e49\u4e8e &lt;opencv-path&gt;/cmake/OpenCVModule.cmake \u4e2d\u7684\u5185\u5bb9\nunset(OPENCV_WORLD_MODULES CACHE)\n</code></pre>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/03-%E5%8F%98%E9%87%8F%E7%9A%84%E8%AE%BE%E7%BD%AE%E4%B8%8E%E5%BC%95%E7%94%A8/#5","title":"5. \u73af\u5883\u53d8\u91cf","text":"<p>\u4e0e\u7cfb\u7edf\u4e2d\u7684\u73af\u5883\u53d8\u91cf\u662f\u4e00\u4e2a\u6982\u5ff5\uff0c\u6bd4\u5982 <code>LD_LIBRARY_PATH</code>\uff0c\u8981\u5f15\u7528\u8fd9\u79cd\u53d8\u91cf\u6211\u4eec\u9700\u8981\u4f7f\u7528 <code>$ENV{xxx}</code>\uff0c\u4f8b\u5982</p> <pre><code>set(sdk_path \"$ENV{MVCAM_SDK_PATH}\")\nif(sdk_path STREQUAL \"\")\n  return()\nendif()\n</code></pre> <p>\u5176\u4e2d <code>MVCAM_SDK_PATH</code> \u662f\u7cfb\u7edf\u73af\u5883\u4e2d\u7684\u4e00\u4e2a\u53d8\u91cf\uff08\u5b9a\u4e49\u5728 <code>.bashrc</code> \u91cc\u9762\uff09</p>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/03-%E5%8F%98%E9%87%8F%E7%9A%84%E8%AE%BE%E7%BD%AE%E4%B8%8E%E5%BC%95%E7%94%A8/#6","title":"6. \u53d8\u91cf\u89c4\u8303","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/03-%E5%8F%98%E9%87%8F%E7%9A%84%E8%AE%BE%E7%BD%AE%E4%B8%8E%E5%BC%95%E7%94%A8/#61","title":"6.1 \u8bbe\u7f6e\u89c4\u8303","text":"<p>\u6765\u770b OpenCV \u4e2d\u5b8f <code>ocv_add_module</code> \u5185\u90e8\u7684\u4e00\u4e2a\u6761\u4ef6\u63a7\u5236\u8bed\u53e5\u7684\u5199\u6cd5\uff1a</p> <pre><code>if(...)\n  # ...\n  set(__ocv_argn__ ${ADD_MODULE_ARGN})\n  # ...\n  unset(__ocv_argn__)\n  # ...\nendif()\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230\uff0c<code>${ADD_MODULE_ARGN}</code> \u5728\u6574\u4e2a\u6761\u4ef6\u8fd0\u7b97\u4e2d\u5747\u672a\u5b9a\u4e49\uff0c\u56e0\u6b64\u4ed6\u5bf9\u4e8e\u8fd9\u4e2a\u8bed\u53e5\u6765\u8bf4\u662f\u4e2a\u5916\u90e8\u53d8\u91cf\u3002\u5bf9\u4e8e\u5916\u90e8\u53d8\u91cf\uff0cOpenCV\u7684\u505a\u6cd5\u901a\u5e38\u4e0e\u4e0a\u9762\u7684\u4ee3\u7801\u4e00\u81f4\uff0c\u5373 <code>set()</code> \u4e00\u4e2a\u65b0\u7684\u53d8\u91cf\u6765\u8bb0\u5f55\u8fd9\u4e2a\u53ef\u80fd\u4f1a\u505a\u4fee\u6539\u7684\u503c\uff0c\u5e76\u4e14\u5728\u8fd9\u4e2a\u53d8\u91cf\u7528\u5b8c\u540e <code>unset()</code>\u3002</p>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/03-%E5%8F%98%E9%87%8F%E7%9A%84%E8%AE%BE%E7%BD%AE%E4%B8%8E%E5%BC%95%E7%94%A8/#62","title":"6.2 \u547d\u540d\u89c4\u8303","text":"<ol> <li>\u666e\u901a\u53d8\u91cf\u53ef\u4ee5\u4f7f\u7528\u5c0f\u5199 + \u4e0b\u5212\u7ebf\u7684\u65b9\u5f0f\uff0c\u4f8b\u5982    <pre><code>set(my_var \"ABC\")\n</code></pre></li> <li>\u7f13\u5b58\u53d8\u91cf\u4f7f\u7528\u5927\u5199 + \u4e0b\u5212\u7ebf\u7684\u65b9\u5f0f\uff0c\u4f8b\u5982    <pre><code>set(MY_VAR \"ABC\" CACHE STRING \"My variable\")\n</code></pre></li> </ol>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/04-%E8%BF%90%E7%AE%97%E7%AC%A6%E4%B8%8E%E6%9D%A1%E4%BB%B6%E3%80%81%E5%BE%AA%E7%8E%AF%E8%AF%AD%E5%8F%A5/","title":"\u301004\u3011\u8fd0\u7b97\u7b26\u4e0e\u6761\u4ef6\u3001\u5faa\u73af\u8bed\u53e5","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/04-%E8%BF%90%E7%AE%97%E7%AC%A6%E4%B8%8E%E6%9D%A1%E4%BB%B6%E3%80%81%E5%BE%AA%E7%8E%AF%E8%AF%AD%E5%8F%A5/#1-if","title":"1. \u6761\u4ef6\u63a7\u5236\uff1aif","text":"<p>\u6761\u4ef6\u63a7\u5236\u7684\u57fa\u672c\u5199\u6cd5\u4e3a\uff1a</p> <pre><code>if(aaa)\n  # ...\nelseif(bbb)\n  # ...\nelse()\n  # ...\nendif()\n</code></pre> <p>\u5e76\u4e14\u80fd\u591f\u652f\u6301\u5d4c\u5957\u6761\u4ef6\u63a7\u5236\uff0c\u5373</p> <pre><code>if(aaa)\n  # ...\n  if(ccc)\n    # ...\n  endif()\n  # ...\nelse()\n  # ...\nendif()\n</code></pre>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/04-%E8%BF%90%E7%AE%97%E7%AC%A6%E4%B8%8E%E6%9D%A1%E4%BB%B6%E3%80%81%E5%BE%AA%E7%8E%AF%E8%AF%AD%E5%8F%A5/#2","title":"2. \u8fd0\u7b97\u7b26","text":"<p>\u5148\u7ed9\u51fa\u4ee5\u4e0b\u4f8b\u5b50</p> <pre><code># \u5b9a\u4e49\u4e8e &lt;opencv-path&gt;/cmake/OpenCVModule.cmake \u4e2d\u7684\u5185\u5bb9\nif(\" ${ARGV1}\" STREQUAL \" INTERNAL\" OR \" ${ARGV1}\" STREQUAL \" BINDINGS\")\n  set(OPENCV_MODULE_${the_module}_CLASS \"${ARGV1}\" CACHE INTERNAL \"The category of the module\")\n  set(__ocv_argn__ ${ADD_MODULE_ARGN})\n  list(REMOVE_AT __ocv_argn__ 0)\n  ocv_add_dependencies(${the_module} ${__ocv_argn__})\n  unset(__ocv_argn__)\nelse()\n  set(OPENCV_MODULE_${the_module}_CLASS \"PUBLIC\" CACHE INTERNAL \"The category of the module\")\n  ocv_add_dependencies(${the_module} ${ADD_MODULE_ARGN})\n  if(BUILD_${the_module})\n    set(OPENCV_MODULES_PUBLIC ${OPENCV_MODULES_PUBLIC} \"${the_module}\" CACHE INTERNAL \"List of OpenCV modules marked for export\")\n  endif()\nendif()\n</code></pre> <p>\u5728 <code>if()</code> \u7684\u5c0f\u62ec\u53f7\u4e2d\u51fa\u73b0\u4e86 <code>STREQUAL</code> \u4ee5\u53ca <code>OR</code> \u7684\u5185\u5bb9\uff0c\u8fd9\u4e9b\u5c5e\u4e8e\u8fd0\u7b97\u7b26\uff0c\u6211\u4eec\u6709\u5fc5\u8981\u4ecb\u7ecd\u4e00\u4e9b\u80fd\u591f\u4ea7\u751f <code>BOOL</code> \u7c7b\u578b\u53d8\u91cf\u7684\u8fd0\u7b97\u7b26\uff0c\u8fd9\u4e9b\u8fd0\u7b97\u7b26\u4e5f\u5e38\u7528\u4e8e\u6761\u4ef6\u63a7\u5236\u4e2d\u3002</p>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/04-%E8%BF%90%E7%AE%97%E7%AC%A6%E4%B8%8E%E6%9D%A1%E4%BB%B6%E3%80%81%E5%BE%AA%E7%8E%AF%E8%AF%AD%E5%8F%A5/#21","title":"2.1 \u4e00\u5143\u8fd0\u7b97\u7b26","text":"<ul> <li><code>EXISTS</code>\uff1a\u5224\u65ad\u6587\u4ef6\u6216\u8005\u76ee\u5f55\u662f\u5426\u5b58\u5728\uff0c\u5b58\u5728\u65f6\u4e3a\u771f\u3002\u9700\u8981\u63d0\u4f9b\u7edd\u5bf9\u8def\u5f84\uff1b\u5982\u679c\u6587\u4ef6\u6216\u8005\u76ee\u5f55\u662f\u7b26\u53f7\u94fe\u63a5\uff08\u4f8b\u5982\u8f6f\u8fde\u63a5\uff09\uff0c\u5219\u53ea\u6709\u5f53\u94fe\u63a5\u7684\u76ee\u6807\u5b58\u5728\u65f6\u8fd4\u56de\u771f\u3002\u683c\u5f0f\u4e3a\uff1a<code>EXISTS xxx</code>\uff0c\u4f8b\u5982\uff1a</li> </ul> <pre><code># \u5b9a\u4e49\u4e8e &lt;opencv-path&gt;/cmake/OpenCVModule.cmake \u4e2d\u7684\u5185\u5bb9\nif(EXISTS \"${CMAKE_CURRENT_BINARY_DIR}/test\")\n</code></pre> <ul> <li><code>IS_DIRECTORY</code>\uff1a\u5224\u65ad\u6307\u5b9a\u5185\u5bb9\u662f\u5426\u4e3a\u6587\u4ef6\u5939\uff0c\u662f\u5219\u4e3a\u771f\u3002\u9700\u8981\u63d0\u4f9b\u7edd\u5bf9\u8def\u5f84\u3002\u683c\u5f0f\u4e3a\uff1a<code>IS_DIRECTOTY xxx</code>\uff0c\u4f8b\u5982\uff1a</li> </ul> <pre><code>if(IS_DIRECTORY ${CMAKE_CURRENT_LIST_DIR}/${m})\n</code></pre> <ul> <li><code>COMMAND</code>\uff1a\u5982\u679c\u7ed9\u5b9a\u7684\u540d\u79f0\u662f\u547d\u4ee4\u3001\u5b8f\u6216\u8005\u51fd\u6570\u8fd9\u7c7b\u53ef\u88ab\u8c03\u7528\u7684\u5bf9\u8c61\uff0c\u5219\u8fd4\u56de\u771f\u3002\u683c\u5f0f\u4e3a\uff1a<code>COMMAND xxx</code>\uff0c\u4f8b\u5982\uff1a</li> </ul> <pre><code># \u5b9a\u4e49\u4e8e &lt;opencv-path&gt;/cmake/OpenCVModule.cmake \u4e2d\u7684\u5185\u5bb9\nif(COMMAND ocv_get_module_external_sources)\n</code></pre> <ul> <li><code>DEFINED</code>\uff1a\u5982\u679c\u7ed9\u5b9a\u7684\u53d8\u91cf\uff08\u666e\u901a\u53d8\u91cf\u3001\u7f13\u5b58\u53d8\u91cf\u6216\u7cfb\u7edf\u73af\u5883\u53d8\u91cf\uff09\u5b58\u5728\uff0c\u5219\u8fd4\u56de\u771f\u3002\u683c\u5f0f\u4e3a\uff1a<code>DEFINED xxx</code>\uff0c\u7cfb\u7edf\u73af\u5883\u53d8\u91cf\u524d\u8981\u52a0 <code>ENV</code>\uff0c\u5373 <code>DEFINED ENV xxx</code>\u3002\u793a\u4f8b\u5982\u4e0b\uff1a</li> </ul> <pre><code># \u5b9a\u4e49\u4e8e &lt;opencv-path&gt;/cmake/OpenCVModule.cmake \u4e2d\u7684\u5185\u5bb9\nif(DEFINED OPENCV_INITIAL_PASS)\n</code></pre> <ul> <li><code>TARGET</code>\uff1a\u5982\u679c\u7ed9\u5b9a\u7684\u540d\u79f0\u662f\u76ee\u6807\uff08\u5305\u62ec\u4e8c\u8fdb\u5236\u76ee\u6807\u3001\u4f2a\u76ee\u6807\uff0c\u53ef\u53c2\u8003\u301005\u3011\u76ee\u6807\u6784\u5efa\uff09\uff0c\u5219\u8fd4\u56de\u771f\u3002\u683c\u5f0f\u4e3a\uff1a<code>TARGET xxx</code>\uff0c\u4f8b\u5982\uff1a</li> </ul> <pre><code># \u5b9a\u4e49\u4e8e &lt;opencv-path&gt;/cmake/OpenCVGenABI.cmake \u4e2d\u7684\u5185\u5bb9\nif(TARGET opencv_${mod}) # opencv_world\n</code></pre>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/04-%E8%BF%90%E7%AE%97%E7%AC%A6%E4%B8%8E%E6%9D%A1%E4%BB%B6%E3%80%81%E5%BE%AA%E7%8E%AF%E8%AF%AD%E5%8F%A5/#22","title":"2.2 \u4e8c\u5143\u8fd0\u7b97\u7b26","text":"<ul> <li><code>EQUAL</code>\uff1a\u5de6\u8fb9\u4e24\u4e2a\u5b57\u7b26\u4e32\u6216\u8005\u53d8\u91cf\u76f8\u7b49\u65f6\u4e3a\u771f\u3002</li> <li><code>STREQUAL</code>\uff1a\u5de6\u8fb9\u4e0e\u53f3\u8fb9\u7684\u5b57\u5178\u987a\u5e8f\u76f8\u7b49\u65f6\u4e3a\u771f\u3002</li> <li><code>MATCHES</code>\uff1a\u6309\u7167\u6b63\u5219\u8868\u8fbe\u5f0f\u53bb\u5339\u914d\uff0c\u5de6\u8fb9\u662f\u5f85\u5339\u914d\u7684\u503c\uff0c\u53f3\u8fb9\u662f\u6b63\u5219\u8868\u8fbe\u5f0f\uff0c\u80fd\u5339\u914d\u4e3a\u65f6\u4e3a\u771f\u3002\u4f8b\u5982\uff1a   <pre><code># \u5b9a\u4e49\u4e8e &lt;opencv-path&gt;/cmake/OpenCVModule.cmake \u4e2d\u7684\u5185\u5bb9\n# m \u4e3a\u67d0\u4e2a foreach \u4e2d\u7684\u5143\u7d20\nif(NOT m MATCHES \"^opencv_\")\n</code></pre></li> </ul>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/04-%E8%BF%90%E7%AE%97%E7%AC%A6%E4%B8%8E%E6%9D%A1%E4%BB%B6%E3%80%81%E5%BE%AA%E7%8E%AF%E8%AF%AD%E5%8F%A5/#23","title":"2.3 \u903b\u8f91\u8fd0\u7b97\u7b26","text":"<p>\u4e0e\u5176\u4ed6\u8bed\u8a00\u4e00\u81f4\uff0c\u5305\u542b\u4e0e\u3001\u6216\u3001\u975e\uff1a<code>AND</code>\u3001<code>OR</code>\u3001<code>NOT</code></p> <pre><code>if(BUILD_opencv_world AND m STREQUAL \"opencv_world\"\n    OR NOT BUILD_opencv_world\n    OR NOT OPENCV_MODULE_${m}_IS_PART_OF_WORLD)\n</code></pre> <p>\u903b\u8f91\u64cd\u4f5c\u7b26\u7684\u7ed3\u5408\u4f18\u5148\u7ea7\uff1a</p> <p><code>NOT</code> &gt; <code>AND</code> &gt; <code>OR</code></p> <p>::: tip \u8fd0\u7b97\u7b26\u7ed3\u5408\u987a\u5e8f\u4e3a\uff1a\u4e00\u5143\u8fd0\u7b97\u7b26 &gt; \u4e8c\u5143\u8fd0\u7b97\u7b26 &gt; \u903b\u8f91\u8fd0\u7b97\u7b26 :::</p>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/04-%E8%BF%90%E7%AE%97%E7%AC%A6%E4%B8%8E%E6%9D%A1%E4%BB%B6%E3%80%81%E5%BE%AA%E7%8E%AF%E8%AF%AD%E5%8F%A5/#3-foreach","title":"3. \u5faa\u73af\u63a7\u5236\uff1aforeach","text":"<p>\u8fd9\u91cc\u4ecb\u7ecd\u6700\u5e38\u7528\u7684 <code>foreach</code>\uff0c<code>while</code> \u8fd9\u91cc\u4e0d\u505a\u4ecb\u7ecd</p>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/04-%E8%BF%90%E7%AE%97%E7%AC%A6%E4%B8%8E%E6%9D%A1%E4%BB%B6%E3%80%81%E5%BE%AA%E7%8E%AF%E8%AF%AD%E5%8F%A5/#31","title":"3.1 \u7528\u6cd5","text":"<p>\u5148\u7ed9\u51fa\u4e24\u4e2a\u4f8b\u5b50\uff1a</p> <pre><code># \u4ee5\u4e0b\u5747\u4e3a\u5b9a\u4e49\u4e8e &lt;opencv-path&gt;/cmake/OpenCVModule.cmake \u4e2d\u7684\u5185\u5bb9\n# Example 1\nforeach(subdir ${subdirs})\n  if(EXISTS \"${path}/${subdir}/CMakeLists.txt\")\n    list(APPEND paths \"${path}/${subdir}\")\n    list(APPEND names \"${subdir}\")\n  endif()\nendforeach()\n\n# Example 2\nforeach(mod ${OPENCV_MODULES_BUILD} ${OPENCV_MODULES_DISABLED_USER} ${OPENCV_MODULES_DISABLED_AUTO} ${OPENCV_MODULES_DISABLED_FORCE})\n  if(HAVE_${mod})\n    unset(HAVE_${mod} CACHE)\n  endif()\n  unset(OPENCV_MODULE_${mod}_DEPS CACHE)\n  unset(OPENCV_MODULE_${mod}_DEPS_EXT CACHE)\n  # \u7701\u7565\u4e00\u7cfb\u5217 unset\nendforeach()\n</code></pre> <p>\u53ef\u4ee5\u5f97\u51fa\uff0c\u904d\u5386\u5faa\u73af\u63a7\u5236\u7684\u57fa\u672c\u5199\u6cd5\u4e3a\uff1a</p> <pre><code>foreach(\u6bcf\u4e2a\u5143\u7d20 ${\u5217\u88681} ${\u5217\u88682} ...)\n  \u5faa\u73af\u4f53\nendforeach()\n</code></pre> <p>\u5bf9\u4e8e\u4ee5\u4e0a\u4e24\u4e2a\u4f8b\u5b50 Example 1 \u548c Example 2\uff0c\u6709\u4ee5\u4e0b\u6ce8\u610f\u7684\u5730\u65b9\uff1a</p> <ul> <li> <p>Example 1</p> </li> <li> <p><code>${subdirs}</code> \u4e0d\u53ef\u5199\u6210 <code>\"${subdirs}\"</code>\uff0c\u6211\u4eec\u5047\u8bbe\u6b64\u5904 <code>${subdirs}</code> \u5185\u5bb9\u6709\uff1a<code>a</code>\u3001<code>b</code>\u3001<code>c</code>\uff0c\u90a3\u4e48\u904d\u5386\u7684\u65f6\u5019 <code>subdir</code> \u5219\u5206\u522b\u6307\u4ee3 <code>a</code>\u3001<code>b</code>\u3001<code>c</code>\u3002\u800c\u5982\u679c\u5199\u6210 <code>\"${subdirs}\"</code>\uff0c\u5c55\u5f00\u5219\u8868\u793a <code>\"a;b;c\"</code>\uff0c\u90a3\u4e48 <code>subdir</code> \u5219\u6307\u4ee3 <code>a;b;c</code> \u8fd9\u4e2a\u53d8\u91cf\u3002</p> </li> <li> <p><code>subdir</code> \u662f\u4e2a\u666e\u901a\u53d8\u91cf\uff0c\u56e0\u6b64\u5728\u8bbf\u95ee\uff08\u53d6\u503c\uff09\u65f6\u4e5f\u9700\u8981\u7528 <code>${}</code> \u7684\u5199\u6cd5\u3002</p> </li> <li> <p>Example 2</p> </li> <li> <p>\u5171\u6709 4 \u4e2a\u5f85\u904d\u5386\u7684\u5217\u8868\uff0c\u904d\u5386\u5219\u4f1a\u5c06\u8fd9 4 \u4e2a\u5217\u8868\u4e2d\u7684\u6240\u6709\u5185\u5bb9\u4f9d\u6b21\u8bbf\u95ee\u3002</p> </li> <li> <p><code>mod</code> \u4e3a\u4e00\u4e2a\u53d8\u91cf\uff0c\u4e0d\u4f8b\u5916\u7684\u4e5f\u9700\u8981\u7528 <code>${}</code> \u6765\u8bbf\u95ee\u3002\u540c\u65f6\u6211\u4eec\u8fd8\u80fd\u770b\u5230\u8fd9\u79cd\u5199\u6cd5\uff1a      <pre><code>unset(OPENCV_MODULE_${mod}_DEPS CACHE)\n</code></pre> <code>${mod}</code> \u7528\u5728\u4e86\u4e00\u4e2a\u53d8\u91cf\u7684\u4e2d\u95f4\uff0c\u5047\u8bbe\u6b64\u65f6 <code>${mod}</code> \u6307\u7684\u662f <code>aa</code>\uff0c\u90a3\u4e48\u8fd9\u4e2a\u53d8\u91cf\u5219\u8868\u793a\u4e3a\uff1a<code>OPENCV_MODULE_aa_DEPS</code></p> </li> </ul> <p>::: warning \u6761\u4ef6\u63a7\u5236\u7ed3\u675f\u6807\u5fd7 <code>endif()</code> \u548c\u5faa\u73af\u63a7\u5236\u7ed3\u675f\u6807\u5fd7 <code>endforeach()</code> \u62ec\u53f7\u4e2d\u7684\u5185\u5bb9\u53ef\u4ee5\u4e0d\u5199\uff0c\u4e00\u65e6\u5199\uff0c\u5c31\u5fc5\u987b\u8ddf <code>if()</code> \u548c <code>foreach()</code> \u62ec\u53f7\u4e2d\u7684\u5185\u5bb9\u4e00\u81f4 :::</p>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/04-%E8%BF%90%E7%AE%97%E7%AC%A6%E4%B8%8E%E6%9D%A1%E4%BB%B6%E3%80%81%E5%BE%AA%E7%8E%AF%E8%AF%AD%E5%8F%A5/#32","title":"3.2 \u5176\u4ed6\u5199\u6cd5","text":"<p><code>foreach</code> \u8fd8\u6709\u5176\u4ed6\u5199\u6cd5\uff0c\u4f8b\u5982\u5bf9\u4e8e</p> <pre><code>foreach(m ${members})\n  # ...\nendforeach()\n</code></pre> <p>\u6709\u66f4\u76f4\u89c2\u7684\u5199\u6cd5\uff0c\u6211\u4eec\u53ef\u4ee5\u5199\u6210</p> <pre><code>foreach(m IN LIST members)\n  # ...\nendforeach()\n</code></pre>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/04-%E8%BF%90%E7%AE%97%E7%AC%A6%E4%B8%8E%E6%9D%A1%E4%BB%B6%E3%80%81%E5%BE%AA%E7%8E%AF%E8%AF%AD%E5%8F%A5/#4","title":"4. \u793a\u4f8b","text":"<p>\u5982\u679c\u6211\u4eec\u60f3\u904d\u5386\u5f53\u524d\u76ee\u5f55\u4e0b\u7684\u6240\u6709\u6587\u4ef6\u5939\u8981\u600e\u4e48\u529e\uff1f\u5728\u7ec8\u7aef\u4e2d\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 <code>ls</code> \u6765\u5217\u51fa\u5f53\u524d\u8def\u5f84\u4e0b\u7684\u6240\u6709\u5185\u5bb9\uff0c\u5305\u62ec\u6587\u4ef6\u5939\uff0c\u5f53\u7136\u4e5f\u5305\u62ec\u4e86\u6587\u4ef6\uff0c\u5728 CMake \u4e2d\u6211\u4eec\u8981\u5982\u4f55\u8c03\u7528\u547d\u4ee4\u884c\u5462\uff1f</p>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/04-%E8%BF%90%E7%AE%97%E7%AC%A6%E4%B8%8E%E6%9D%A1%E4%BB%B6%E3%80%81%E5%BE%AA%E7%8E%AF%E8%AF%AD%E5%8F%A5/#41","title":"4.1 \u5217\u51fa\u6587\u4ef6\u4e0e\u6587\u4ef6\u5939","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/04-%E8%BF%90%E7%AE%97%E7%AC%A6%E4%B8%8E%E6%9D%A1%E4%BB%B6%E3%80%81%E5%BE%AA%E7%8E%AF%E8%AF%AD%E5%8F%A5/#411-execute_process","title":"4.1.1 \u6267\u884c\u5b50\u8fdb\u7a0b\uff1aexecute_process","text":"<p>\u5148\u5217\u51fa\u5b98\u7f51\u7ed9\u51fa\u7684\u547d\u4ee4\u539f\u578b\uff1a</p> <p>```cmake :collapsed-lines=8 execute_process(COMMAND  []                 [COMMAND  []]...                 [WORKING_DIRECTORY ]                 [TIMEOUT ]                 [RESULT_VARIABLE ]                 [RESULTS_VARIABLE ]                 [OUTPUT_VARIABLE ]                 [ERROR_VARIABLE ]                 [INPUT_FILE ]                 [OUTPUT_FILE ]                 [ERROR_FILE ]                 [OUTPUT_QUIET]                 [ERROR_QUIET]                 [COMMAND_ECHO ]                 [OUTPUT_STRIP_TRAILING_WHITESPACE]                 [ERROR_STRIP_TRAILING_WHITESPACE]                 [ENCODING ]                 [ECHO_OUTPUT_VARIABLE]                 [ECHO_ERROR_VARIABLE]                 [COMMAND_ERROR_IS_FATAL ]) <pre><code>\u8fd9\u91cc\u5217\u51fa\u5e38\u7528\u7684\u51e0\u4e2a\u9009\u9879\uff1a&amp;#x20;\n\n- `COMMAND`\n  - \u7528\u4e8e\u6307\u5b9a\u4e00\u4e2a\u5b50\u8fdb\u7a0b\u547d\u4ee4\u884c\u3002\n  - CMake \u76f4\u63a5\u4f7f\u7528\u64cd\u4f5c\u7cfb\u7edf API \u6267\u884c\u5b50\u8fdb\u7a0b\u3002\u6240\u6709\u53c2\u6570\u90fd\u88ab\u9010\u5b57\u4f20\u9012\u7ed9\u5b50\u8fdb\u7a0b\u3002\u6ca1\u6709\u4f7f\u7528\u4e2d\u95f4 Shell\uff0c\u6240\u4ee5\u50cf `&gt;` \u8fd9\u6837\u7684 Shell \u64cd\u4f5c\u7b26\u88ab\u89c6\u4e3a\u666e\u901a\u53c2\u6570\u3002\n  - \u5982\u679c\u9700\u8981\u8fde\u7eed\u6267\u884c\u591a\u4e2a\u547d\u4ee4\uff0c\u8bf7\u4f7f\u7528\u591a\u4e2a `execute_process()` \u8c03\u7528\uff0c\u5e76\u4f7f\u7528\u5355\u4e2a `COMMAND` \u53c2\u6570\u3002\n- `OUTPUT_VARIABLE`\n  - \u53d8\u91cf\u540d\u5c06\u5206\u522b\u7528\u6807\u51c6\u8f93\u51fa\u7ba1\u9053\u7684\u5185\u5bb9\u8bbe\u7f6e\u3002\n- `ERROR_VARIABLE`\n  - \u53d8\u91cf\u540d\u5c06\u5206\u522b\u7528\u6807\u51c6\u9519\u8bef\u7ba1\u9053\u7684\u5185\u5bb9\u8bbe\u7f6e\u3002\n\n\u56e0\u6b64\uff0c\u5217\u51fa\u5f53\u524d\u76ee\u5f55\u4e0b\u6240\u6709\u6587\u4ef6\u5939\uff0c\u5c31\u53ef\u4ee5\u5199\u4e3a\n\n```cmake\nexecute_process(COMMAND ls ${CMAKE_CURRENT_LIST_DIR} OUTPUT_VARIABLE subs)\n</code></pre> <p>\u5176\u4e2d\uff0c\u8f93\u51fa\u7684\u53d8\u91cf\u4e3a <code>subs</code>\uff0c\u8fd9\u4e2a\u64cd\u4f5c\u4ec5\u80fd\u5728\u652f\u6301 <code>ls</code> \u547d\u4ee4\u7684\u7ec8\u7aef\u4e0a\u4f7f\u7528\uff0c\u4f8b\u5982 <code>Shell</code>\u3001<code>Windows PowerShell</code> \u7b49\u3002</p>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/04-%E8%BF%90%E7%AE%97%E7%AC%A6%E4%B8%8E%E6%9D%A1%E4%BB%B6%E3%80%81%E5%BE%AA%E7%8E%AF%E8%AF%AD%E5%8F%A5/#412-file","title":"4.1.2 \u4f7f\u7528 file \u64cd\u4f5c","text":"<p>\u4e3a\u5b9e\u73b0\u540c\u6837\u6548\u679c\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u66f4\u52a0\u901a\u7528\u7684 <code>file</code> \u547d\u4ee4</p> <pre><code>set(cur_path \"${CMAKE_CURRENT_LIST_DIR}\")\nfile(GLOB subs RELATIVE \"${cur_path}\" \"${cur_path}/*\")\n</code></pre> <p>\u5176\u4e2d\uff0c\u8f93\u51fa\u7684\u53d8\u91cf\u4e3a <code>subs</code></p>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/04-%E8%BF%90%E7%AE%97%E7%AC%A6%E4%B8%8E%E6%9D%A1%E4%BB%B6%E3%80%81%E5%BE%AA%E7%8E%AF%E8%AF%AD%E5%8F%A5/#42","title":"4.2 \u7528\u6cd5\u793a\u4f8b","text":"<p>\u4f8b\u5982\uff0c\u5217\u51fa\u5f53\u524d\u76ee\u5f55\u4e0b\u6240\u6709\u7684\u6587\u4ef6\u5939\uff0c\u5e76\u6dfb\u52a0\u81f3 <code>dirs</code> \u4e2d</p> <pre><code>set(dirs)\nset(cur_path \"${CMAKE_CURRENT_LIST_DIR}\")\nfile(GLOB subs RELATIVE \"${cur_path}\" \"${cur_path}/*\")\n\nforeach(_sub ${subs})\n  if(IS_DIRECTORY ${_sub})\n    list(APPEND dirs ${_sub})\n  endif()\nendforeach()\n</code></pre>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/05-%E7%9B%AE%E6%A0%87%E6%9E%84%E5%BB%BA/","title":"\u301005\u3011\u76ee\u6807\u6784\u5efa","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/05-%E7%9B%AE%E6%A0%87%E6%9E%84%E5%BB%BA/#1","title":"1. \u524d\u671f\u51c6\u5907","text":"<p>\u5728\u5f00\u59cb\u4e4b\u524d\uff0c\u6211\u4eec\u5148\u4e86\u89e3\u4e00\u4e9b\u57fa\u672c\u7684\u77e5\u8bc6\u5e76\u56de\u987e\u301001\u3011\u5b89\u88c5\u4e0e\u57fa\u672c\u4ecb\u7ecd\u7684\u5185\u5bb9\u4f5c\u4e3a\u524d\u671f\u51c6\u5907</p>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/05-%E7%9B%AE%E6%A0%87%E6%9E%84%E5%BB%BA/#11-4","title":"1.1 \u7f16\u8bd1\u7684 4 \u4e2a\u6b65\u9aa4","text":"<p>\u7f16\u8bd1\u578b\u8bed\u8a00\u7f16\u8bd1\u4e00\u822c\u90fd\u6709 4 \u4e2a\u6b65\u9aa4\uff0c\u5206\u522b\u662f\uff1a==\u9884\u7f16\u8bd1==\u3001==\u7f16\u8bd1==\u3001==\u6c47\u7f16==\u3001==\u94fe\u63a5==\uff0c\u8fd9\u91cc\u7684\u7f16\u8bd1\u4ec5\u6307\u5c06\u6e90\u4ee3\u7801\u7ffb\u8bd1\u6210\u6c47\u7f16\u4ee3\u7801\u3002\u800c\u6211\u4eec\u5e73\u65f6\u79f0\u7684\u7f16\u8bd1\u5219\u6307\u5c06\u6e90\u4ee3\u7801\u7ffb\u8bd1\u6210\u53ef\u6267\u884c\u6587\u4ef6\u7684\u6574\u4e2a\u8fc7\u7a0b\u3002Ubuntu \u4e0b\u5e38\u89c1\u7684\u7f16\u8bd1\u5de5\u5177\u662f Unix Makefiles\uff0c\u6211\u4eec\u5728\u7ec8\u7aef\u8f93\u5165</p> <pre><code>make\n</code></pre> <p>\u7684\u65f6\u5019\uff0c\u7528\u5230\u7684\u5c31\u662f Unix Makefiles\u3002\u800c\u6240\u6709\u7684\u7f16\u8bd1\u5de5\u5177\u5747\u4f1a\u6839\u636e\u6307\u5b9a\u7684\u6216\u8005\u9ed8\u8ba4\u7684\u73af\u5883\u53d8\u91cf\uff0c\u4f8b\u5982\u5728 Makefile \u6587\u4ef6\u4e2d\uff0c\u53ef\u80fd\u53ef\u4ee5\u627e\u5230\u7c7b\u4f3c</p> <pre><code>CC = gcc\nCXX = g++\n</code></pre> <p>\u7684\u5185\u5bb9\uff0c\u4ece\u800c\u9009\u62e9\u6307\u5b9a\u7684\u7f16\u8bd1\u5668\u3002\u7f16\u8bd1\u5668\u5219\u6839\u636e\u7f16\u8bd1\u5de5\u5177\u6240\u5236\u5b9a\u7684\u89c4\u5219\u5bf9\u4e00\u7cfb\u5217\u6e90\u7801\u8fdb\u884c\u89e3\u6790\u3001\u7f16\u8bd1\u3001\u94fe\u63a5\uff0c\u4f8b\u5982\u53ef\u4ee5\u5728 Makefile \u6587\u4ef6\u4e2d\u6307\u5b9a</p> <pre><code>CFLAGS = -g -O2\n</code></pre> <p>\u5e76\u4f7f\u7528\u7c7b\u4f3c</p> <pre><code>$(CC) $(CFLAGS)\n</code></pre> <p>\u7684\u8bed\u53e5\u5b8c\u6210\u5bf9\u7f16\u8bd1\u5668\u76f8\u5173\u7f16\u8bd1\u9009\u9879\u7684\u8bbe\u7f6e\uff0c\u6700\u7ec8\u5728\u7f16\u8bd1\u65f6\u751f\u6210\u5bf9\u5e94\u7684\u7b26\u5408\u8981\u6c42\u7684\u76ee\u6807\uff08\u53ef\u6267\u884c\u6587\u4ef6\u3001\u52a8\u6001\u5e93\u3001\u9759\u6001\u5e93\uff09</p>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/05-%E7%9B%AE%E6%A0%87%E6%9E%84%E5%BB%BA/#12-cmake","title":"1.2 \u56de\u987e CMake \u7684\u5730\u4f4d","text":"<p>CMake \u4f5c\u4e3a\u4e00\u4e2a\u8de8\u5e73\u53f0\u7684\u7f16\u8bd1\u5de5\u5177\uff0c\u80fd\u591f\u4f7f\u7528\u901a\u7528\u7684\u8bed\u6cd5\uff08\u7ec4\u6001\u6863\uff09\u751f\u6210\u7f16\u8bd1\u5de5\u5177\u80fd\u591f\u89e3\u6790\u7684\u6587\u4ef6\uff08\u5efa\u6784\u6863\uff09\uff0c\u4ece\u800c\u5b8c\u6210\u5bf9\u9879\u76ee\u7684\u6784\u5efa\uff0c\u4f8b\u5982\u4f1a\u751f\u6210</p> <ul> <li>MSBuild \u80fd\u591f\u89e3\u6790\u7684 <code>.sln</code> \u548c <code>.vcxproj</code> \u6587\u4ef6</li> <li>Unix Makefiles \u80fd\u591f\u89e3\u6790\u7684 <code>Makefile</code> \u6587\u4ef6</li> <li>MinGW Makefiles \u80fd\u591f\u89e3\u6790\u7684 <code>Makefile</code> \u6587\u4ef6</li> <li>Ninja \u80fd\u591f\u89e3\u6790\u7684 <code>build.ninja</code> \u6587\u4ef6</li> </ul>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/05-%E7%9B%AE%E6%A0%87%E6%9E%84%E5%BB%BA/#13","title":"1.3 \u52a8\u6001\u5e93 / \u9759\u6001\u5e93","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/05-%E7%9B%AE%E6%A0%87%E6%9E%84%E5%BB%BA/#131","title":"1.3.1 \u662f\u4ec0\u4e48","text":"<p>\u5728 Windows \u4e0b\uff0c\u7ecf\u5e38\u4f1a\u770b\u5230\u6269\u5c55\u540d\u4e3a<code>.dll</code>\u7684\u6587\u4ef6\uff0c\u79f0\u4e3a\u52a8\u6001\u94fe\u63a5\u5e93<code>Dynamic-Link Library</code>\u3002\u540c\u6837\uff0c\u5728Ubuntu\u4e0b<code>/usr/local/lib</code>\u76ee\u5f55\u4e0b\u4e5f\u80fd\u770b\u5230\u4e00\u7cfb\u5217\u540d\u4e3a<code>*.so</code>\u7684\u6587\u4ef6\uff0c\u79f0\u4e3a\u5171\u4eab\u5bf9\u8c61<code>Shared Object</code>\uff0c\u8fd9\u4e00\u7c7b\u90fd\u5c5e\u4e8e\u52a8\u6001\u5e93\u3002</p> <p>\u53e6\u5916\uff0c\u5728 Windows \u4e0b\u4e5f\u6709\u90e8\u5206\u6269\u5c55\u540d\u4e3a<code>*.lib</code>\u7684\u6587\u4ef6\uff0cUbuntu \u4e0b\u4e5f\u8bb8\u80fd\u5728<code>/usr/local/lib</code>\u76ee\u5f55\u4e0b\u770b\u5230\u4e00\u4e9b<code>*.a</code>\u6587\u4ef6\uff0c\u8fd9\u4e9b\u90fd\u5c5e\u4e8e\u9759\u6001\u5e93\u3002</p> <p>::: tip Windows \u4e0b\u7684<code>*.lib</code>\u6587\u4ef6\u6709\u4e24\u79cd\uff0c\u4e00\u79cd\u662f\u9759\u6001\u5e93\uff0c\u4e00\u79cd\u662fDLL\u5bfc\u5165\u5e93\uff0c\u540e\u8005\u5c45\u591a\uff0c\u4e0d\u8fc7\u5728 CMake \u5f00\u53d1\u4e0a\u7b80\u5355\u5f53\u505a\u9759\u6001\u5e93\u4e5f\u662f\u53ef\u4ee5\u7684\u3002 :::</p>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/05-%E7%9B%AE%E6%A0%87%E6%9E%84%E5%BB%BA/#132","title":"1.3.2 \u533a\u522b","text":"<ol> <li> <p>\u9759\u6001\u5e93\u2014\u2014\u8fd9\u79cd\u5e93\u5728\u7f16\u8bd1\u7684\u65f6\u5019\u4f1a\u76f4\u63a5\u6574\u5408\u5230\u76ee\u6807\u7a0b\u5e8f\u4e2d\uff0c\u6240\u4ee5\u5229\u7528\u9759\u6001\u5e93\u7f16\u8bd1\u6210\u7684\u6587\u4ef6\u4f1a\u6bd4\u8f83\u5927\uff0c\u8fd9\u7c7b\u51fd\u6570\u5e93\u6700\u5927\u7684\u4f18\u70b9\u5c31\u662f\u7f16\u8bd1\u6210\u529f\u7684\u53ef\u6267\u884c\u6587\u4ef6\u53ef\u4ee5\u72ec\u7acb\u8fd0\u884c\uff0c\u800c\u4e0d\u518d\u9700\u8981\u5411\u5916\u90e8\u8981\u6c42\u8bfb\u53d6\u51fd\u6570\u5e93\u7684\u5185\u5bb9\uff1b\u4f46\u662f\u4ece\u5347\u7ea7\u96be\u6613\u5ea6\u6765\u770b\u660e\u663e\u6ca1\u6709\u4f18\u52bf\uff0c\u5982\u679c\u51fd\u6570\u5e93\u66f4\u65b0\uff0c\u9700\u8981\u91cd\u65b0\u7f16\u8bd1\u3002</p> </li> <li> <p>\u52a8\u6001\u5e93\u2014\u2014\u4e0e\u9759\u6001\u51fd\u6570\u5e93\u88ab\u6574\u4e2a\u6355\u6349\u5230\u7a0b\u5e8f\u4e2d\u4e0d\u540c\uff0c\u52a8\u6001\u51fd\u6570\u5e93\u5728\u7f16\u8bd1\u7684\u65f6\u5019\uff0c\u5728\u7a0b\u5e8f\u91cc\u53ea\u6709\u4e00\u4e2a\u7b26\u53f7\u800c\u5df2\uff0c\u4e5f\u5c31\u662f\u8bf4\u5f53\u53ef\u6267\u884c\u6587\u4ef6\u9700\u8981\u4f7f\u7528\u5230\u51fd\u6570\u5e93\u7684\u673a\u5236\u65f6\uff0c\u7a0b\u5e8f\u624d\u4f1a\u53bb\u89e3\u6790\u8fd9\u4e2a\u7b26\u53f7\u5e76\u5b8c\u6210\u52a8\u6001\u5e93\u5730\u5740\u7684\u91cd\u5b9a\u4f4d\uff0c\u4e5f\u5c31\u662f\u8bf4\u53ef\u6267\u884c\u6587\u4ef6\u65e0\u6cd5\u5355\u72ec\u8fd0\u884c\u3002\u8fd9\u6837\u4ece\u4ea7\u54c1\u529f\u80fd\u5347\u7ea7\u7684\u89d2\u5ea6\u6765\u8bf4\u662f\u65b9\u4fbf\u7684\uff0c\u53ea\u8981\u66ff\u6362\u5bf9\u5e94\u52a8\u6001\u5e93\u5373\u53ef\u5b8c\u6210\u5347\u7ea7\uff0c\u4e0d\u5fc5\u91cd\u65b0\u7f16\u8bd1\u6574\u4e2a\u53ef\u6267\u884c\u6587\u4ef6\u3002</p> </li> </ol>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/05-%E7%9B%AE%E6%A0%87%E6%9E%84%E5%BB%BA/#2","title":"2. \u76ee\u6807\u6784\u5efa","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/05-%E7%9B%AE%E6%A0%87%E6%9E%84%E5%BB%BA/#21","title":"2.1 \u56de\u987e\uff1a\u53ef\u6267\u884c\u6587\u4ef6\u6784\u5efa","text":"<p>\u73b0\u7ed9\u5b9a\u4e00\u4e2a\u6587\u4ef6\u67b6\u6784\uff1a</p> <pre><code>.\n\u251c\u2500\u2500 CMakeLists.txt (\u5f85\u521b\u5efa)\n\u2514\u2500\u2500 main.cpp\n</code></pre> <p>\u8fd9\u662f\u6700\u7b80\u5355\u7684\u4e00\u7c7b\u60c5\u51b5\uff0c\u5373\u4ec5\u6709\u4e00\u4e2a <code>*.cpp</code> \u6784\u6210\u53ef\u6267\u884c\u7a0b\u5e8f\u7684\u6e90\u6587\u4ef6\u3002\u5bf9\u4e8e\u8fd9\u79cd\u67b6\u6784\u7684\u6784\u5efa\u65b9\u5f0f\u5728\u301001\u3011\u5b89\u88c5\u4e0e\u57fa\u672c\u4ecb\u7ecd\u4e2d\u5df2\u7ecf\u505a\u8fc7\u4e86\u6f14\u793a\u3002\u5bf9\u4e8e\u8fd9\u79cd\u901a\u5e38\u53ea\u9700\u8981\u77ed\u77ed\u51e0\u884c CMake \u8bed\u53e5\u5373\u53ef\u5b8c\u6210\uff0c\u9996\u5148\u5728\u5f53\u524d\u76ee\u5f55\u76f4\u63a5\u521b\u5efa CMakeLists.txt\uff0c\u8f93\u5165\uff1a</p> <pre><code>cmake_minimum_required(VERSION 3.16) # \u6307\u5b9a CMake \u6700\u5c0f\u7248\u672c\u53f7\uff0c\u5c0f\u4e8e\u6b64\u7248\u672c\u7684\u65e0\u6cd5\u901a\u8fc7 CMake\nproject(MyProject)                   # \u5b9a\u4e49\u9879\u76ee\u540d\nadd_executable(my_main main.cpp)     # \u4f7f\u7528 main.cpp \u751f\u6210\u53ef\u6267\u884c\u6587\u4ef6 my_main\n</code></pre> <p>\u5176\u4e2d<code>my_main</code>\u662f\u76ee\u6807\u540d\uff0c\u5728 CMake \u4e2d\u662f\u5177\u6709<code>TARGET</code>\u5c5e\u6027\u7684\u53d8\u91cf\uff0c\u5373\u76ee\u6807\uff0c\u540c\u65f6\u4e5f\u662f\u53ef\u6267\u884c\u6587\u4ef6\u7684\u6587\u4ef6\u540d\u3002CMake \u63d0\u4f9b\u4e86\u4e00\u7cfb\u5217\u4e0e\u76ee\u6807\u94fe\u63a5\u6709\u5173\u7684\u64cd\u4f5c\u65b9\u5f0f\u3002\u5176\u4e2d\u5982\u679c<code>my_main</code>\u76ee\u6807\u4f9d\u8d56\u4e86\u5176\u4ed6\u7684\u76ee\u6807\uff0c\u4f8b\u5982<code>main.cpp</code>\u6587\u4ef6\u4e2d\u4f7f\u7528\u5230\u4e86\u6765\u81ea\u5176\u4ed6<code>*.cpp</code>\u6587\u4ef6\u5b9a\u4e49\u7684\u51fd\u6570\uff0c\u6211\u4eec\u8fd8\u9700\u8981\u5728<code>CMakeLists.txt</code>\u4e2d\u8f93\u5165</p> <pre><code>target_link_libraries(\n  my_main\n  PRIVATE xxxx\n)\n</code></pre> <p>\u8fd9\u91cc\u7684<code>xxxx</code>\u5c31\u8868\u793a\u5305\u542b\u4e86\u8fd9\u4e9b\u51fd\u6570\u5b9a\u4e49\u7684\u76ee\u6807\u3002\u8fd9\u91cc\u8868\u793a\u9700\u8981\u5c06<code>my_main</code>\u8fd9\u4e2a\u76ee\u6807\u94fe\u63a5\u81f3<code>xxxx</code>\u4e0a\u3002</p> <p>\u6b64\u5916\uff0c\u6587\u6863\u4e2d\u7ed9\u51fa\u4e86\u8fd9\u6837\u4e00\u53e5\u8bdd\uff1a</p> <p>New in version 3.13: The <code>&lt;target&gt;</code> doesn't have to be defined in the same directory as the <code>target_link_libraries</code> call.</p> <p>\u7ffb\u8bd1\u8fc7\u6765\u5c31\u662f</p> <p>3.13 \u7248\u672c\u7684\u65b0\u5185\u5bb9\uff1a<code>&lt;target&gt;</code>\u4e0d\u9700\u8981\u5728\u4e0e\u8c03\u7528<code>target_link_libraries</code>\u547d\u4ee4\u76f8\u540c\u7684\u76ee\u5f55\u4e2d\u88ab\u5b9a\u4e49\u3002</p> <p>\u8fd9\u53e5\u8bdd\u5f88\u5173\u952e\uff0c\u8868\u793a\u5728\u8f83\u65b0\u7684 CMake \u7248\u672c\u4e2d\uff0c\u5141\u8bb8\u5728\u6574\u4e2a\u9879\u76ee\u4e2d\u8de8<code>CMakeLists.txt</code>\u6587\u4ef6\u8fdb\u884c\u94fe\u63a5\u64cd\u4f5c\uff0c\u4f8b\u5982\uff0c\u5373\u4f7f\u4e0a\u6587\u7684<code>my_main</code>\u5728\u7236\u76ee\u5f55\u7684\u4f5c\u7528\u57df\uff0c<code>xxxx</code>\u5728\u5b50\u76ee\u5f55\u7684\u4f5c\u7528\u57df\uff0c<code>my_main</code>\u6240\u5728\u7684<code>CMakeLists.txt</code>\u4e5f\u80fd\u8bbf\u95ee\u5230<code>xxxx</code>\u8fd9\u4e00\u76ee\u6807\u53d8\u91cf\u3002\u8fd9\u4e00\u70b9\u6709\u522b\u4e8e\u666e\u901a\u7684\u53d8\u91cf\uff0c\u53ef\u4ee5\u5f53\u505a\u662f\u5177\u6709\u76ee\u6807\u5c5e\u6027\u7684\u53d8\u91cf\u7684\u4e13\u5c5e\u529f\u80fd\u3002</p> <p>\u53e6\u5916\u4ee3\u7801\u4e2d\u8fd8\u51fa\u73b0\u4e86<code>PRIVATE</code>\u7684\u6807\u5fd7\uff0c\u8fd9\u4e2a\u5c5e\u4e8e\u76ee\u6807\u7684\u4f20\u64ad\u65b9\u5f0f\uff0c\u5728\u540e\u6587\u4f1a\u8fdb\u884c\u4ecb\u7ecd\u3002</p>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/05-%E7%9B%AE%E6%A0%87%E6%9E%84%E5%BB%BA/#22","title":"2.2 \u666e\u901a\u5e93\u76ee\u6807\u6784\u5efa","text":"<p>\u5728\u6587\u4ef6\u7ed3\u6784\u590d\u6742\u65f6\uff0c\u6216\u8005\u9700\u8981\u5c06\u529f\u80fd\u6a21\u5757\u9694\u79bb\u3001\u62bd\u8c61\u51fa\u6765\u65f6\uff0c\u7ecf\u5e38\u9700\u8981\u4e3a\u67d0\u4e2a\u6a21\u5757\u6784\u5efa\u4e00\u4e2a\u5e93\uff0c\u6700\u7ec8\u5c06\u8fd9\u4e9b\u5e93\u94fe\u63a5\u81f3\u53ef\u6267\u884c\u6587\u4ef6\u7684\u76ee\u6807\u4e0a\u3002</p> <p>\u8bed\u6cd5\u662f\uff1a<code>add_library(\u76ee\u6807\u540d [SHARED | [STATIC]] \u6e90\u6587\u4ef6)</code></p> <p>\u8fd8\u662f\u521a\u624d\u7684\u6587\u4ef6\u7ed3\u6784\uff0c\u5148\u521b\u5efa\u65b0\u7684\u6587\u4ef6\u5939\u53ca\u6587\u4ef6\uff1a</p> <pre><code>.\n\u251c\u2500\u2500 CMakeLists.txt\n\u251c\u2500\u2500 main.cpp\n\u2514\u2500\u2500 MyLib1\n    \u251c\u2500\u2500 CMakeLists.txt (\u5f85\u521b\u5efa)\n    \u251c\u2500\u2500 include\n    \u2502\u00a0\u00a0 \u2514\u2500\u2500 MyLib1.h\n    \u2514\u2500\u2500 src\n        \u251c\u2500\u2500 a.cpp\n        \u251c\u2500\u2500 b.cpp\n        \u2514\u2500\u2500 c.cpp\n</code></pre> <p>\u9996\u5148\u9879\u76ee\u6839\u76ee\u5f55\u7684<code>CMakeLists.txt</code>\u9700\u8981\u6dfb\u52a0</p> <pre><code>add_subdirectory(MyLib1)\n</code></pre> <p>\u6765\u8ba9\u8be5\u6a21\u5757\u6dfb\u52a0\u81f3\u8be5\u9879\u76ee\u3002\u6b64\u5916\uff0c\u6bcf\u4e2a\u5e93\u9700\u8981\u6709\u4e00\u4e2a\u5355\u72ec\u7684<code>CMakeLists.txt</code>\u8fdb\u884c\u7ba1\u7406\uff0c\u56e0\u6b64\u9700\u8981\u5728<code>MyLib1</code>\u6587\u4ef6\u5939\u5185\u521b\u5efa\u8be5\u6587\u4ef6\uff0c\u5185\u5bb9\u5982\u4e0b\uff1a</p> <pre><code># \u641c\u7d22 src \u6587\u4ef6\u5939\u4e0b\u7684\u6240\u6709\u6e90\u6587\u4ef6\uff0c\u5e76\u6dfb\u52a0\u81f3\u5c40\u90e8\u53d8\u91cf\uff1amy_lib_dir\n# \u9898\u5916\u8bdd\uff1aaux \u8868\u793a auxiliary \u5373\u8f85\u52a9\u7684\u610f\u601d\uff0c\u8868\u793a\u8fd9\u4e2a\u529f\u80fd\u662f\u4e2a\u8f85\u52a9\u529f\u80fd\naux_source_directory(src my_lib_dir)\n# SHARED \u8868\u793a\u8be5\u76ee\u6807\u4e3a\u52a8\u6001\u5e93\uff0cSTATIC \u5219\u8868\u793a\u9759\u6001\u5e93\nadd_library(MyLib1 SHARED ${my_lib_dir})\n# \u4ee5\u4e0a\u5185\u5bb9\u4e5f\u53ef\u4ee5\u5199\u6210\u4e0b\u4e00\u884c\uff0c\u4f46\u8fd9\u4e48\u957f\u7684\u540d\u5b57\uff0c\u8c01\u4f1a\u8fd9\u4e48\u505a\u5462\uff1f\n# add_library(MyLib1 SHARED src/a.cpp src/b.cpp src/c.cpp)\n</code></pre> <p>\u6ce8\u610f\uff0c\u6b64\u5904\u751f\u6210\u7684\u52a8\u6001\u5e93 <code>libMyLib1.so</code> \u65e0\u6cd5\u505a\u5230\u5185\u5b58\u4e0a\u7684\u590d\u7528\uff0c\u5728\u591a\u4e2a\u8fdb\u7a0b\u4f7f\u7528\u5230\u8be5\u52a8\u6001\u5e93\u65f6\uff0c\u4ecd\u7136\u4f1a\u5f00\u8f9f\u4e00\u5757\u5185\u5b58\u5b58\u50a8\u8be5\u52a8\u6001\u5e93\u5185\u5bb9\u3002\u4e3a\u4e86\u771f\u6b63\u5b9e\u73b0\u5185\u5b58\u4e0a\u7684\u590d\u7528\uff0c\u9700\u8981\u4f7f\u7528\u5730\u5740\u65e0\u5173\u4ee3\u7801\u673a\u5236(position-independent code)\uff1a</p> <pre><code>set(CMAKE_CXX_FLAGS \"${CMAKE_CXX_FLAGS} -fPIC\")\n</code></pre> <p>\u8bdd\u8bf4\u56de\u6765\uff0c\u672c\u5e93\u5185\u7684\u4e09\u4e2a\u6e90\u6587\u4ef6\u90fd\u4f1a\u5305\u62ec <code>include</code> \u5934\u6587\u4ef6\u5939\u4e2d\u7684\u5185\u5bb9\uff0c\u56e0\u6b64\u5728\u7f16\u8bd1\u65f6\u9700\u8981\u7ed9\u76ee\u6807\u6dfb\u52a0\u5934\u6587\u4ef6\u7684\u641c\u7d22\u8def\u5f84\uff1a</p> <pre><code>target_include_directories(MyLib1 PUBLIC include)\n# \u8fd9\u53e5\u547d\u4ee4\u8868\u793a\uff0c\u4e3a MyLib1 \u76ee\u6807\u6dfb\u52a0\u5f53\u524d CMakeLists.txt \u6240\u5728\u76ee\u5f55\u4e0b include \u6587\u4ef6\u5939\u7684\u641c\u7d22\u8def\u5f84\n# PUBLIC \u89c4\u5b9a MyLib1 \u7684\u5305\u542b\u76ee\u5f55\u641c\u7d22\u8def\u5f84\u4ee5\u516c\u5f00\u65b9\u5f0f\u4f20\u9012\u7ed9\u5176\u4f59\u76ee\u6807\n# \u751f\u6210\u7684\u5efa\u6784\u6863\u4e2d\u4f1a\u5305\u542b\u5f62\u5982\u4ee5\u4e0b\u7684\u5185\u5bb9 gcc mylib1.cpp -I include -o MyLib1\n</code></pre> <p>\u4e0a\u6587\u7684 <code>PUBLIC</code> \u5c5e\u6027\uff0c\u6709\u65f6\u5019\u8fd8\u4f1a\u89c1\u5230 <code>INTERFACE</code>\u3001<code>PRIVATE</code> \u5c5e\u6027\uff0c\u4e00\u5171 3 \u4e2a\u4f20\u9012\u65b9\u5f0f\u3002\u4e0b\u9762\u5bf9\u8fd9\u4e09\u4e2a\u4f20\u9012\u65b9\u5f0f\u505a\u4e2a\u4ecb\u7ecd\uff1a</p> <ul> <li><code>PUBLIC</code>\uff1a\u5728\u7ed1\u5b9a\u5f53\u524d\u76ee\u6807\u65f6\u7ed9\u6307\u5b9a\u7684\u5185\u5bb9\u8bbe\u7f6e\u516c\u6709\u5c5e\u6027\uff0c\u5176\u4ed6\u76ee\u6807\u5728\u94fe\u63a5\u5f53\u524d\u76ee\u6807\u65f6\uff0c\u80fd\u8bbf\u95ee\u8fd9\u4e9b\u6307\u5b9a\u7684\u5185\u5bb9</li> <li><code>PRIVATE</code>\uff1a\u5728\u7ed1\u5b9a\u5f53\u524d\u76ee\u6807\u65f6\u7ed9\u6307\u5b9a\u7684\u5185\u5bb9\u8bbe\u7f6e\u79c1\u6709\u5c5e\u6027\uff0c\u5176\u4ed6\u76ee\u6807\u5728\u94fe\u63a5\u5f53\u524d\u76ee\u6807\u65f6\uff0c\u65e0\u6cd5\u8bbf\u95ee\u8fd9\u4e9b\u5185\u5bb9</li> <li><code>INTERFACE</code>\uff1a\u5728\u7ed1\u5b9a\u5f53\u524d\u76ee\u6807\u65f6\u7ed9\u6307\u5b9a\u7684\u5185\u5bb9\u8bbe\u7f6e\u63a5\u53e3\u5c5e\u6027\uff0c\u901a\u5e38\u5728\u63a5\u53e3\u5e93\u4e2d\u4f7f\u7528\u3002\u5176\u4ed6\u76ee\u6807\u5728\u94fe\u63a5\u5f53\u524d\u76ee\u6807\u65f6\uff0c\u53ea\u5141\u8bb8\u8bbf\u95ee\u5176\u58f0\u660e\uff08\u63a5\u53e3\uff09</li> </ul> <p>\u6700\u540e\uff0c\u5982\u679c\u6b64\u76ee\u6807\u6709\u4f9d\u8d56</p> <ul> <li>\u672c\u9879\u76ee\u4e2d\u5176\u4ed6\u76ee\u6807</li> <li>\u9879\u76ee\u4ee5\u5916\u7b2c\u4e09\u65b9\u76ee\u6807\uff08\u4f8b\u5982 OpenCV\uff09</li> </ul> <p>\u7684\u5185\u5bb9\uff0c\u90a3\u5fc5\u987b\u8981\u6dfb\u52a0\u4ee5\u4e0b\u5185\u5bb9\uff1a</p> <pre><code>target_link_libraries(\n  MyLib1\n  PUBLIC xxxx\n)\n</code></pre> <p>\u540c\u6837\uff0c\u4e3a\u6307\u5b9a\u76ee\u6807\u94fe\u63a5\u5e93\u7684\u8bed\u53e5\u4e5f\u63d0\u4f9b\u4e86 <code>PUBLIC</code>\u3001<code>PRIVATE</code>\u3001<code>INTERFACE</code> \u4e09\u4e2a\u5c5e\u6027\uff0c\u8fd9\u91cc\u4e0d\u518d\u8d58\u8ff0\u3002</p> <p>\u8fd9\u91cc\u6d89\u53ca\u5230\u7684\u4e24\u4e2a\u8bed\u53e5\uff0c\u6211\u4eec\u505a\u4e2a\u6c47\u603b\uff1a</p> <ul> <li><code>target_include_directories</code>\uff1a\u4e3a\u76ee\u6807\u6dfb\u52a0\u9700\u8981\u5305\u542b\u7684\u6587\u4ef6\uff08\u4e00\u822c\u662f\u5934\u6587\u4ef6\uff09\u7684\u641c\u7d22\u8def\u5f84\uff0c\u8be5\u8def\u5f84\u5c06\u7ed1\u5b9a\u81f3\u76ee\u6807\u4e0a</li> <li><code>target_link_libraries</code>\uff1a\u4e3a\u76ee\u6807\u6dfb\u52a0\u4f9d\u8d56\u7684\u5e93\uff0c\u8be5\u5e93\u4e5f\u5c06\u7ed1\u5b9a\u81f3\u76ee\u6807\u4e0a</li> </ul> <p>::: important \u4e0a\u6587\u7684\u5934\u6587\u4ef6\u641c\u7d22\u8def\u5f84\u5c5e\u4e8e\u76ee\u6807\u5c5e\u6027\u5f53\u4e2d \u201c\u4f7f\u7528\u8981\u6c42\u201d \u7684\u4e00\u90e8\u5206\uff0c\u6b64\u5916\u8fd8\u6709\u5176\u4ed6\u4e24\u79cd\u4f7f\u7528\u8981\u6c42\uff0c\u4f8b\u5982\u4f7f\u7528</p> <pre><code>add_library(mylib1 SHARED mylib1.cpp)\n\ntarget_compile_options(mylib1 PUBLIC -Wall)\n# \u8fd9\u53e5\u547d\u4ee4\u8868\u793a\uff0c\u5728\u6784\u5efa mylib1 \u76ee\u6807\u65f6\u6dfb\u52a0 -Wall \u9009\u9879\n# PUBLIC \u89c4\u5b9a mylib1 \u7684 -Wall \u7f16\u8bd1\u9009\u9879\u5c06\u4f1a\u4f20\u9012\u7ed9\u5176\u4f59\u76ee\u6807\n# \u751f\u6210\u7684\u5efa\u6784\u6863\u4e2d\u4f1a\u5305\u542b\u5f62\u5982\u4ee5\u4e0b\u7684\u5185\u5bb9 gcc -fPIC -shared main.cpp -o libmylib1.so -Wall \n</code></pre> <p>\u4ee5\u53ca</p> <pre><code>target_compile_definitions(mylib1 PRIVATE HAVE_ABC)\n# \u8fd9\u53e5\u547d\u4ee4\u8868\u793a\uff0c\u5728\u6784\u5efa mylib1 \u76ee\u6807\u65f6\u6dfb\u52a0 -D HAVE_ABC \u9009\u9879\n# PRIVATE \u89c4\u5b9a mylib1 \u7684 HAVE_ABC \u9884\u7f16\u8bd1\u5b8f\u4e0d\u4f20\u9012\u7ed9\u5176\u4f59\u76ee\u6807\n# \u751f\u6210\u7684\u5efa\u6784\u6863\u4e2d\u4f1a\u5305\u542b\u5f62\u5982\u4ee5\u4e0b\u7684\u5185\u5bb9 gcc -fPIC -shared main.cpp -o libmylib1.so -D HAVE_ABC\n</code></pre> <p>\u8fd9\u4e9b\u90fd\u5c5e\u4e8e\u76ee\u6807\u5c5e\u6027\u5f53\u4e2d\u7684\u4f7f\u7528\u8981\u6c42\uff0c\u800c <code>target_link_libraries</code> \u5219\u4fdd\u8bc1\u4e86\u4ee5\u4e0a\u4f7f\u7528\u8981\u6c42\u8be5\u5982\u4f55\u88ab\u4f20\u9012\u3002</p> <p><pre><code>add_executable(demo main.cpp)\n\ntarget_link_libraries(demo PRIVATE mylib1)\n# \u8fd9\u53e5\u547d\u4ee4\u8868\u793a\uff0c\u4e3a demo \u76ee\u6807\u94fe\u63a5 mylib1 \u76ee\u6807\n# PRIVATE \u89c4\u5b9a mylib1 \u7684\u4f7f\u7528\u8981\u6c42\u4e0d\u4f20\u9012\u7ed9\u5176\u4f59\u76ee\u6807\n# \u751f\u6210\u7684\u5efa\u6784\u6863\u4e2d\u4f1a\u5305\u542b\u5f62\u5982\u4ee5\u4e0b\u7684\u5185\u5bb9 gcc main.cpp -o demo -Wall -l mylib1\n</code></pre> :::</p>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/05-%E7%9B%AE%E6%A0%87%E6%9E%84%E5%BB%BA/#23","title":"2.3 \u63a5\u53e3\u5e93\u76ee\u6807\u6784\u5efa","text":"<p>\u5728\u7a0b\u5e8f\u5f00\u53d1\u4e2d\uff0c\u6709\u65f6\u5019\u4f1a\u9047\u5230\u53ea\u6709\u5934\u6587\u4ef6\uff08<code>*.h</code>\u3001<code>*.hpp</code>\uff09\uff0c\u800c\u6ca1\u6709\u6e90\u6587\u4ef6\uff08<code>*.c</code>\u3001<code>*.cpp</code>\uff09\u7684\u60c5\u51b5\uff0c\u800c\u6211\u4eec\u77e5\u9053\uff0c\u4e00\u822c\u5728\u4f7f\u7528 <code>add_library</code> \u7684\u65f6\u5019\u53ea\u80fd\u4e3a\u6e90\u6587\u4ef6\uff08<code>*.h</code>\u4ee5\u53ca<code>*.hpp</code>\u4e4b\u7c7b\u7684\u5934\u6587\u4ef6\u4e0d\u5c5e\u4e8e\u6e90\u6587\u4ef6\uff09\u751f\u6210\u76ee\u6807\u5e93\u3002</p> <p>\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u5982\u679c\u6211\u4eec\u9700\u8981\u5bf9\u53ea\u6709\u5934\u6587\u4ef6\u7684\u5e93\u751f\u6210\u76ee\u6807\uff0c\u5e76\u4e14\u8fdb\u884c\u94fe\u63a5\uff0c\u6211\u4eec\u9700\u8981\u521b\u5efa\u63a5\u53e3\u5e93\u3002\u8fd9\u79cd\u76ee\u6807\u7531\u4e8e\u6ca1\u6709\u6e90\u6587\u4ef6\uff0c\u4e0d\u4f1a\u5b9e\u8d28\u6027\u7684\u53c2\u4e0e\u6784\u5efa\uff08\u7f16\u8bd1\uff09\uff0c\u4f46\u63d0\u4f9b\u4e86\u4e0e\u666e\u901a\u76ee\u6807\u76f8\u540c\u7684\u64cd\u4f5c\u65b9\u5f0f\uff0c\u56e0\u6b64\u63a5\u53e3\u5e93\u5c5e\u4e8e\u4f2a\u76ee\u6807\u3002</p> <p>\u8fd8\u662f\u521a\u624d\u7684\u6587\u4ef6\u7ed3\u6784\uff0c\u5148\u521b\u5efa\u53ea\u6709\u5934\u6587\u4ef6\u7684\u6587\u4ef6\u5939\u53ca <code>CMakeLists.txt</code>\uff1a</p> <pre><code>.\n\u251c\u2500\u2500 CMakeLists.txt\n\u251c\u2500\u2500 main.cpp\n\u251c\u2500\u2500 MyLib1\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 CMakeLists.txt\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 include\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 MyLib1.h\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 src\n\u2502\u00a0\u00a0     \u251c\u2500\u2500 a.cpp\n\u2502\u00a0\u00a0     \u251c\u2500\u2500 b.cpp\n\u2502\u00a0\u00a0     \u2514\u2500\u2500 c.cpp\n\u2514\u2500\u2500 MyLib2\n    \u251c\u2500\u2500 CMakeLists.txt (\u5f85\u521b\u5efa)\n    \u2514\u2500\u2500 include\n        \u2514\u2500\u2500 MyLib2.hpp\n</code></pre> <p>\u9996\u5148\u9879\u76ee\u6839\u76ee\u5f55\u7684 <code>CMakeLists.txt</code> \u9700\u8981\u6dfb\u52a0</p> <pre><code>add_subdirectory(MyLib2)\n</code></pre> <p>\u521b\u5efa\u63a5\u53e3\u5e93\u7684\u8bed\u6cd5\u4e0e\u666e\u901a\u5e93\u7c7b\u4f3c\uff0c\u53ea\u662f\u5c11\u4e86\u6e90\u6587\u4ef6\u7684\u6dfb\u52a0\u7684\u6b65\u9aa4\uff1a</p> <pre><code>add_library(MyLib2 INTERFACE)\ntarget_include_directories(\n  MyLib2\n  INTERFACE include # \u63a5\u53e3\u5e93\u7684\u76ee\u6807\u53ea\u80fd\u4f7f\u7528 INTERFACE \u5c5e\u6027\n)\ntarget_link_libraries(\n  MyLib2\n  INTERFACE xxx\n)\n</code></pre>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/05-%E7%9B%AE%E6%A0%87%E6%9E%84%E5%BB%BA/#24","title":"2.4 \u5bfc\u5165\u76ee\u6807\u6784\u5efa","text":"<p>\u6211\u4eec\u4f1a\u9047\u5230\u8fd9\u79cd\u60c5\u51b5\uff0c\u4ec5\u63d0\u4f9b\u4e86\u82e5\u5e72\u5934\u6587\u4ef6\u548c\u82e5\u5e72\u5e93\u6587\u4ef6\uff08\u4f8b\u5982 <code>*.so</code> \u548c <code>*.a</code>\uff09\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\u6211\u4eec\u65e0\u6cd5\u901a\u8fc7\u81ea\u5df1 <code>add_library</code> \u4ece\u6e90\u6587\u4ef6\u521b\u5efa\u76ee\u6807\uff0c\u6211\u4eec\u9700\u8981\u5f15\u5165\u5bfc\u5165\u76ee\u6807\u3002</p> <p>\u5047\u8bbe\u67d0\u5bb6\u76f8\u673a\u5382\u5546\u7684 SDK \u63d0\u4f9b\u4e86\u4ee5\u4e0b\u5185\u5bb9\uff0c\u5047\u8bbe\u5c06\u5176\u653e\u5728\u4e86\u9879\u76ee\u6587\u4ef6\u5939\u7684 <code>camera</code> \u6587\u4ef6\u5939\u4e0b\uff0c\u8bf7\u6839\u636e\u4ee5\u4e0b\u6587\u4ef6\u7ed3\u6784\u521b\u5efa\u4e00\u4e2a CMake \u76ee\u6807</p> <pre><code>.\n\u251c\u2500\u2500 include\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 CameraApi.h\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 CameraDefine.h\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 CameraStatus.h\n\u2514\u2500\u2500 lib\n    \u2514\u2500\u2500 libMVSDK.so\n</code></pre> <p>\u5728 <code>camera</code> \u6587\u4ef6\u5939\u4e2d\u521b\u5efa <code>CMakeLists.txt</code> \u6587\u4ef6\uff0c\u5199\u5165</p> <pre><code>add_library(camera SHARED IMPORTED)\nset_target_properties(camera PROPERTIES\n  INTERFACE_INCLUDE_DIRECTORIES \"${CMAKE_CURRENT_LIST_DIR}/include\"\n  IMPORTED_LOCATION \"${CMAKE_CURRENT_LIST_DIR}/lib/libMVSDK.so\"\n)\n</code></pre> <p>\u5bf9\u4e8e <code>INTERFACE_INCLUDE_DIRECTORIES</code> \u7684\u5c5e\u6027\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u7528\u5e38\u89c4\u7684\u5199\u6cd5\uff0c\u5199\u6210</p> <pre><code>target_include_directories(\n  camera\n  INTERFACE include\n)\n</code></pre> <p>::: warning - \u5728\u8bbe\u7f6e <code>IMPORTED_LOCATION</code> \u5c5e\u6027\u7684\u65f6\u5019\u9700\u8981\u6307\u5b9a\u7edd\u5bf9\u8def\u5f84 - \u5bf9\u4e8e <code>lib</code> \u76ee\u5f55\u4e2d\u5b58\u5728\u591a\u4e2a <code>*.so</code> \u7b49\u52a8\u6001\u5e93\u7684\u60c5\u51b5\u4e0b\uff0c\u8bf7\u627e\u5230\u771f\u6b63\u7684\u52a8\u6001\u5e93\uff08\u5176\u4ed6\u52a8\u6001\u5e93\u4e00\u822c\u662f\u966a\u886c\u7684\uff09 :::</p>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/05-%E7%9B%AE%E6%A0%87%E6%9E%84%E5%BB%BA/#3","title":"3. \u8865\u5145\u5185\u5bb9","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/05-%E7%9B%AE%E6%A0%87%E6%9E%84%E5%BB%BA/#31","title":"3.1 \u5176\u4f59\u76ee\u6807\u5e93","text":"<p>\u6839\u636eCMake\u5b98\u7f51\u5bf9\u76ee\u6807\u5e93\u7684\u5212\u5206\uff0c\u53ef\u7b80\u5355\u5206\u4e3a\u4e24\u7c7b\uff1a\u4e8c\u8fdb\u5236\u76ee\u6807\u3001\u4f2a\u76ee\u6807\uff0c\u5176\u5927\u81f4\u5185\u5bb9\u5982\u4e0b</p> <pre><code>\u251c\u2500\u2500 \u4e8c\u8fdb\u5236\u76ee\u6807\n\u2502   \u251c\u2500\u2500 \u53ef\u6267\u884c\u6587\u4ef6\n\u2502   \u2514\u2500\u2500 \u4e8c\u8fdb\u5236\u5e93\n\u2502       \u251c\u2500\u2500 \u666e\u901a\u5e93\uff08\u52a8\u6001\u5e93\u3001\u9759\u6001\u5e93\uff09\n\u2502       \u2514\u2500\u2500 \u5bf9\u8c61\u5e93\n\u2514\u2500\u2500 \u4f2a\u76ee\u6807\n    \u251c\u2500\u2500 \u5bfc\u5165\u76ee\u6807\n    \u251c\u2500\u2500 \u522b\u540d\u76ee\u6807\n    \u2514\u2500\u2500 \u63a5\u53e3\u5e93\n</code></pre>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/05-%E7%9B%AE%E6%A0%87%E6%9E%84%E5%BB%BA/#311","title":"3.1.1 \u5bf9\u8c61\u5e93","text":"<p>\u5141\u8bb8\u5c06\u591a\u4e2a\u6e90\u6587\u4ef6\u8bbe\u7f6e\u4e3a\u4e00\u4e2a\u5355\u72ec\u7684\u76ee\u6807\uff0c\u800c\u4e0d\u751f\u6210\u53ef\u6267\u884c\u6587\u4ef6\u6216\u666e\u901a\u5e93\u3002\u5bf9\u8c61\u5e93\u53ef\u4ee5\u88ab\u5176\u4ed6\u76ee\u6807\uff08\u4f8b\u5982\u53ef\u6267\u884c\u6587\u4ef6\u6216\u666e\u901a\u5e93\uff09\u94fe\u63a5\u548c\u4f7f\u7528\u3002</p> <p>\u8981\u521b\u5efa\u4e00\u4e2a\u5bf9\u8c61\u5e93\uff0c\u540c\u6837\u53ef\u4ee5\u4f7f\u7528 <code>add_library</code> \u547d\u4ee4\uff0c\u5e76\u5c06 <code>OBJECT</code> \u5173\u952e\u5b57\u4e0e\u6e90\u6587\u4ef6\u5217\u8868\u4e00\u8d77\u4f7f\u7528\u3002\u4e0b\u9762\u662f\u4e00\u4e2a <code>CMakeLists.txt</code> \u793a\u4f8b\uff1a</p> <pre><code># \u6dfb\u52a0\u5bf9\u8c61\u5e93\nadd_library(\n  my_object_lib\n  OBJECT file1.cpp file2.cpp file3.cpp\n)\n# \u6dfb\u52a0\u53ef\u6267\u884c\u6587\u4ef6\uff0c\u5e76\u94fe\u63a5\u5bf9\u8c61\u5e93\nadd_executable(my_app main.cpp)\ntarget_link_libraries(my_app PRIVATE my_object_lib)\n</code></pre> <p>\u5728\u4e0a\u9762\u7684\u793a\u4f8b\u4e2d\uff0c<code>add_library</code> \u547d\u4ee4\u521b\u5efa\u4e86\u4e00\u4e2a\u540d\u4e3a <code>my_object_lib</code> \u7684\u5bf9\u8c61\u5e93\uff0c\u5e76\u5c06 <code>file1.cpp</code>\u3001<code>file2.cpp</code> \u548c <code>file3.cpp</code> \u4f5c\u4e3a\u6e90\u6587\u4ef6\u3002</p> <p>\u901a\u8fc7\u8fd9\u79cd\u65b9\u5f0f\uff0c\u5bf9\u8c61\u5e93\u4e2d\u7684\u6e90\u6587\u4ef6\u5c06\u4f1a\u88ab\u7f16\u8bd1\u4e3a\u76ee\u6807\u6587\u4ef6\uff0c\u4f46\u4e0d\u4f1a\u751f\u6210\u4e00\u4e2a\u72ec\u7acb\u7684\u53ef\u6267\u884c\u6587\u4ef6\u6216\u5171\u4eab\u5e93\u3002\u5176\u4ed6\u76ee\u6807\u53ef\u4ee5\u94fe\u63a5\u5230\u5bf9\u8c61\u5e93\uff0c\u5e76\u5728\u94fe\u63a5\u65f6\u4f7f\u7528\u5176\u4e2d\u7684\u76ee\u6807\u6587\u4ef6\u548c \u201c\u4f7f\u7528\u8981\u6c42\u201d\uff0c\u4f8b\u5982</p> <pre><code># \u6dfb\u52a0\u540d\u4e3a obj \u7684\u5bf9\u8c61\u5e93\nadd_library(obj OBJECT obj.cpp)\n# \u5c06 include \u76ee\u5f55\u6dfb\u52a0\u5230 obj \u7684\u5305\u542b\u76ee\u5f55\u4e2d\ntarget_include_directories(obj PUBLIC include)\n\n# \u6dfb\u52a0\u540d\u4e3a bbb \u7684\u52a8\u6001\u5e93\nadd_library(bbb SHARED bbb.cpp)\n# \u94fe\u63a5 obj \u5bf9\u8c61\u5e93\uff0cobj \u7684\u5305\u542b\u76ee\u5f55\u5c06\u4f1a\u4f20\u9012\u7ed9 bbb\ntarget_link_libraries(bbb PUBLIC obj)\n</code></pre> <p>::: tip \u6b64\u65f6 <code>bbb</code> \u52a8\u6001\u5e93\u5c06\u7531 <code>bbb.cpp.o</code> \u548c <code>obj.cpp.o</code> \u4e24\u4e2a\u76ee\u6807\u6587\u4ef6\u5236\u4f5c\u800c\u6210\uff0c\u5176\u4e2d <code>obj.cpp.o</code> \u7531 <code>obj</code> \u5bf9\u8c61\u5e93\u7f16\u8bd1\u800c\u6765\uff0c<code>bbb.cpp.o</code> \u7531 <code>main.cpp</code> \u7f16\u8bd1\u800c\u6765\u3002==\u8fd9\u91cc\u53ea\u662f\u7f16\u8bd1\uff0c\u6ca1\u6709\u94fe\u63a5\u3002==</p> <p>\u4f46\u8981\u6ce8\u610f\uff0c\u5bf9\u8c61\u5e93\u6240\u6307\u4ee3\u7684\u5bf9\u8c61\u6587\u4ef6\uff08\u4f8b\u5982\u4e0a\u6587\u7684 <code>obj</code> \u5bf9\u8c61\u5e93\u5219\u6307\u4ee3 <code>obj.cpp.o</code>\uff09\u4e0d\u4f1a\u4ece <code>bbb</code> \u4f20\u9012\u5230\u5176\u4ed6\u76ee\u6807\uff0c\u4f8b\u5982\u73b0\u5728\u518d\u5199\u5165\u4ee5\u4e0b\u547d\u4ee4</p> <pre><code>add_executable(demo main.cpp)\ntarget_link_libraries(demo PRIVATE bbb)\n</code></pre> <p><code>obj</code> \u5bf9\u8c61\u5e93\u7684 <code>obj.cpp.o</code> \u5bf9\u8c61\u6587\u4ef6\u4e0d\u4f1a\u4f20\u9012\u7ed9 <code>demo</code> \u53ef\u6267\u884c\u6587\u4ef6\u76ee\u6807\uff0c\u53ef\u53c2\u8003 CMake \u5b98\u7f51\u7684\u6587\u6863\u4e86\u89e3\u66f4\u591a\u5173\u4e8e\u5bf9\u8c61\u5e93\u7684\u5185\u5bb9 - \u5bf9\u8c61\u5e93 - <code>target_link_libraries</code> - \u5bf9\u8c61\u5e93 - <code>add_library</code> :::</p>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/05-%E7%9B%AE%E6%A0%87%E6%9E%84%E5%BB%BA/#312","title":"3.1.2 \u522b\u540d\u76ee\u6807","text":"<p>\u5141\u8bb8\u4e3a\u73b0\u6709\u7684\u76ee\u6807\u521b\u5efa\u4e00\u4e2a\u53ef\u4f9b\u5f15\u7528\u7684\u522b\u540d\u3002\u522b\u540d\u76ee\u6807\u53ef\u4ee5\u7528\u4e8e\u7b80\u5316\u6784\u5efa\u8fc7\u7a0b\u3001\u91cd\u547d\u540d\u76ee\u6807\u6216\u521b\u5efa\u4fbf\u4e8e\u5f15\u7528\u7684\u540d\u79f0\u3002</p> <p>\u8981\u521b\u5efa\u522b\u540d\u76ee\u6807\uff0c\u53ef\u4ee5\u4f7f\u7528 <code>add_library</code>\u3001<code>add_executable</code> \u6216 <code>add_custom_target</code> \u547d\u4ee4\uff0c\u5e76\u5c06 <code>ALIAS</code> \u5173\u952e\u5b57\u4e0e\u76ee\u6807\u540d\u79f0\u4e00\u8d77\u4f7f\u7528\u3002\u4e0b\u9762\u662f\u4e00\u4e2a <code>CMakeLists.txt</code> \u793a\u4f8b\uff1a</p> <pre><code># \u6dfb\u52a0\u4e00\u4e2a\u5e93\nadd_library(my_library STATIC my_source.cpp)\n# \u521b\u5efa\u522b\u540d\u76ee\u6807\nadd_library(lib1 ALIAS my_library)\n# \u6dfb\u52a0\u53ef\u6267\u884c\u6587\u4ef6\uff0c\u5e76\u94fe\u63a5\u522b\u540d\u76ee\u6807\nadd_executable(my_app main.cpp)\ntarget_link_libraries(\n  my_app\n  PRIVATE lib1\n)\n</code></pre> <p>\u4f46\u8981\u6ce8\u610f\uff0c\u522b\u540d\u76ee\u6807\uff08\u4f8b\u5982\u4e0a\u6587\u4e2d\u7684 <code>lib1</code>\uff09\u4e0d\u5f97\u4f5c\u4e3a</p> <ul> <li><code>target_link_libraries</code></li> <li><code>target_include_directories</code></li> </ul> <p>\u7684\u76ee\u6807\u540d\uff0c\u5373\u4e0d\u5f97\u5199\u6210</p> <pre><code>target_include_directories(\n  lib1\n  PUBLIC xxx\n)\n# \u6216\u8005\ntarget_link_libraries(\n  lib1\n  PRIVATE xxx\n)\n</code></pre> <p>\u7684\u5f62\u5f0f</p>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/05-%E7%9B%AE%E6%A0%87%E6%9E%84%E5%BB%BA/#32","title":"3.2 \u8bbe\u7f6e\u76ee\u6807\u5c5e\u6027","text":"<p>\u5373\u4f7f\u7528\u547d\u4ee4 <code>set_target_properties</code></p> <p>\u4e00\u822c\u60c5\u51b5\u4e0b\uff0c\u76ee\u6807\u5c5e\u6027\u901a\u5e38\u5f88\u5c11\u76f4\u63a5\u4f7f\u7528\uff0c\u4e00\u822c\u662f\u95f4\u63a5\u4f7f\u7528\uff0c\u4f8b\u5982</p> <ul> <li>\u5728\u4f7f\u7528 <code>target_include_directories</code> \u7684\u65f6\u5019\uff0c\u4f1a\u4e3a\u76ee\u6807\u8bbe\u7f6e <code>INTERFACE_INCLUDE_DIRECTORIES</code> \u5c5e\u6027</li> <li>\u5728\u4f7f\u7528 <code>target_link_libraries</code> \u7684\u65f6\u5019\uff0c\u4f1a\u4e3a\u76ee\u6807\u8bbe\u7f6e <code>INTERFACE_LINK_LIBRARIES</code> \u5c5e\u6027</li> </ul> <p>\u5b9e\u9645\u4e0a\uff0c\u5bf9\u4e8e\u5bfc\u5165\u76ee\u6807\u3001\u63a5\u53e3\u5e93\u76ee\u6807\uff0c\u6211\u4eec\u53ef\u4ee5\u4e0d\u901a\u8fc7\u4ee5\u4e0a\u547d\u4ee4\u6765\u5b9e\u73b0\u5bf9\u5e94\u529f\u80fd\uff0c\u8b6c\u5982\u8bf4\uff0c\u4e3a\u4e86\u6307\u5b9a\u76ee\u6807\u5305\u542b\u7684\u76ee\u5f55\uff0c\u539f\u5148\u5199\u4e3a</p> <pre><code>target_include_directories(\n  my_target\n  PUBLIC include\n)\n</code></pre> <p>\u73b0\u5728\u53ef\u4ee5\u901a\u8fc7\u4f7f\u7528</p> <pre><code>set_target_properties(\n  my_target PROPERTIES\n  INTERFACE_INCLUDE_DIRECTORIES ${CMAKE_CURRENT_LIST_DIR}/include\n)\n</code></pre> <p>\u6216\u8005</p> <pre><code>set_property(\n  TARGET my_target PROPERTIES\n  INTERFACE_INCLUDE_DIRECTORIES ${CMAKE_CURRENT_LIST_DIR}/include\n)\n</code></pre> <p>\u6765\u5b9e\u73b0\u540c\u6837\u529f\u80fd\uff0c\u6b64\u64cd\u4f5c\u5728\u914d\u7f6e\u5bfc\u5165\u76ee\u6807\u7684\u65f6\u5019\u6bd4\u8f83\u5e38\u89c1\u3002\u6b64\u5916\uff0cCMake \u5b98\u7f51\u63d0\u4f9b\u4e86\u975e\u5e38\u975e\u5e38\u591a\u7684\u5c5e\u6027\uff0c\u53ef\u4ee5\u70b9\u51fb\u6b64\u5904\u67e5\u9605\u3002</p> <p>::: warning \u5728\u8bbe\u7f6e <code>INTERFACE_INCLUDE_DIRECTORIES</code> \u548c <code>INTERFACE_LINK_LIBRARIES</code> \u5c5e\u6027\u7684\u65f6\u5019\u9700\u8981\u6307\u5b9a\u7edd\u5bf9\u8def\u5f84 :::</p>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/05-%E7%9B%AE%E6%A0%87%E6%9E%84%E5%BB%BA/#33","title":"3.3 \u975e\u5fc5\u8981\u4e0d\u4f7f\u7528\u5168\u5c40\u5305\u542b\u3001\u94fe\u63a5","text":"<p>\u975e\u5fc5\u8981\u60c5\u51b5\u4e0b\u4e0d\u8981\u4f7f\u7528</p> <ul> <li><code>link_library</code></li> <li><code>include_directories</code></li> </ul> <p>\u8bed\u53e5\uff0c\u4f1a\u5f71\u54cd\u6240\u6709\u5b50\u76ee\u5f55\u7684\u6784\u5efa\uff0c\u5e26\u6765\u6c61\u67d3\u95ee\u9898\u3002\u4f46\u6709\u4e9b\u60c5\u51b5\u4e0b\u8fd9\u4e9b\u8bed\u53e5\u53ef\u4ee5\u5b9e\u73b0\u5176\u4ed6\u529f\u80fd\u3002\u4f8b\u5982 <code>target_include_directories</code> \u53ef\u4ee5\u5c06\u5185\u5bb9\u7ed1\u5b9a\u5230\u76ee\u6807\u5e76\u4e14\u5728\u5bfc\u51fa\u76ee\u6807\u540e\u4f9d\u8d56\u5173\u7cfb\u4ecd\u7136\u751f\u6548\uff0c\u800c\u4f7f\u7528 <code>include_directories</code> \u53ef\u4ee5\u907f\u514d\u5b89\u88c5\u540e\u4ecd\u7136\u5b58\u5728\u4f9d\u8d56\u5173\u7cfb\u3002\u5177\u4f53\u539f\u56e0\u548c\u5b9e\u73b0\u7ec6\u8282\u53ef\u53c2\u8003\u301010\u3011\u9879\u76ee\u7684\u5bfc\u51fa\u4e0e\u5b89\u88c5 #3.4\u3002</p>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/05-%E7%9B%AE%E6%A0%87%E6%9E%84%E5%BB%BA/#34","title":"3.4 \u8bbf\u95ee\u5e93\u7684\u65b9\u5f0f","text":"<p>\u5f53\u9700\u8981\u8bbf\u95ee\u7b2c\u4e09\u65b9\u5e93\u7684\u65f6\u5019\uff0c\u7b2c\u4e09\u65b9\u5e93\u9700\u8981\u63d0\u4f9b\u5934\u6587\u4ef6\uff08\u7c7b\u4f3c\u4e8e <code>*.h</code> \u548c <code>*.hpp</code>\uff09\u548c\u5e93\u6587\u4ef6\uff08\u5305\u62ec\u52a8\u6001\u5e93 <code>*.so</code> \u548c\u9759\u6001\u5e93 <code>*.a</code> \u4e24\u79cd\u5f62\u5f0f\uff09\u3002</p> <p>::: tip Windows \u4e0b\u7684\u5e93\u6587\u4ef6\u6709\u4e24\u79cd\u5f62\u5f0f - \u52a8\u6001\u5e93<code>*.dll</code>\u4ee5\u53ca\u5bfc\u5165\u5e93<code>*.lib</code> - \u9759\u6001\u5e93<code>*.lib</code> :::</p> <ul> <li>\u5728\u8bbf\u95ee\u672c\u9879\u76ee\u7684\u5e93<code>A</code>\u65f6\uff0c\u5982\u679c\u5df2\u7ecf\u4f7f\u7528\u4e86<code>target_include_directories</code>\u7684<code>PUBLIC</code>\u5c5e\u6027\uff0c\u5c06\u5934\u6587\u4ef6\u8def\u5f84\u7ed1\u5b9a\u5728\u4e86\u76ee\u6807<code>A</code>\u4e2d\uff0c\u90a3\u4e48\u76ee\u6807<code>B</code>\u5728\u8bbf\u95ee<code>A</code>\u7684\u65f6\u5019\uff0c\u53ea\u9700\u8981</li> </ul> <pre><code>target_link_libraries(B PUBLIC A)\n</code></pre> <p>\u5373\u53ef\u8bbf\u95ee\u5230<code>A</code>\u6240\u5305\u542b\u7684\u5934\u6587\u4ef6\u8def\u5f84\u3002</p> <ul> <li>\u5728\u8bbf\u95ee\u5176\u4ed6\u9879\u76ee\u7684\u7b2c\u4e09\u65b9\u5e93\u65f6\uff0c\u7528\u6237\u9700\u8981\u5355\u72ec\u83b7\u53d6\u5bf9\u5e94\u7684\u5e93\u6587\u4ef6\u4e0e\u5934\u6587\u4ef6\u8def\u5f84\u8fdb\u884c\u94fe\u63a5\uff0c\u4f8b\u5982 OpenCV\uff1a</li> </ul> <pre><code>add_executable(xxx main.cpp)\n\ntarget_include_directories(\n  xxx\n  PUBLIC ${OpenCV_INCLUDE_DIRS}\n)\n\ntarget_link_libraries(\n  xxx\n  PRIVATE ${OpenCV_LIBS}\n)\n</code></pre> <p>\u4f46\u5b9e\u9645\u4e0a\uff0c<code>OpenCV_LIBS</code> \u662f\u5305\u542b\u4e86\u4f17\u591a\u5bfc\u5165\u76ee\u6807\u7684\u5217\u8868\u53d8\u91cf\uff0c\u4f8b\u5982 <code>opencv_core;opencv_highgui</code>\uff0c\u5e76\u4e14\u5217\u8868\u4e2d\u7684\u6bcf\u4e2a\u53d8\u91cf\u90fd\u8bbe\u7f6e\u4e86 <code>INTERFACE_INCLUDE_DIRECTORIES</code> \u7684\u5c5e\u6027\u3002\u4e0d\u5199 <code>target_include_directories</code> \u547d\u4ee4\u4e5f\u662f\u6b63\u786e\u7684\uff1a</p> <pre><code>add_executable(xxx main.cpp)\n\ntarget_link_libraries(\n  xxx\n  PRIVATE ${OpenCV_LIBS}\n)\n</code></pre>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/06-%E5%8F%98%E9%87%8F%E5%8F%82%E4%B8%8E%20C%2B%2B%20%E7%9A%84%E7%BC%96%E8%AF%91/","title":"\u301006\u3011\u53d8\u91cf\u53c2\u4e0e C++ \u7684\u7f16\u8bd1","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/06-%E5%8F%98%E9%87%8F%E5%8F%82%E4%B8%8E%20C%2B%2B%20%E7%9A%84%E7%BC%96%E8%AF%91/#1","title":"1. \u524d\u8a00","text":"<p>\u5728\u5f00\u53d1\u4e2d\uff0c\u5f80\u5f80\u4f1a\u6709\u4ee5\u4e0b\u9700\u6c42\uff0c\u9700\u8981\u7528\u6237\u6216\u8005\u7a0b\u5e8f\u5458\u6765\u9009\u62e9\u7f16\u8bd1\u67d0\u6bb5\u4ee3\u7801\u3002\u4f8b\u5982\u5728C/C++\u8bed\u8a00\u4e2d\uff0c\u8fd9\u79cd\u901a\u5e38\u7684\u505a\u6cd5\u662f\u4f7f\u7528\u9884\u7f16\u8bd1\u547d\u4ee4<code>#define</code>\uff1a</p> <pre><code>#define HAVE_ABC\n/* code */\n#ifdef HAVE_ABC\nclass ABC\n{\n    /* code */\n};\n#endif // HAVE_ABC\n</code></pre> <p>\u8fd9\u79cd\u9700\u8981\u624b\u52a8\u4fee\u6539\u6e90\u7801\uff0c\u64cd\u4f5c\u4e0a\u4e0d\u5b89\u5168\u4e14\u6bd4\u8f83\u7e41\u7410\u3002\u5982\u679c\u80fd\u5728\u7a0b\u5e8f\u7f16\u8bd1\u671f\u95f4\u4ea7\u751f</p> <ul> <li>\u67d0\u4e9b\u9884\u7f16\u8bd1\u5b8f</li> <li>\u5305\u542b\u5b8f\u3001\u5e38\u91cf\u8868\u8fbe\u5f0f\u7b49\u5185\u5bb9\u7684\u5934\u6587\u4ef6</li> </ul> <p>\u5c06\u5728\u5b89\u5168\u6027\u3001\u64cd\u4f5c\u7684\u4fbf\u6377\u6027\u4e0a\u4f1a\u6709\u663e\u8457\u63d0\u5347\u3002\u7f16\u8bd1\u5668\u63d0\u4f9b\u4e86\u4e00\u4e9b\u6307\u4ee4\uff0c\u53ef\u4ee5\u5728\u7f16\u8bd1\u671f\u95f4\u4ea7\u751f\u9884\u7f16\u8bd1\u5b8f\uff0c\u4f8b\u5982 GCC \u7684 <code>-D</code> \u9009\u9879\uff1a</p> <pre><code>g++ -DXXX main.cpp\n</code></pre> <p>\u8fd9\u6837\u5c31\u53ef\u4ee5\u5728\u7f16\u8bd1\u671f\u95f4\u4ea7\u751f\u4e00\u4e2a\u9884\u7f16\u8bd1\u5b8f <code>XXX</code>\uff0cCMake \u5219\u63d0\u4f9b\u4e86\u4e00\u7ec4\u529f\u80fd\uff0c\u53ef\u4ee5\u5728 CMake \u914d\u7f6e\u671f\u95f4\u4ea7\u751f\u9884\u7f16\u8bd1\u5b8f\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u5728\u7f16\u8bd1\u671f\u95f4\u4ea7\u751f\u9884\u7f16\u8bd1\u5b8f</p>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/06-%E5%8F%98%E9%87%8F%E5%8F%82%E4%B8%8E%20C%2B%2B%20%E7%9A%84%E7%BC%96%E8%AF%91/#2","title":"2. \u4f7f\u7528\u6a21\u677f\u6587\u4ef6\u751f\u6210\u5934\u6587\u4ef6","text":"<p>\u4e00\u4e2a\u6700\u76f4\u63a5\u7684\u65b9\u6cd5\uff0c\u5219\u662f\u751f\u6210\u5305\u542b\u4e00\u7cfb\u5217\u5b8f\u5b9a\u4e49\u7684\u5934\u6587\u4ef6\uff0c\u518d\u8ba9\u6e90\u6587\u4ef6\u53bb\u5305\u542b\u8fd9\u4e9b\u5934\u6587\u4ef6\uff0c\u8fbe\u5230\u8ba9\u7528\u6237\u81ea\u4e3b\u914d\u7f6e\u7684\u529f\u80fd\u3002</p>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/06-%E5%8F%98%E9%87%8F%E5%8F%82%E4%B8%8E%20C%2B%2B%20%E7%9A%84%E7%BC%96%E8%AF%91/#21-in","title":"2.1 \u914d\u7f6e *.in \u6a21\u677f\u6587\u4ef6","text":"<p>\u5728\u301001\u3011\u5b89\u88c5\u4e0e\u57fa\u672c\u4ecb\u7ecd\u4e2d\u6211\u4eec\u66fe\u4ecb\u7ecd\u8fc7 <code>*.in</code> \u6587\u4ef6\u4e3a\u4e00\u4e2a\u6a21\u677f\u6587\u4ef6\uff0cCMake \u89e3\u6790\u671f\u95f4\u80fd\u591f\u5229\u7528\u8fd9\u4e00\u6a21\u677f\u6587\u4ef6\u751f\u6210\u5b9e\u9645\u7684\u6587\u4ef6\u3002\u6211\u4eec\u770b\u5230 <code>&lt;opencv-path&gt;/cmake/templates/</code> \u6587\u4ef6\u5939\u4e0b\uff0c\u5305\u542b\u4e86\u4e00\u4e2a <code>cvconfig.h.in</code> \u6587\u4ef6\uff0c\u90e8\u5206\u5185\u5bb9\u5982\u4e0b\uff1a</p> <pre><code>/* code */\n/* OpenCV compiled as static or dynamic libs */\n#cmakedefine BUILD_SHARED_LIBS\n\n/* OpenCV intrinsics optimized code */\n#cmakedefine CV_ENABLE_INTRINSICS\n\n/* OpenCV additional optimized code */\n#cmakedefine CV_DISABLE_OPTIMIZATION\n\n/* Compile for 'real' NVIDIA GPU architectures */\n#define CUDA_ARCH_BIN \"${OPENCV_CUDA_ARCH_BIN}\"\n/* code */\n</code></pre> <p>\u5982\u679c\u4ece\u6e90\u7801\u7f16\u8bd1\u8fc7 OpenCV\uff0c\u6211\u4eec\u5219\u53ef\u4ee5\u5728<code>&lt;opencv-path&gt;/build/</code>\u6587\u4ef6\u5939\u4e0b\uff0c\u627e\u5230\u4e00\u4e2a\u53eb\u505a<code>cvconfig.h</code>\u7684\u6587\u4ef6\uff0c\u90e8\u5206\u5185\u5bb9\u5982\u4e0b\uff1a</p> <pre><code>/* code */\n/* OpenCV compiled as static or dynamic libs */\n#define BUILD_SHARED_LIBS\n\n/* OpenCV intrinsics optimized code */\n#define CV_ENABLE_INTRINSICS\n\n/* OpenCV additional optimized code */\n/* #undef CV_DISABLE_OPTIMIZATION */\n\n/* Compile for 'real' NVIDIA GPU architectures */\n#define CUDA_ARCH_BIN \"\"\n/* code */\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230\u8fd9\u4e2a<code>cvconfig.h.in</code>\u6587\u4ef6\u7684\u5927\u90e8\u5206\u8bed\u6cd5\u4e0e<code>cvconfig.h</code>\u4e00\u81f4\uff0c\u4f46\u5176\u4e2d\u6d89\u53ca\u5230\u4e00\u4e9b CMake \u53d8\u91cf\u7684\u5730\u65b9\uff0c\u8fd9\u4e9b\u5185\u5bb9\u5728<code>cvconfig.h</code>\u4e2d\u53d1\u751f\u4e86\u8f6c\u5316\u3002</p> <p>\u7ecf\u8fc7\u5bfb\u627e\uff0c\u53ef\u4ee5\u770b\u5230\uff1a\u5728<code>&lt;opencv-path/cmake/</code>\u6587\u4ef6\u5939\u4e0b\u7684<code>OpenCVGenHeaders.cmake</code>\u6587\u4ef6\u7684\u7b2c\u4e00\u884c\u5305\u542b\u8fd9\u4e48\u4e24\u53e5\u5185\u5bb9\uff1a</p> <pre><code># platform-specific config file\nconfigure_file(\"${OpenCV_SOURCE_DIR}/cmake/templates/cvconfig.h.in\" \"${OPENCV_CONFIG_FILE_INCLUDE_DIR}/cvconfig.h\")\nconfigure_file(\"${OpenCV_SOURCE_DIR}/cmake/templates/cvconfig.h.in\" \"${OPENCV_CONFIG_FILE_INCLUDE_DIR}/opencv2/cvconfig.h\")\n</code></pre> <p>\u6211\u4eec\u53ef\u4ee5\u63a8\u6d4b\uff0c<code>cvconfig.h</code>\u5c31\u662f\u901a\u8fc7<code>cvconfig.h.in</code>\u6587\u4ef6\u800c\u751f\u6210\u7684\uff0c\u5176\u4e2d\u7528\u4e8e\u8f6c\u5316\u7684\u8bed\u53e5\u5c31\u662f<code>configure_file</code>\u3002</p>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/06-%E5%8F%98%E9%87%8F%E5%8F%82%E4%B8%8E%20C%2B%2B%20%E7%9A%84%E7%BC%96%E8%AF%91/#22-configure_file","title":"2.2 configure_file","text":"<p>\u57fa\u672c\u7528\u6cd5\uff1a</p> <pre><code>configure_file(aaa.h.in bbb.h) # \u4f7f\u7528 aaa.h.in \u4e3a\u6a21\u677f\u751f\u6210 bbb.h\n</code></pre> <p>\u5728\u4f7f\u7528<code>configure_file</code>\u4e4b\u524d\u9700\u8981\u521b\u5efa\u4e00\u4e2a<code>aaa.h.in</code>\u6587\u4ef6\uff0c\u7528\u4e8e\u751f\u6210<code>bbb.h</code>\uff0c\u5176\u4e2d<code>aaa.h.in</code>\u6587\u4ef6\u4e0e\u5f85\u751f\u6210\u7684<code>bbb.h</code>\u6587\u4ef6\u57fa\u672c\u4e00\u81f4\uff0c\u5373\u4e0e\u666e\u901a\u7684 C++ \u6587\u4ef6\u57fa\u672c\u4e00\u81f4\uff0c\u53ea\u662f\u5728\u9700\u8981\u66ff\u6362\u7684\u5730\u65b9\u4f7f\u7528 CMake \u7684\u76f8\u5173\u6807\u5fd7\uff0c\u4f8b\u5982\uff1a</p> <pre><code>#cmakedefine CONFIG_DIR \"@CONFIG_DIR@\"\n#define CONFIG_DIR_1 \"@CONFIG_DIR@\"\nconstexpr auto CONFIG_DIR_2 = \"@CONFIG_DIR@\";\n#cmakedefine CONFIG_DIR_3 \"@CONFIG_DIR_2@\"\n#define CONFIG_DIR_4 \"@CONFIG_DIR_3@\"\n</code></pre> <p>\u5176\u4e2d<code>#cmakedefine</code>\u5c31\u8868\u793a\u4f1a\u5728 CMake \u6267\u884c\u914d\u7f6e\u65f6\u671f\uff0c\u66ff\u6362\u4e3a\u9884\u5b9a\u4e49\u7684 CMake \u53d8\u91cf\u6216\u7528\u6237\u5b9a\u4e49\u7684\u53d8\u91cf\u3002\u6b64\u5916\uff0c\u4f7f\u7528<code>@xxx@</code>\u7684\u5185\u5bb9\u4e5f\u662f\u6a21\u677f\uff0c\u4e5f\u4f1a\u5728 CMake \u6267\u884c\u914d\u7f6e\u65f6\u671f\u8fdb\u884c\u6587\u672c\u66ff\u6362\u3002</p> <p>\u5728 <code>CMakeLists.txt</code> \u4e2d\u5199\u5165\uff1a</p> <pre><code>set(CONFIG_DIR \"aa/bb/cc\")\nconfigure_file(\n  config.h.in\n  ${CMAKE_SOURCE_DIR}/config.h\n  @ONLY # \u6b64\u9879\u53ef\u9009\uff0c@ONLY \u8868\u793a\u4ec5\u5c06 *.in \u6587\u4ef6\u4e2d\u7684 @xxx@ \u505a\u66ff\u6362\uff0c\u800c ${xxx} \u4e0d\u505a\u66ff\u6362\n)\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230 CMakeLists.txt \u53ea\u5bf9<code>CONFIG_DIR</code>\u8fdb\u884c\u4e86\u5b9a\u4e49\u3002\u800c\u7b2c 4 \u884c\u548c\u7b2c 5 \u884c\u63d0\u5230\u7684<code>CONFIG_DIR_2</code>\u548c<code>CONFIG_DIR_3</code>\u5747\u672a\u88ab\u5b9a\u4e49\u3002</p> <p>\u5728\u7ecf\u8fc7 cmake \u547d\u4ee4\u540e\uff0c\u4f1a\u5728<code>CMakeLists.txt</code>\u5f53\u524d\u8def\u5f84\u4e0b\u751f\u6210 config.h \u6587\u4ef6\uff0c\u5176\u5185\u5bb9\u5982\u4e0b\uff1a</p> <pre><code>#define CONFIG_DIR \"aa/bb/cc\"\n#define CONFIG_DIR_1 \"aa/bb/cc\"\nconstexpr auto CONFIG_DIR_2 = \"aa/bb/cc\";\n/* #undef CONFIG_DIR_3 */\n#define CONFIG_DIR_4 \"\"\n</code></pre>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/06-%E5%8F%98%E9%87%8F%E5%8F%82%E4%B8%8E%20C%2B%2B%20%E7%9A%84%E7%BC%96%E8%AF%91/#23-option","title":"2.3 \u4e0e option \u914d\u5408","text":"<p>\u9664\u6b64\u4e4b\u5916\uff0c\u8fd8\u53ef\u4ee5\u901a\u8fc7<code>option()</code>\u9009\u9879\u6765\u5236\u4f5c\u6761\u4ef6\u7f16\u8bd1\u7684\u5b8f\uff0c\u4f8b\u5982\uff1a\u5728 config.h.in \u4e2d\u5199\u5165\uff1a</p> <pre><code>#cmakedefine A\n#cmakedefine B\n</code></pre> <p>\u5728 <code>CMakeLists.txt</code> \u4e2d\u5199\u5165\uff1a</p> <pre><code>option(A \"a\" ON)\noption(B \"b\" OFF)\nconfigure_file(config.h.in ${CMAKE_SOURCE_DIR}/config.h)\n</code></pre> <p>\u751f\u6210\u7684 <code>config.h</code> \u6587\u4ef6\u5185\u5bb9\u5982\u4e0b\uff1a</p> <pre><code>#define A\n/* #undef B */\n</code></pre> <p>\u4f8b\u5982\uff0c\u5728<code>&lt;opencv-path&gt;/CMakeLists.txt</code>\u6587\u4ef6\u4e0b\uff0c\u6709\uff1a</p> <pre><code>OCV_OPTION(OPENCV_ENABLE_NONFREE \"Enable non-free algorithms\" OFF)\n</code></pre> <p>\u5728<code>&lt;opencv-path&gt;/cmake/templates/</code>\u6587\u4ef6\u5939\u4e2d\u7684<code>opencv_modules.hpp.in</code>\u6709\uff1a</p> <pre><code>#cmakedefine OPENCV_ENABLE_NONFREE\n</code></pre> <p></p> <p>\u5982\u679c\u6211\u4eec\u901a\u8fc7<code>cmake-gui</code>\u5c06<code>OPENCV_ENABLE_NONFREE</code>\u4fee\u6539\u4e3a<code>ON</code>\uff0c\u90a3\u4e48\u53ef\u4ee5\u786e\u5b9a\uff0c\u4f1a\u751f\u6210\uff1a</p> <pre><code>#define OPENCV_ENABLE_NONFREE\n</code></pre>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/06-%E5%8F%98%E9%87%8F%E5%8F%82%E4%B8%8E%20C%2B%2B%20%E7%9A%84%E7%BC%96%E8%AF%91/#24","title":"2.4 \u4f7f\u7528\u573a\u666f","text":"<p>\u5728\u6279\u91cf\u751f\u6210\u4e00\u7cfb\u5217\u5b8f\u5b9a\u4e49\u53d8\u91cf\uff0c\u6216\u8005\u751f\u6210\u4e0e\u8def\u5f84\u6709\u5173\u7684\u53d8\u91cf\u7684\u65f6\u5019\uff0c\u4f7f\u7528 <code>configure_file</code> \u662f\u5f88\u65b9\u4fbf\u7684\uff0c\u4f46\u5982\u679c\u53ea\u6709\u4e00\u4e2a\u6216\u51e0\u4e2a\u7684\u5b8f\u5b9a\u4e49\u53d8\u91cf\uff0c\u90a3\u4e48\u4f7f\u7528 <code>configure_file</code> \u6765\u7ef4\u62a4\u4e00\u4e2a <code>*.in</code> \u6587\u4ef6\u5c06\u663e\u5f97\u5341\u5206\u5197\u6742\u3002</p>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/06-%E5%8F%98%E9%87%8F%E5%8F%82%E4%B8%8E%20C%2B%2B%20%E7%9A%84%E7%BC%96%E8%AF%91/#3-cmake","title":"3. CMake \u6dfb\u52a0\u9884\u5b9a\u4e49\u53d8\u91cf","text":"<p>\u6b63\u5982\u4e0a\u8ff0\u4f7f\u7528\u573a\u666f\u6240\u8bf4\uff0c\u5355\u4e2a\u6216\u5c11\u91cf\u7684\u5b8f\u5b9a\u4e49\uff0c\u4f7f\u7528 <code>configure_file</code> \u5e76\u4e0d\u65b9\u4fbf\uff0c\u4e0b\u9762\u63d0\u4f9b\u51e0\u4e2a\u89e3\u51b3\u6b64\u95ee\u9898\u7684\u65b9\u6cd5\u3002</p>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/06-%E5%8F%98%E9%87%8F%E5%8F%82%E4%B8%8E%20C%2B%2B%20%E7%9A%84%E7%BC%96%E8%AF%91/#31-add_definitions","title":"3.1 add_definitions","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/06-%E5%8F%98%E9%87%8F%E5%8F%82%E4%B8%8E%20C%2B%2B%20%E7%9A%84%E7%BC%96%E8%AF%91/#311","title":"3.1.1 \u7528\u6cd5","text":"<pre><code>add_definitions(-DXXX)\n</code></pre> <p>\u5728<code>main.cpp</code>\u4e2d\u5199\u5165</p> <pre><code>#include &lt;iostream&gt;\nusing namespace std;\n#ifdef XXX\n    inline void foo() { cout &lt;&lt; \"this is XXX\" &lt;&lt;endl; }\n#endif // XXX\n#ifdef YYY\n    inline void foo() { cout &lt;&lt; \"this is YYY\" &lt;&lt;endl; }\n#endif // YYY\nint main(int argc, char *argv[])\n{\n    foo();\n    return 0;\n}\n</code></pre> <p>\u7f16\u8bd1\u540e\uff0c\u8fd0\u884c\u7ed3\u679c\u5982\u4e0b</p> <pre><code>this is XXX\n</code></pre> <p>\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c<code>add_definitions</code> \u751f\u6548\u7684\u6587\u4ef6\u4e3a\u5f53\u524d <code>CMakeLists.txt</code> \u6587\u4ef6\u4ee5\u53ca\u5b50\u76ee\u5f55\u7684 <code>CMakeLists.txt</code> \u6587\u4ef6\uff0c\u53ef\u7c7b\u6bd4\u53d8\u91cf\u7684\u4f5c\u7528\u57df\u3002\u5e76\u4e14\uff0c\u5bf9\u4e8e\u5176\u4e2d\u4e00\u4e2a <code>CMakeLists.txt</code> \u6587\u4ef6\uff0c\u5373\u4f7f\u5199\u6210</p> <pre><code>add_executable(demo main.cpp)\nadd_definitions(-DXXX)\n</code></pre> <p>\u5373\uff0c\u5728\u521b\u5efa\u53ef\u6267\u884c\u7a0b\u5e8f\u8fd9\u4e2a\u4e8c\u8fdb\u5236\u76ee\u6807\u4e4b\u540e\u518d\u4e66\u5199 <code>add_definitions</code> \uff0c\u8be5\u9884\u7f16\u8bd1\u5b8f\u5b9a\u4e49\u4ecd\u7136\u80fd\u591f\u751f\u6548\uff0c\u56e0\u4e3a\u8be5\u547d\u4ee4\u4f5c\u7528\u57df\u751f\u6210\u9636\u6bb5\uff0c\u53ef\u53c2\u8003\u301009\u3011\u751f\u6210\u5668\u8868\u8fbe\u5f0f\u3002\u6211\u4eec\u6682\u65f6\u53ef\u4ee5\u8fd9\u6837\u7406\u89e3</p> <ul> <li>\u8fd9\u4e00\u64cd\u4f5c\u7b49\u540c\u4e8e\u4f7f\u7528 <code>g++ main.cpp -DXXX</code> \u7684\u547d\u4ee4\u884c\u8fdb\u884c\u7f16\u8bd1</li> <li>\u53ea\u8981\u6784\u5efa\u51fa\u7684\u76ee\u6807\uff08\u4e0a\u9762\u7684\u4f8b\u5b50\u662f <code>demo</code>\uff09\u6240\u5728\u7684\u4f5c\u7528\u57df\u4e2d\u5177\u6709\u9884\u7f16\u8bd1\u5b8f\u5b9a\u4e49 <code>XXX</code>\uff0c\u90a3\u4e48\u8be5\u5b8f\u5b9a\u4e49\u90fd\u80fd\u751f\u6548\uff08\u5373\u5168\u5c40\u751f\u6548\uff09\u3002</li> </ul>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/06-%E5%8F%98%E9%87%8F%E5%8F%82%E4%B8%8E%20C%2B%2B%20%E7%9A%84%E7%BC%96%E8%AF%91/#312-option","title":"3.1.2 \u4e0e option \u914d\u5408","text":"<p>\u5b9e\u9645\u4e0a\uff0c\u5bf9\u4e8e\u5168\u5c40\u751f\u6548\u7684 <code>add_definitions</code> \u6211\u4eec\u66f4\u591a\u7684\u662f\u5c06\u5176\u4e0e <code>option</code> \u547d\u4ee4\u7ed3\u5408\u8d77\u6765\u4f7f\u7528\uff0c\u53c2\u8003\u4e0b\u9762\u7684\u4ee3\u7801\uff1a</p> <pre><code># \u5b9a\u4e49\u4e8e &lt;opencv-path&gt;/CMakeLists.txt \u4e2d\u7684\u5185\u5bb9\nOCV_OPTION(ENABLE_IMPL_COLLECTION \"xxx\" OFF )\n# code\nif(ENABLE_IMPL_COLLECTION)\n  add_definitions(-DCV_COLLECT_IMPL_DATA)\nendif()\n</code></pre> <p>\u6211\u4eec\u53ea\u9700\u5728\u7ec8\u7aef\u4e2d\u8f93\u5165\u4ee5\u4e0b\u5185\u5bb9\uff0c\u5373\u53ef\u5b9e\u73b0\u8be5\u7f16\u8bd1\u9009\u9879\u7684\u5f00\u542f\uff0c\u5e76\u6dfb\u52a0\u5bf9\u5e94\u7684\u5b8f</p> <pre><code>cmake -D ENABLE_IMPL_COLLECTION=ON ..\n</code></pre>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/06-%E5%8F%98%E9%87%8F%E5%8F%82%E4%B8%8E%20C%2B%2B%20%E7%9A%84%E7%BC%96%E8%AF%91/#313","title":"3.1.3 \u6ce8\u610f\u4e8b\u9879","text":"<p>\u7531\u4e8e\u4e0a\u6587\u4e2d\u63d0\u5230 <code>add_definitions</code> \u7684\u751f\u6548\u673a\u5236\u4e0e CMake \u4e2d\u53d8\u91cf\u7684\u4f5c\u7528\u57df\u57fa\u672c\u4e00\u81f4\uff0c\u56e0\u6b64\u5728\u4e00\u4e2a <code>CMakeLists.txt</code> \u4e2d\u5982\u679c\u521b\u5efa\u591a\u4e2a\u76ee\u6807\uff0c\u90a3\u4e48\u8fd9\u4e9b\u76ee\u6807\u5747\u80fd\u4eab\u6709\u8fd9\u4e2a\u4f5c\u7528\u57df\u4e0b\u7684 <code>add_definitions</code> \u6240\u5e26\u6765\u7684\u6548\u679c\u4f7f\u7528 <code>add_definitions</code> \u6784\u5efa\u7684\u76ee\u6807\u3002\u5177\u4f53\u7684\u8bf4\uff0c\u5c31\u662f\u5728</p> <ul> <li> <p>\u5f53\u524d\u7684 <code>CMakeLists.txt</code> \u6587\u4ef6</p> </li> <li> <p>\u5b50\u76ee\u5f55\uff08\u4f7f\u7528 <code>add_subdirectory</code> \u6240\u6dfb\u52a0\u7684\u6a21\u5757\uff09\u7684 <code>CMakeLists.txt</code> \u6587\u4ef6\u4e2d</p> </li> </ul> <p>\u751f\u6548\uff0c\u4f8b\u5982\u4ee5\u4e0b\u7684\u5e03\u5c40\u3002</p> <pre><code>project: CMakeLists\n    \u2502\n    \u2514\u2500\u2500 A: CMakeLists\n         \u2502\n         \u251c\u2500\u2500 B: CMakeLists\n         \u2502    \u2502\n         \u2502\u00a0\u00a0  \u2514\u2500\u2500 D: CMakeLists\n         \u2502\n         \u2514\u2500\u2500 C: CMakeLists\n</code></pre> <p>\u4f8b\u5982\uff0c\u5728<code>A</code>\u76ee\u5f55\u4e2d\u4f7f\u7528<code>add_definitions</code>\u5b9a\u4e49\u7684\u5185\u5bb9\uff0c\u5728<code>A</code>\u3001<code>B</code>\u3001<code>C</code>\u3001<code>D</code>\u76ee\u5f55\u4e2d\u5747\u751f\u6548\uff0c\u800c<code>B</code>\u4f7f\u7528<code>add_definitions</code>\u5b9a\u4e49\u7684\u5185\u5bb9\u4ec5\u5728<code>B</code>\u3001<code>D</code>\u76ee\u5f55\u4e2d\u751f\u6548</p>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/06-%E5%8F%98%E9%87%8F%E5%8F%82%E4%B8%8E%20C%2B%2B%20%E7%9A%84%E7%BC%96%E8%AF%91/#32-target_compile_definitions","title":"3.2 target_compile_definitions","text":"<p>\u5728 \u301005\u3011\u76ee\u6807\u6784\u5efa - \u666e\u901a\u5e93\u76ee\u6807\u6784\u5efa\u4e2d\u63d0\u5230\u4e86 <code>target_compile_definitions</code> \u547d\u4ee4\uff0c\u8fd9\u4e5f\u662f\u76ee\u6807\u5c5e\u6027\u5f53\u4e2d \u201c\u4f7f\u7528\u8981\u6c42\u201d \u7684\u4e00\u90e8\u5206\u3002\u5728\u6dfb\u52a0\u9884\u5b9a\u4e49\u5b8f\u7684\u529f\u80fd\u4e0a\uff0c\u76f8\u6bd4\u4e8e <code>add_definitions</code>\uff0c<code>target_compile_definitions</code> \u5219\u66f4\u5177\u6709\u9488\u5bf9\u6027\uff0c\u5b83\u80fd\u660e\u786e\u7684\u6307\u5b9a\u662f\u54ea\u4e2a\u76ee\u6807\u5728\u6784\u5efa\u7684\u65f6\u5019\u5f15\u5165\u9884\u7f16\u8bd1\u5b8f\u3002\u4e0b\u9762\u9996\u5148\u7ed9\u51fa OpenCV \u4e2d\u7684\u4f8b\u5b50</p> <pre><code># \u5b9a\u4e49\u4e8e &lt;opencv-path&gt;/cmake/OpenCVModule.cmake \u4e2d _ocv_create_module \u5b8f\u4e2d\ntarget_compile_definitions(${the_module} PRIVATE CVAPI_EXPORTS)\n</code></pre> <p>\u5728 <code>&lt;opencv-path&gt;/modules/core/src</code> \u6587\u4ef6\u5939\u4e0b\u7684 <code>system.cpp</code> \u8fd9\u4e00\u6e90\u6587\u4ef6\uff0c\u6709\u5f15\u7528\u5230 <code>CVAPI_EXPORTS</code> \u7684\u5730\u65b9\uff1a</p> <pre><code>#if defined CVAPI_EXPORTS &amp;&amp; defined _WIN32 &amp;&amp; !defined WINCE\n// ...\n#endif\n</code></pre> <p>\u5b83\u4e3a\u6307\u5b9a\u7684\u6a21\u5757\u6dfb\u52a0\u9884\u7f16\u8bd1\u5b8f\uff0c\u4f7f\u5f97\u8be5\u5b8f\u4e0d\u4f1a\u88ab\u66b4\u9732\u7ed9\u975e\u6307\u5b9a\u7684\u76ee\u6807\uff0c\u56e0\u6b64\u4f1a\u5f88\u5b89\u5168\u3002\u5e76\u4e14\uff0c\u4e00\u822c\u8bbe\u7f6e\u4e3a <code>PRIVATE</code> \u7684\u9884\u7f16\u8bd1\u5b8f\u4e0d\u80fd\u88ab\u5176\u4f59\u5305\u542b\u8be5\u76ee\u6807\u7684\u5176\u4ed6\u76ee\u6807\u6240\u5171\u4eab\uff0c\u8fd9\u4e0e CMake \u76ee\u6807\u6784\u5efa\u65f6\u63a5\u89e6\u5230\u7684 <code>target_include_directories</code> \u4ee5\u53ca <code>target_link_libraries</code> \u7684\u7528\u6cd5\u7c7b\u4f3c\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u4ee5\u4e0b\u4ee3\u7801</p> <pre><code>target_compile_definitions(\n  my_lib\n  PUBLIC xxx\n)\n</code></pre> <p>\u53ef\u4ee5\u5b9e\u73b0\u5176\u4ed6\u76ee\u6807\u5728\u94fe\u63a5 <code>my_lib</code> \u8fd9\u4e2a\u76ee\u6807\u7684\u65f6\u5019\u540c\u6837\u4eab\u6709 <code>xxx</code> \u8fd9\u4e2a\u9884\u7f16\u8bd1\u5b8f\u5b9a\u4e49\u3002</p>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/07-%E5%AE%8F%E4%B8%8E%E5%87%BD%E6%95%B0/","title":"\u301007\u3011\u5b8f\u4e0e\u51fd\u6570","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/07-%E5%AE%8F%E4%B8%8E%E5%87%BD%E6%95%B0/#1","title":"1. \u524d\u8a00","text":"<p>\u6211\u4eec\u5047\u8bbe\u6709\u4ee5\u4e0b\u6587\u4ef6\u67b6\u6784\uff1a</p> <pre><code>.\n\u251c\u2500\u2500 core1\n\u2502   \u251c\u2500\u2500 CMakeLists.txt\n\u2502   \u251c\u2500\u2500 include\n\u2502   \u2502   \u2514\u2500\u2500 core1.hpp\n\u2502   \u2514\u2500\u2500 src\n\u2502       \u251c\u2500\u2500 core1.cpp\n\u2502       \u251c\u2500\u2500 core_cal.cpp\n\u2502       \u2514\u2500\u2500 util.cpp\n\u2514\u2500\u2500 core2\n    \u251c\u2500\u2500 CMakeLists.txt\n    \u251c\u2500\u2500 include\n    \u2502   \u2514\u2500\u2500 core2.hpp\n    \u2514\u2500\u2500 src\n        \u251c\u2500\u2500 core2.cpp\n        \u251c\u2500\u2500 core_cal.cpp\n        \u2514\u2500\u2500 util.cpp\n</code></pre> <p>\u4e24\u4e2a\u6a21\u5757\uff0c\u540c\u6837\u7684\u67b6\u6784\uff0c\u56e0\u6b64\u9700\u8981\u540c\u6837\u7684\u6784\u5efa\u65b9\u5f0f\uff0c\u5047\u8bbe<code>core1</code>\u4f9d\u8d56 OpenCV\uff0c\u5047\u8bbe<code>core2</code>\u4f9d\u8d56 <code>core1</code>\uff1a</p> <pre><code># core1/CMakeLists.txt \u90e8\u5206\u5185\u5bb9\nfind_package(OpenCV REQUIRED)\n\naux_source_directory(src core1_dir)\nadd_library(\n  core1\n  SHARED ${core1_dir}\n)\ntarget_include_directories(\n  core1\n  PUBLIC include\n)\ntarget_link_libraries(\n  core1\n  PUBLIC ${OpenCV_LIBS}\n)\n\n# core2/CMakeLists.txt \u90e8\u5206\u5185\u5bb9\naux_source_directory(src core2_dir)\nadd_library(\n  core2\n  SHARED ${core2_dir}\n)\ntarget_include_directories(\n  core2\n  PUBLIC include\n)\ntarget_link_libraries(\n  core2\n  PUBLIC core1\n)\n</code></pre> <p>\u53ef\u4ee5\u770b\u51fa\uff0c\u4e0a\u9762\u4e00\u6bb5<code>CMakeLists.txt</code>\u7684\u4ee3\u7801\u91cd\u590d\u7387\u6bd4\u8f83\u9ad8\uff0c\u6bcf\u6b21\u521b\u5efa\u5e93\u76ee\u6807\u90fd\u662f\u51e0\u4e4e\u4e00\u6837\u7684\u64cd\u4f5c\uff0c\u4e3a\u6b64\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u5b8f\u3001\u51fd\u6570\u64cd\u4f5c\u3002\u8fd9\u6837\u53ef\u4ee5\u4f7f\u5f97\u6784\u5efa\u64cd\u4f5c\u7f29\u77ed\u81f3\u51e0\u884c\uff0c\u4f8b\u5982 OpenCV \u7684 core \u6a21\u5757\uff1a</p> <pre><code>ocv_add_module(core\n               OPTIONAL opencv_cudev\n               WRAP java objc python js)\n</code></pre> <p>\u5176\u4e2d\uff0c<code>ocv_add_module</code>\u5c31\u662f OpenCV \u5b9a\u4e49\u4e8e<code>OpenCVModule.cmake</code>\u6587\u4ef6\u4e2d\u7684\u5b8f\u3002</p> <p>\u5bf9\u4e8e\u4e0a\u8ff0\u4f8b\u5b50\u6211\u4eec\u5148\u7ed9\u51fa\u7ed3\u679c\uff0c\u5982\u679c\u6211\u4eec\u521b\u5efa\u4e86\u8fd9\u6837\u4e00\u4e2a\u5b8f</p> <pre><code>macro(add_module name)\n  # \u53c2\u6570\u89e3\u6790\n  set(multy_args DEP_LIBS)\n  cmake_parse_arguments(MOD \"\" \"\" \"${multy_args}\" ${ARGN})\n  # \u521b\u5efa target\n  aux_source_directory(src _src_dir)\n  add_library(${name} SHARED ${_src_dir})\n  # \u8bbe\u7f6e target \u5c5e\u6027\n  target_include_directories(${name} PUBLIC include)\n  target_link_libraries(${name} PUBLIC ${MOD_DEP_LIBS})\n  unset(_src_dir)\nendmacro()\n</code></pre> <p>\u6211\u4eec\u5c31\u53ef\u4ee5\u6539\u5199\u6210\u4ee5\u4e0b\u5f62\u5f0f</p> <pre><code># core1/CMakeLists.txt \u90e8\u5206\u5185\u5bb9\nfind_package(OpenCV REQUIRED)\n\nadd_module(\n  core1\n  DEP_LIBS ${OpenCV_LIBS}\n)\n# core2/CMakeLists.txt \u90e8\u5206\u5185\u5bb9\nadd_module(\n  core2\n  DEP_LIBS core1\n)\n</code></pre> <p>\u8fd9\u79cd\u60c5\u51b5\u4e0d\u4ec5\u51cf\u5c11\u4e86\u4e66\u5199\u96be\u5ea6\uff0c\u8fd8\u63d0\u9ad8\u4e86\u53ef\u8bfb\u6027\u3002</p>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/07-%E5%AE%8F%E4%B8%8E%E5%87%BD%E6%95%B0/#2","title":"2. \u5b8f\u3001\u51fd\u6570","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/07-%E5%AE%8F%E4%B8%8E%E5%87%BD%E6%95%B0/#21","title":"2.1 \u51fd\u6570\u57fa\u672c\u7528\u6cd5","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/07-%E5%AE%8F%E4%B8%8E%E5%87%BD%E6%95%B0/#211","title":"2.1.1 \u5b9a\u4e49","text":"<pre><code>function(my_func)\n  # function\nendfunction()\n</code></pre>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/07-%E5%AE%8F%E4%B8%8E%E5%87%BD%E6%95%B0/#212","title":"2.1.2 \u8c03\u7528","text":"<p>\u51fd\u6570\u8c03\u7528\u7684\u51fd\u6570\u540d\u4e0d\u533a\u5206\u5927\u5c0f\u5199\uff0c\u4e0d\u8fc7\u901a\u5e38\u5728 CMake \u4e2d\u51fd\u6570\u540d\u5efa\u8bae\u5199\u5c0f\u5199\u3002</p> <pre><code>my_func() # \u53ef\u4ee5\nMY_FUNC() # \u53ef\u4ee5\nmY_fUnC() # \u6709\u4e9b\u9006\u5929\uff0c\u4f46\u4e5f\u53ef\u4ee5\n</code></pre> <p>\u9664\u6b64\u4e4b\u5916\uff0c\u4e00\u4e2a\u51fd\u6570\u8fd8\u6253\u5f00\u4e00\u4e2a\u65b0\u7684\u4f5c\u7528\u57df\uff0c\u8fd9\u70b9\u4e0eC/C++\u4e00\u81f4\u3002\u540c\u6837\uff0c\u4f7f\u7528<code>set(xxx PARENT_SCOPE)</code>\u53ef\u4ee5\u63d0\u5347\u53d8\u91cf\u4f5c\u7528\u57df\u3002</p> <p>CMake 3.18 \u8d77\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528<code>cmake_language(CALL ...)</code>\u5b50\u547d\u4ee4\u6765\u8c03\u7528\u51fd\u6570\uff0c\u53ef\u4ee5\u53c2\u8003\u5b98\u65b9\u624b\u518c\uff1a</p> <pre><code>function(my_foo x1 x2)\n  message(STATUS \"x1 = ${x1}, x2 = ${x2}\")\nendfunction()\ncmake_language(CALL my_foo 2 7)\n</code></pre>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/07-%E5%AE%8F%E4%B8%8E%E5%87%BD%E6%95%B0/#213","title":"2.1.3 \u53c2\u6570","text":"<p>\u4f7f\u7528\u5f62\u53c2</p> <p>\u5f53\u51fd\u6570\u88ab\u8c03\u7528\u65f6\uff0c\u9996\u5148\u901a\u8fc7\u5b9e\u53c2\u66ff\u6362\u5f62\u53c2 \uff0c\u7136\u540e\u4f5c\u4e3a\u666e\u901a\u547d\u4ee4\u8c03\u7528\u3002</p> <pre><code>function(my_foo x1 x2 x3)\n  message(STATUS \"x1 = ${x1}, x2 = ${x2}, x3 = ${x3}\")\nendfunction()\nmy_foo(2 7 4)\n# \u663e\u793a\u7ed3\u679c\n# -- x1 = 2, x2 = 7, x3 = 4\n</code></pre> <p>\u4f7f\u7528 ARGC\u3001ARGVn</p> <p>\u9664\u4e86\u5f15\u7528\u5f62\u53c2\u4e4b\u5916\uff0c\u8fd8\u53ef\u4ee5\u5f15\u7528<code>ARGC</code>\u53d8\u91cf \u548c<code>ARGVn</code>\u53d8\u91cf\u6765\u5f15\u7528\u53c2\u6570\uff0c<code>ARGC</code>\u8868\u793a\u53c2\u6570\u6570\u91cf\uff0c\u4ee5\u53ca<code>ARGV0, ARGV1, ARGV2, ...</code>\u5c06\u5177\u6709\u4f20\u5165\u53c2\u6570\u7684\u503c\uff0c\u6709\u52a9\u4e8e\u521b\u5efa\u5e26\u6709\u53ef\u9009\u53c2\u6570\u7684\u51fd\u6570\u3002\u540c\u65f6<code>ARGV</code>\u4fdd\u5b58\u4e86\u6240\u6709\u7684\u53c2\u6570\u5217\u8868</p> <pre><code>function(my_foo)\n  message(STATUS \"ARGC = ${ARGC}\")\n  message(STATUS \"x1 = ${ARGV0}, x2 = ${ARGV1}, x3 = ${ARGV2}\")\nendfunction()\nmy_foo(2 7 4)\n# \u663e\u793a\u7ed3\u679c\n# -- ARGC = 3\n# -- x1 = 2, x2 = 7, x3 = 4\n</code></pre> <p>\u4f7f\u7528 ARGN</p> <p>\u6b64\u5916\uff0c<code>ARGN</code>\u53d8\u91cf\u4fdd\u5b58\u8d85\u8fc7\u5f62\u53c2\u5217\u8868\u4e4b\u540e\u7684\u53c2\u6570\u3002\u5982\u679c\u5b9e\u53c2\u6570\u91cf\u5927\u4e8e\u5f62\u53c2\u6570\u91cf\uff0c\u7528<code>ARGN</code>\u53d8\u91cf\u5f15\u7528\u9884\u671f\u4e4b\u5916\u7684\u53c2\u6570\u3002</p> <pre><code>function(my_foo x1)\n  message(STATUS \"x1 = ${x1}\")\n  message(STATUS \"ARGN = ${ARGN}\")\nendfunction()\n# \u8c03\u7528\uff0c\u6267\u884c\u4e86 set(x1 2)... \u7684\u64cd\u4f5c\nmy_foo(2 7 4)\n# \u663e\u793a\u7ed3\u679c\n# -- x1 = 2\n# -- ARGN = 7;4\n</code></pre> <p>\u5f62\u53c2\u4e3a\u53d8\u91cf</p> <p>\u4ee5\u4e0a\u7684\u4f8b\u5b50\u4e2d\uff0c\u53c2\u6570\u90fd\u4e3a\u5177\u4f53\u7684\u503c\uff0c\u4f8b\u5982<code>2, 7, 4</code>\uff0c\u90a3\u4e48\u53d8\u91cf\u53d6\u503c\u7684\u8bed\u6cd5<code>${}</code>\u4f5c\u7528\u4e8e\u53c2\u6570\uff0c\u83b7\u53d6\u5230\u7684\u5c31\u662f\u5177\u4f53\u7684\u503c\u3002\u5982\u679c\u53c2\u6570\u4e3a\u53d8\u91cf\u7684\u8bdd\uff0c\u90a3\u4e48<code>${}</code>\u83b7\u53d6\u5230\u7684\u53c2\u6570\u5185\u5bb9\u5c31\u662f\u53d8\u91cf\u8fd9\u4e2a\u5b57\u7b26\u4e32\uff0c\u8981\u60f3\u83b7\u53d6\u503c\u7684\u8bdd\u5c31\u8981\u4f7f\u7528 <code>${${}}</code>\u3002</p> <pre><code>set(a1 10)\nfunction(foo val)\n  message(STATUS \"val, ${val}, ${${val}}\")\nendfunction()\nfoo(a1)\n# \u663e\u793a\u7ed3\u679c\n# -- val, a1, 10\n</code></pre>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/07-%E5%AE%8F%E4%B8%8E%E5%87%BD%E6%95%B0/#22","title":"2.2 \u5b8f\u7684\u57fa\u672c\u7528\u6cd5","text":"<p>\u5b8f\u4e0e\u51fd\u6570\u6700\u5927\u7684\u533a\u522b\u5c31\u662f\uff0c\u5b8f\u4e0d\u4f1a\u521b\u5efa\u65b0\u7684\u4f5c\u7528\u57df\uff0c\u800c\u662f\u5355\u7eaf\u7684\u53d1\u751f\u4e86\u6587\u672c\u66ff\u6362\uff0c\u8fd9\u4e0eC/C++\u5b8c\u5168\u4e00\u81f4</p>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/07-%E5%AE%8F%E4%B8%8E%E5%87%BD%E6%95%B0/#221","title":"2.2.1 \u5b9a\u4e49","text":"<pre><code>macro(myFun)\n  # macro\nendmacro()\n</code></pre>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/07-%E5%AE%8F%E4%B8%8E%E5%87%BD%E6%95%B0/#222","title":"2.2.2 \u8c03\u7528","text":"<ul> <li>\u4e0e\u51fd\u6570\u4e00\u6837\uff0c\u5b8f\u5728\u8c03\u7528\u65f6\u4e5f\u53ef\u4ee5\u4e0d\u533a\u5206\u5927\u5c0f\u5199\uff0c\u4f46\u540c\u6837\u5efa\u8bae\u4f7f\u7528\u5c0f\u5199\u3002</li> <li>CMake 3.18 \u8d77\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528<code>cmake_language(CALL ...)</code>\u5b50\u547d\u4ee4\u6765\u8c03\u7528\u5b8f\uff1a</li> </ul> <pre><code>macro(my_foo x1 x2)\n  message(STATUS \"x1 = ${x1}, x2 = ${x2}\")\nendmacro()\ncmake_language(CALL my_foo 2 7)\n</code></pre>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/07-%E5%AE%8F%E4%B8%8E%E5%87%BD%E6%95%B0/#223","title":"2.2.3 \u53c2\u6570","text":"<p>\u4e0e\u51fd\u6570\u4e00\u6837\uff0c\u540c\u6837\u53ef\u4ee5\u8bbe\u7f6e\u53c2\u6570\uff0c\u4e5f\u540c\u65f6\u5177\u5907<code>ARGC</code>\u3001<code>ARGV</code>\u3001<code>ARGVx</code>\u3001<code>ARGN</code>\u7684\u53c2\u6570\uff0c\u5982\u679c\u8fd9\u4e9b\u53c2\u6570\u5728\u5b8f\u5185\u90e8\u8fdb\u884c\u5f15\u7528\uff0c\u8c03\u7528\u8be5\u5b8f\u7684\u65f6\u5019\uff0c\u8fd9\u4e9b\u5185\u5bb9\u4f1a\u53d1\u751f\u66ff\u6362\uff0c\u4f8b\u5982</p> <pre><code>macro(my_macro xx)\n  message(STATUS \"xx   = ${xx}\")   # \u8fd9\u91cc\u7684 ${xx} \u4f1a\u88ab\u76f4\u63a5\u66ff\u6362\u4e3a aa\n  message(STATUS \"ARGC = ${ARGC}\") # \u8fd9\u91cc\u7684 ${ARGC} \u4f1a\u88ab\u76f4\u63a5\u66ff\u6362\u4e3a 3\n  message(STATUS \"ARGV = ${ARGV}\") # \u8fd9\u91cc\u7684 ${ARGV} \u4f1a\u88ab\u76f4\u63a5\u66ff\u6362\u4e3a aa;bb;cc\nendmacro()\n\nmy_macro(aa bb cc)\n\n# \u6253\u5370\u7ed3\u679c\n# -- xx   = aa\n# -- ARGC = 3\n# -- ARGV = aa;bb;cc\n</code></pre>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/07-%E5%AE%8F%E4%B8%8E%E5%87%BD%E6%95%B0/#23","title":"2.3 \u51fd\u6570\u4e0e\u5b8f\u7684\u533a\u522b","text":"<ol> <li>\u5b8f\u4e0d\u4f1a\u5f00\u8f9f\u65b0\u7684\u4f5c\u7528\u57df\uff0c\u56e0\u6b64\u5728\u5b8f\u5185\u90e8\u5b9a\u4e49\u7684\u53d8\u91cf\uff0c\u5c06\u5728\u5916\u90e8\u7ee7\u7eed\u751f\u6548</li> </ol> <pre><code>macro(test)\n  set(val \"666\")\nendmacro()\n\nset(val \"123\")\nmessage(\"val = ${val}\")\ntest()\nmessage(\"val = ${val}\")\n\n# \u6253\u5370\u7ed3\u679c\n# -- val = 123\n# -- val = 666\n</code></pre> <p>\u8fd9\u4e00\u70b9\u5728\u51fd\u6570\u5c31\u4e0d\u4f1a\u51fa\u73b0\uff0c\u5185\u90e8\u8bbe\u7f6e\u7684\u53d8\u91cf\u4e00\u822c\u65e0\u6cd5\u8986\u76d6\u5916\u90e8\u7684\u53d8\u91cf\uff0c\u4f46\u5982\u679c\u9700\u8981\u8986\u76d6\uff0c\u53ef\u4ee5\u4f7f\u7528 <code>PARENT_SCOPE</code> \u63d0\u5347\u4f5c\u7528\u57df\u3002</p> <ol> <li>\u5b8f\u5728\u88ab\u8c03\u7528\u7684\u8303\u56f4\u5185\u6709\u4e00\u4e2a\u540c\u540d\u7684\u53d8\u91cf\uff0c\u5c06\u4f7f\u7528\u73b0\u6709\u53d8\u91cf\u800c\u4e0d\u662f\u53c2\u6570\u3002</li> </ol> <pre><code>macro(aaa)\n  # \u8fd9\u91cc\u7684 ${ARGN} \u5728\u8c03\u7528\u65f6\u4f1a\u53d1\u751f\u66ff\u6362\uff0c\u66ff\u6362\u4e3a x;y;z\n  foreach(m ${ARGN})\n    message(STATUS \"m = ${m}\")\n  endforeach() \n  message(STATUS \"================\")\n  # \u8fd9\u91cc\u7684 ARGN \u6ca1\u6709\u5f15\u7528\uff0c\u5728\u8c03\u7528\u65f6\u4e0d\u4f1a\u53d1\u751f\u66ff\u6362\n  foreach(m IN LISTS ARGN)\n    message(STATUS \"m = ${m}\")\n  endforeach()  \nendmacro()\n\nfunction(bbb)\n  aaa(x y z)\nendfunction()\n\nbbb(a b c)\n\n# \u6253\u5370\u7ed3\u679c\n# -- m = x\n# -- m = y\n# -- m = z\n# -- ================\n# -- m = a\n# -- m = b\n# -- m = c\n</code></pre> <p>\u8fd9\u91cc\u7684 <code>ARGN</code> \u5176\u5b9e\u6307\u4ee3\u7684\u662f\u51fd\u6570\u4e2d\u7684 <code>ARGN</code></p>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/07-%E5%AE%8F%E4%B8%8E%E5%87%BD%E6%95%B0/#3","title":"3. \u53c2\u6570\u89e3\u6790","text":"<p>\u7ecf\u5e38\u89c1\u5230\u4ee5\u4e0b\u547d\u4ee4\uff1a</p> <pre><code># \u6848\u4f8b 1\ntarget_include_directories(\n  MyLib\n  PUBLIC include\n  PRIVATE _deps\n)\n# \u6848\u4f8b 2\nexecute_process(\n  COMMAND ls ${current_dir}\n  OUTPUT_VARIABLE subs\n)\n</code></pre> <p>\u8fd9\u4e9b\u5185\u7f6e\u7684\u51fd\u6570\u548c\u5b8f\u53ef\u4ee5\u5bf9\u4ee5\u4e0a\u7684<code>include</code>\u3001<code>_deps</code>\u548c<code>ls ${current_dir}</code>\u7b49\u5185\u5bb9\u8fdb\u884c\u89e3\u6790\uff0c\u5982\u679c\u6211\u4eec\u81ea\u5df1\u5199\u7684\u51fd\u6570\u6216\u5b8f\uff0c\u8981\u5982\u4f55\u5b9e\u73b0\u8fd9\u79cd\u53c2\u6570\u89e3\u6790\u7684\u529f\u80fd\uff1f\u8fd9\u91cc\u8981\u4ecb\u7ecd\u4e00\u4e2a CMake \u5185\u7f6e\u7684\u547d\u4ee4\uff1a<code>cmake_parse_arguments()</code></p>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/07-%E5%AE%8F%E4%B8%8E%E5%87%BD%E6%95%B0/#31","title":"3.1 \u7528\u6cd5","text":"<p>\u6709\u4e24\u4e2a\u5177\u4f53\u7684\u7528\u6cd5\uff1a</p> <pre><code>cmake_parse_arguments(&lt;prefix&gt; &lt;options&gt; &lt;one_value_keywords&gt;\n                      &lt;multi_value_keywords&gt; &lt;args&gt;...)\n\ncmake_parse_arguments(PARSE_ARGV &lt;N&gt; &lt;prefix&gt; &lt;options&gt;\n                      &lt;one_value_keywords&gt; &lt;multi_value_keywords&gt;)\n</code></pre> <p>\u901a\u5e38\u4f7f\u7528\u7b2c\u4e00\u4e2a\u7528\u6cd5\uff0c\u7b2c\u4e8c\u4e2a\u7528\u6cd5\u6574\u4f53\u4e0e\u7b2c\u4e00\u4e2a\u7c7b\u4f3c\uff0c\u6709\u5174\u8da3\u8005\u53ef\u4ee5\u53c2\u8003CMake\u5b98\u7f51\u3002\u4e0b\u9762\u4e3b\u8981\u5bf9\u7b2c\u4e00\u4e2a\u7528\u6cd5\u505a\u8bb2\u89e3\u3002</p> <ol> <li><code>&lt;options&gt;</code>\uff1a\u8868\u793a\u53ef\u9009\u5173\u952e\u8bcd\u5217\u8868\uff0c\u5982\u679c\u4f20\u5165\u53c2\u6570\u5305\u542b\u6b64\u53d8\u91cf\u540d\uff0c\u5219\u4e3a<code>TRUE</code>\uff0c\u53cd\u4e4b\u4e3a <code>FALSE</code>\u3002</li> </ol> <p>\u4f8b\u5982\uff0c\u6211\u4eec\u5e38\u89c1\u7684<code>INTERFACE</code>\uff0c<code>PUBLIC</code>\uff0c<code>PRIVATE</code>\u90fd\u662f<code>target_include_directories</code>\u51fd\u6570\u4e2d\u53ef\u9009\u5173\u952e\u5b57\u5217\u8868\u4e2d\u7684\u5143\u7d20\u3002</p> <pre><code>set(options INTERFACE PUBLIC PRIVATE)\ncmake_parse_arguments(xxx \"${options}\" \"\" \"\" ${ARGN})\n</code></pre> <ol> <li> <p><code>&lt;one_value_keywords&gt;</code>\uff1a\u8868\u793a\u5355\u503c\u5173\u952e\u8bcd\u5217\u8868\uff0c\u6bcf\u4e2a\u5173\u952e\u8bcd\u4ec5\u5bf9\u5e94\u4e00\u4e2a\u503c\u3002</p> </li> <li> <p><code>&lt;multi_value_keywords&gt;</code>\uff1a\u8868\u793a\u591a\u503c\u5173\u952e\u8bcd\u5217\u8868\uff0c\u6bcf\u4e2a\u5173\u952e\u8bcd\u53ef\u5bf9\u5e94\u591a\u4e2a\u503c\u3002</p> </li> </ol> <p>::: tip    1. \u5b9e\u9645\u4e0a\uff0c\u80fd\u7528<code>&lt;one_value_keywords&gt;</code>\u7684\u90fd\u80fd\u7528<code>&lt;multi_value_keywords&gt;</code>\u3002    2. \u8981\u89e3\u6790\u7684\u53c2\u6570<code>&lt;args&gt;...</code>\uff0c\u6211\u4eec\u4e00\u822c\u4f20\u5165\u4e3a<code>${ARGN}</code>\u5373\u53ef\uff0c\u4e00\u822c\u5b9a\u4e49\u7684\u51fd\u6570\u6216\u5b8f\u662f\u65e0\u53c2\u7684\uff0c\u9664\u975e\u7b2c\u4e00\u4e2a\u53c2\u6570\u4e0d\u662f\u5173\u952e\u8bcd\uff0c\u90a3\u4e48\u6709\u591a\u5c11\u975e\u5173\u952e\u8bcd\u53d8\u91cf\uff0c\u5b9a\u4e49\u591a\u5c11\u5f62\u53c2\u3002    :::</p> <p>\u4e3e\u4e2a\u4f8b\u5b50</p> <pre><code>function(my_function)\n  set(multi_args YYY ZZZ)\n  cmake_parse_arguments(\"ABC\" \"\" \"\" \"${multi_args}\" ${ARGN})\n  message(STATUS \"YYY: ${ABC_YYY}\")\n  message(STATUS \"ZZZ: ${ABC_ZZZ}\")\nendfunction()\n\nmy_function(\n  YYY 123 456 789\n  ZZZ abc\n)\n\n# \u6253\u5370\u7ed3\u679c\n# -- YYY: 123;456;789\n# -- ZZZ: abc\n</code></pre> <ol> <li><code>prefix</code>\uff1a\u6211\u4eec\u5c06\u53c2\u6570<code>${ARGN}</code>\u6839\u636e<code>&lt;options&gt;</code>\uff0c<code>&lt;one_value_keywords&gt;</code>\uff0c<code>&lt;multi_value_keywords&gt;</code>\u89c4\u5219\u8fdb\u884c\u89e3\u6790\uff0c\u89e3\u6790\u51fa\u6765\u7684\u65b0\u53d8\u91cf\u540d\u6839\u636e<code>&lt;prefix&gt;</code>\u524d\u7f00\uff0c\u6309\u7167 <code>prefix_\u53c2\u6570\u540d</code>\u7684\u5f62\u5f0f\u8fdb\u884c\u8bbe\u7f6e\uff0c\u4f8b\u5982\uff1a</li> </ol> <pre><code>set(options INTERFACE PUBLIC PRIVATE)\nset(multy_args DEPENDS)\ncmake_parse_arguments(ABC \"${options}\" \"\" \"${multy_args}\" ${ARGN})\n# \u8bbf\u95ee options \u7684\u5185\u5bb9\u662f\u5426\u4e3a ON\nif(${ABC_INTERFACE})   # ABC_ \u524d\u7f00\nelseif(${ABC_PUBLIC})  # ABC_ \u524d\u7f00\nelseif(${ABC_PRIVATE}) # ABC_ \u524d\u7f00\nendif()\n# \u8bbf\u95ee multy_args \u7684\u5185\u5bb9\nmessage(STATUS \"${ABC_DEPENDS}\") # ABC_ \u524d\u7f00\n</code></pre>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/07-%E5%AE%8F%E4%B8%8E%E5%87%BD%E6%95%B0/#32","title":"3.2 \u6848\u4f8b","text":"<p>\u6700\u540e\uff0c\u6765\u770b RMVL \u4e2d\u4f7f\u7528\u6709\u5173\u6dfb\u52a0\u6d4b\u8bd5\u7528\u4f8b\u7684\u5b8f\u6765\u505a\u5de9\u56fa\uff1a</p> <pre><code># \u5728\u5f53\u524d\u76ee\u5f55\u4e2d\u6dfb\u52a0\u65b0\u7684\u6d4b\u8bd5\u7528\u4f8b\n# \u7528\u6cd5:\n# rmvl_add_test(\n#   &lt;name&gt;\n#   [DEPENDS &lt;rmvl_target&gt;]\n#   [DEPEND_TESTS &lt;test_target&gt;]\n# )\n# \u793a\u4f8b:\n# rmvl_add_test(\n#   detector                       # \u6d4b\u8bd5\u540d\n#   DEPENDS armor_detector         # \u9700\u8981\u4f9d\u8d56\u7684 RMVL \u76ee\u6807\u5e93\n#   DEPEND_TESTS GTest::gtest_main # \u9700\u8981\u4f9d\u8d56\u7684\u7b2c\u4e09\u65b9\u6d4b\u8bd5\u5de5\u5177\u76ee\u6807\u5e93\n# )\nmacro(rmvl_add_test _name)\n  # add arguments variable    \n  set(multy_args DEPENDS DEPEND_TESTS)\n  cmake_parse_arguments(TEST \"\" \"\" \"${multy_args}\" ${ARGN})\n  # add testing executable\n  set(test_dir)\n  aux_source_directory(test test_dir)\n  add_executable(rmvl_${_name}_test ${test_dir})\n  # depends\n  foreach(_dep ${TEST_DEPENDS})\n    target_link_libraries(\n      rmvl_${_name}_test\n      PRIVATE rmvl_${_dep}\n    )\n  endforeach(_dep ${TEST_DEPENDS})\n  # test depends\n  target_link_libraries(\n    rmvl_${_name}_test\n    PRIVATE ${TEST_DEPEND_TESTS}\n  )\n  gtest_discover_tests(rmvl_${_name}_test)\nendmacro(rmvl_add_test _name)\n</code></pre>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/08-find_package%20%E8%AF%A6%E8%A7%A3/","title":"\u301008\u3011find_package \u8be6\u89e3","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/08-find_package%20%E8%AF%A6%E8%A7%A3/#1","title":"1. \u524d\u8a00","text":"<p>\u5148\u770b\u4ee5\u4e0b\u5bfb\u627e\u5e76\u5305\u542b OpenCV \u7684 <code>CMakeLists.txt</code> \u793a\u4f8b</p> <pre><code>cmake_minimum_required(VERSION 3.10)\n\nproject(Demo)\n\nfind_package(OpenCV REQUIRED)\n\nadd_executable(demo main.cpp)\n\ntarget_link_libraries(\n  demo\n  PRIVATE ${OpenCV_LIBS}\n)\n</code></pre> <p>\u8fd9\u662f\u4e00\u6bb5\u518d\u719f\u6089\u4e0d\u8fc7\u7684 CMakeLists.txt \u4ee3\u7801\uff0c\u6211\u4eec\u901a\u8fc7 <code>find_package</code> \u547d\u4ee4\u5bfb\u627e\u5230\u4e86OpenCV\u5e93\uff0c\u5e76\u83b7\u5f97\u4e86\u5176\u4e2d\u7684\u5bfc\u5165\u76ee\u6807\u5217\u8868\u3002\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 <code>message</code> \u9a8c\u8bc1\u4e00\u4e0b <code>OpenCV_LIBS</code> \u5305\u542b\u7684\u5185\u5bb9</p> <pre><code>foreach(m ${OpenCV_LIBS})\n  message(STATUS ${m})\nendforeach()\n\n# \u8f93\u51fa\u7ed3\u679c\n# opencv_core;opencv_imgproc;opencv_highgui;opencv_imgcodecs; ...\n</code></pre> <p>\u90a3\u4e48CMake\u662f\u5982\u4f55\u901a\u8fc7 <code>find_package</code> \u547d\u4ee4\u627e\u5230OpenCV\u5e76\u4e14\u5b8c\u6210\u914d\u7f6e\u7684\u5462?</p>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/08-find_package%20%E8%AF%A6%E8%A7%A3/#2-find_package","title":"2. find_package \u89e3\u6790\u8fc7\u7a0b","text":"<p>Module \u6a21\u5f0f</p> <p>\u8fd9\u79cd\u6a21\u5f0f\u4e0b\uff0c<code>find_package</code> \u9700\u8981\u89e3\u6790 <code>Findxxx.cmake</code> \u6587\u4ef6\uff0c\u8fd9\u4e5f\u662f <code>find_package</code> \u9ed8\u8ba4\u5de5\u4f5c\u7684\u6a21\u5f0f</p> <p>Config \u6a21\u5f0f</p> <p>\u8fd9\u79cd\u6a21\u5f0f\u4e0b\uff0c<code>find_package</code> \u9700\u8981\u89e3\u6790 <code>xxxConfig.cmake</code> \u6587\u4ef6\u6216\u8005 <code>xxx-config.cmake</code> \u6587\u4ef6\u3002\u5b9e\u9645\u4e0a\u53ea\u6709 <code>Findxxx.cmake</code> \u6587\u4ef6\u65e0\u6cd5\u627e\u5230\uff0c\u5373 Module \u6a21\u5f0f\u6267\u884c\u4e0d\u6210\u529f\uff0c\u624d\u4f1a\u8fdb\u5165 Config \u6a21\u5f0f\u3002</p>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/08-find_package%20%E8%AF%A6%E8%A7%A3/#3-module","title":"3. Module \u6a21\u5f0f","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/08-find_package%20%E8%AF%A6%E8%A7%A3/#31","title":"3.1 \u7528\u6cd5","text":"<p>Module \u6a21\u5f0f\u4e0b <code>find_package</code> \u7684\u53c2\u6570\u4e3a\uff1a</p> <pre><code>find_package(&lt;package&gt; [VERSION] [EXACT] [QUIET] [MODULE]\n             [REQUIRED] [[COMPONENTS] [components...]]\n             [OPTIONAL_COMPONENTS components...]\n             [NO_POLICY_SCOPE])\n</code></pre> <p>\u8fd9\u91cc\u5bf9\u4e0a\u8ff0\u63d0\u53ca\u5230\u7684\u53c2\u6570\u505a\u4e2a\u7b80\u5355\u7684\u89e3\u91ca\uff1a</p> \u53c2\u6570\u540d\u79f0 \u53ef\u9009\u6027 \u540d\u79f0 \u5907\u6ce8 <code>package</code> \u5fc5\u586b \u9700\u8981\u67e5\u627e\u7684\u5305\u540d \u6ce8\u610f\u5927\u5c0f\u5199 <code>VERSION</code> \u53ef\u9009 \u6307\u5b9a\u7248\u672c\uff0c\u5982\u679c\u6307\u5b9a\u5c31\u5fc5\u987b\u68c0\u67e5\u627e\u5230\u7684\u5305\u7684\u7248\u672c\u662f\u5426\u548c<code>VERSION</code>\u517c\u5bb9 <code>EXACT</code> \u53ef\u9009 \u5982\u679c\u6307\u5b9a\u8be5\u53c2\u6570\uff0c\u5219\u8868\u793a\u9700\u8981\u5bfb\u627e\u5fc5\u987b\u5b8c\u5168\u5339\u914d\u7684\u7248\u672c\u800c\u4e0d\u662f\u517c\u5bb9\u7248\u672c \u914d\u5408<code>VERSION</code>\u4f7f\u7528 <code>REQUIRED</code> \u53ef\u9009 \u8868\u793a\u4e00\u5b9a\u8981\u627e\u5230\u5305\uff0c\u627e\u4e0d\u5230\u7684\u8bdd\u5c31\u7acb\u5373\u505c\u6389\u6574\u4e2a CMake \u89e3\u6790\u8fc7\u7a0b <code>QUIET</code> \u53ef\u9009 \u8868\u793a\u5982\u679c\u67e5\u627e\u5931\u8d25\uff0c\u4e0d\u4f1a\u5728\u5c4f\u5e55\u8fdb\u884c\u8f93\u51fa \u4e0d\u5f97\u4e0e<code>REQUIRED</code>\u642d\u914d <code>MODULE</code> \u53ef\u9009 \u524d\u9762\u63d0\u5230\u8bf4 \u201c Module \u6a21\u5f0f\u6267\u884c\u5931\u8d25\uff0c\u624d\u4f1a\u8fdb\u5165 Config \u6a21\u5f0f\u201d\uff0c\u4f46\u662f\u5047\u5982\u52a0\u5165\u4e86<code>MODULE</code>\u9009\u9879\uff0c\u90a3\u4e48\u5c31\u53ea\u5728 Module \u6a21\u5f0f\u67e5\u627e\uff0c\u5982\u679c Module \u6a21\u5f0f\u4e0b\u67e5\u627e\u5931\u8d25\u5e76\u4e0d\u5207\u6362\u5230 Config \u6a21\u5f0f\u67e5\u627e\u3002 <code>COMPONENTS</code> \u53ef\u9009 \u8868\u793a\u67e5\u627e\u7684\u5305\u4e2d\u5fc5\u987b\u8981\u627e\u5230\u7684\u7ec4\u4ef6(components)\uff0c\u5982\u679c\u6709\u4efb\u4f55\u4e00\u4e2a\u627e\u4e0d\u5230\u5c31\u7b97\u5931\u8d25\uff0c\u7c7b\u4f3c\u4e8e<code>REQUIRED</code>\uff0c\u5bfc\u81f4CMake \u505c\u6b62\u6267\u884c\u3002"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/08-find_package%20%E8%AF%A6%E8%A7%A3/#32","title":"3.2 \u6587\u4ef6\u641c\u7d22\u8fc7\u7a0b","text":"<ul> <li>#2 \u63d0\u5230\u8fc7\uff0cModule \u6a21\u5f0f\u4e0b\u9700\u8981\u67e5\u627e\u5230\u540d\u4e3a <code>Find&lt;PackageName&gt;.cmake</code> \u7684\u914d\u7f6e\u6587\u4ef6\u3002\u8be5\u6587\u4ef6\u7684\u67e5\u627e\u8fc7\u7a0b\u53ea\u6d89\u53ca\u5230\u4e24\u4e2a\u8def\u5f84\uff1a<code>CMAKE_MODULE_PATH</code> \u548c CMake \u5b89\u88c5\u8def\u5f84\u4e0b\u7684 Modules \u76ee\u5f55\u3002\u5373\uff0c\u641c\u7d22\u8def\u5f84\u4f9d\u6b21\u4e3a\uff1a</li> <li>\u5148\u5728 <code>CMAKE_MODULE_PATH</code> \u53d8\u91cf\u5bf9\u5e94\u7684\u8def\u5f84\u4e2d\u67e5\u627e\u3002\u5982\u679c\u8def\u5f84\u4e3a\u7a7a\uff0c\u6216\u8005\u8def\u5f84\u4e2d\u67e5\u627e\u5931\u8d25\uff0c\u5219\u5728 CMake \u5b89\u88c5\u76ee\u5f55\uff08\u5373 <code>CMAKE_ROOT</code> \u53d8\u91cf\uff09\u4e0b\u7684 Modules \u76ee\u5f55\u4e2d\u67e5\u627e\u3002\u8fd9\u4e2a\u76ee\u5f55\u901a\u5e38\u4e3a <code>/usr/share/cmake-x.xx/Modules</code>\u3002\u8fd9\u4e24\u4e2a\u53d8\u91cf\u53ef\u4ee5\u5728<code>CMakeLists.txt</code>\u6587\u4ef6\u4e2d\u6253\u5370\u67e5\u770b\u5177\u4f53\u5185\u5bb9\uff1a</li> <li>\u5176\u4e2d <code>CMAKE_MODULE_PATH</code> \u9ed8\u8ba4\u4e3a\u7a7a\uff0c\u53ef\u4ee5\u5229\u7528 <code>set</code> \u547d\u4ee4\u5bf9\u8be5\u53d8\u91cf\u8fdb\u884c\u8bbe\u7f6e\u3002</li> <li>\u5728\u5b89\u88c5 CMake \u65f6\uff0cCMake \u4e3a\u6211\u4eec\u63d0\u4f9b\u4e86\u5f88\u591a\u5f00\u53d1\u5e93\u7684 <code>FindXXX.cmake</code> \u6a21\u5757\u6587\u4ef6\uff0c\u8fd9\u4e9b\u6587\u4ef6\u90fd\u5b9a\u4e49\u5728 <code>CMAKE_ROOT</code> \u6307\u4ee3\u8def\u5f84\u7684\u6587\u4ef6\u5939\u91cc\u9762\u3002\u53ef\u4ee5\u5728\u7ec8\u7aef\u901a\u8fc7\u952e\u5165\u4ee5\u4e0b\u547d\u4ee4\u8fdb\u884c\u67e5\u8be2</li> </ul>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/08-find_package%20%E8%AF%A6%E8%A7%A3/#4-config","title":"4. Config \u6a21\u5f0f","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/08-find_package%20%E8%AF%A6%E8%A7%A3/#41","title":"4.1 \u7528\u6cd5","text":"<p>Config \u6a21\u5f0f\u4e0b <code>find_package</code> \u7684\u5b8c\u6574\u547d\u4ee4\u53c2\u6570\u5982\u4e0b\uff0c\u4e0d\u5fc5\u5168\u90e8\u4e86\u89e3\u3002</p> <ul> <li>\u76f8\u6bd4\u4e8e Module \u6a21\u5f0f\uff0cConfig \u6a21\u5f0f\u7684\u53c2\u6570\u66f4\u591a\uff0c\u4e5f\u66f4\u590d\u6742\uff0c\u4f46\u5b9e\u9645\u5728\u4f7f\u7528\u8fc7\u7a0b\u4e2d\u6211\u4eec\u5e76\u4e0d\u4f1a\u7528\u5230\u6240\u6709\u53c2\u6570\uff0c\u5927\u90e8\u5206\u53c2\u6570\u90fd\u662f\u53ef\u9009\u7684\uff0c\u6211\u4eec\u53ea\u9700\u8981\u638c\u63e1\u57fa\u672c\u7684\u53c2\u6570\u7528\u6cd5\u5373\u53ef\u3002</li> <li>\u5176\u4e2d\u5177\u4f53\u67e5\u627e\u5e93\u5e76\u7ed9 <code>XXX_INCLUDE_DIRS</code> \u548c <code>XXX_LIBS</code> \u4e24\u4e2a\u53d8\u91cf\u8d4b\u503c\u7684\u64cd\u4f5c\u7531 <code>XXXConfig.cmake</code> \u6a21\u5757\u5b8c\u6210\u3002</li> <li>\u4e24\u79cd\u6a21\u5f0f\u770b\u8d77\u6765\u4f3c\u4e4e\u5dee\u4e0d\u591a\uff0c\u4e0d\u8fc7 CMake \u9ed8\u8ba4\u91c7\u53d6 Module \u6a21\u5f0f\uff0c\u5982\u679c Module \u6a21\u5f0f\u672a\u627e\u5230\u5e93\uff0c\u624d\u4f1a\u91c7\u53d6 Config \u6a21\u5f0f\u3002\u603b\u4e4b\uff0cConfig \u6a21\u5f0f\u662f\u4e00\u4e2a\u5907\u9009\u7b56\u7565\u3002\u901a\u5e38\uff0c\u5e93\u5b89\u88c5\u65f6\u4f1a\u62f7\u8d1d\u4e00\u4efd <code>XXXConfig.cmake</code> \u5230\u7cfb\u7edf\u76ee\u5f55\u4e2d\uff0c\u56e0\u6b64\u5728\u6ca1\u6709\u663e\u5f0f\u6307\u5b9a\u641c\u7d22\u8def\u5f84\u65f6\u4e5f\u53ef\u4ee5\u987a\u5229\u627e\u5230\u3002</li> </ul>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/08-find_package%20%E8%AF%A6%E8%A7%A3/#42","title":"4.2 \u6587\u4ef6\u641c\u7d22\u8fc7\u7a0b","text":"<ul> <li> <p>\u4e0e Module \u6a21\u5f0f\u4e0d\u540c\uff0cConfig \u6a21\u5f0f\u9700\u8981\u67e5\u627e\u7684\u8def\u5f84\u975e\u5e38\u975e\u5e38\u975e\u5e38\u591a\uff0c\u4e5f\u8981\u5339\u914d\u5f88\u591a\u7684\u53ef\u80fd\u6027\uff0c\u56e0\u6b64\u6709\u4e9b\u8def\u5f84\u662f\u9996\u5148\u4f5c\u4e3a\u6839\u76ee\u5f55\uff0c\u7136\u540e\u8fdb\u884c\u5b50\u76ee\u5f55\u7684\u5339\u914d\uff0c\u800c\u6709\u4e9b\u5219\u662f\u76f4\u63a5\u6307\u5b9a\u5230\u5177\u4f53\u7684 <code>XXXConfig.cmake</code> \u6587\u4ef6\u3002\u5177\u4f53\u5c06\u4f1a\u6309\u7167\u5982\u4e0b\u987a\u5e8f\u8fdb\u884c\u67e5\u627e\uff1a</p> </li> <li> <p><code>&lt;PackageName&gt;_DIR</code></p> </li> <li><code>CMAKE_PREFIX_PATH</code>\u3001<code>CMAKE_FRAMEWORK_PATH</code>\u3001<code>CMAKE_APPBUNDLE_PATH</code></li> <li><code>PATH</code>\u73af\u5883\u53d8\u91cf\u8def\u5f84</li> <li><code>CMAKE_SYSTEM_PREFIX_PATH</code>\u7b49\u7cfb\u7edf\u53d8\u91cf\u8def\u5f84</li> </ul> <p>\\&lt;PackageName&gt;_DIR</p> <p>\u9996\u5148\u641c\u7d22\u540d\u4e3a<code>&lt;PackageName&gt;_DIR</code>\u7684 CMake \u53d8\u91cf\u6216\u73af\u5883\u53d8\u91cf\u8def\u5f84\uff0c\u8fd9\u4e2a\u53d8\u91cf\u9ed8\u8ba4\u4e3a\u7a7a\u3002\u8fd9\u4e2a\u8def\u5f84\u9700\u8981\u76f4\u63a5\u6307\u5b9a\u5230<code>&lt;PackageName&gt;Config.cmake</code>\u6216<code>&lt;lower-case-package-name&gt;-config.cmake</code>\u6587\u4ef6\u6240\u5728\u76ee\u5f55\u624d\u80fd\u627e\u5230\uff0c\u53ef\u53c2\u8003\u4ee5\u4e0b\u793a\u4f8b\uff1a</p> <p>CMAKE_PREFIX_PATH \u7b49\u53d8\u91cf</p> <p>\u5982\u679c\u6309\u7167<code>&lt;PackageName&gt;_DIR</code>\u641c\u7d22\u4e0d\u5230\u76f8\u5e94\u7684<code>XXXConfig.cmake</code>\u6587\u4ef6\u7684\u8bdd\uff0c\u5219\u4f1a\u67e5\u627e\u540d\u4e3a<code>CMAKE_PREFIX_PATH</code>\u3001<code>CMAKE_FRAMEWORK_PATH</code>\u3001<code>CMAKE_APPBUNDLE_PATH</code>\u7684 CMake \u53d8\u91cf\u6216\u73af\u5883\u53d8\u91cf\u8def\u5f84\u3002\u8fd9\u4e9b\u53d8\u91cf\u6307\u5b9a\u7684\u8def\u5f84\u5c06\u4f5c\u4e3a\u67e5\u627e\u65f6\u7684\u6839\u76ee\u5f55\uff0c\u5b83\u4eec\u9ed8\u8ba4\u90fd\u4e3a\u7a7a\u3002\u6839\u76ee\u5f55\u7684\u76f8\u5173\u5185\u5bb9\u5728\u540e\u6587\u4f1a\u63d0\u53ca\u3002</p> <p>::: tip \u5982\u679c\u4f60\u7535\u8111\u4e2d\u5b89\u88c5\u4e86 ROS \u5e76\u914d\u7f6e\u597d\u4e4b\u540e\uff0c\u4f60\u5728\u7ec8\u7aef\u6267\u884c <code>echo $CMAKE_PREFIX_PATH</code> \u4f1a\u53d1\u73b0 ROS \u4f1a\u5c06 <code>CMAKE_PREFIX_PATH</code> \u8fd9\u4e2a\u53d8\u91cf\u8bbe\u7f6e\u4e3a ROS \u4e2d\u7684\u5e93\u7684\u8def\u5f84\uff0c\u610f\u601d\u662f\u4f1a\u9996\u5148\u67e5\u627e ROS \u5b89\u88c5\u7684\u5e93\uff0c\u5982\u679c\u6070\u597d\u4f60\u5728 ROS \u4e2d\u5b89\u88c5\u4e86 OpenCV \u5e93\uff0c\u5c31\u4f1a\u53d1\u73b0\u9996\u5148\u627e\u5230\u7684\u662f ROS \u4e2d\u7684 OpenCV\uff0c\u800c\u4e0d\u662f\u4f60\u81ea\u5df1\u5b89\u88c5\u5230\u7cfb\u7edf\u4e2d\u7684 OpenCV\u3002 :::</p> <p>PATH \u73af\u5883\u53d8\u91cf\u8def\u5f84</p> <ul> <li>\u82e5\u8fd8\u627e\u4e0d\u5230\uff0c\u5219\u662f\u641c\u7d22 <code>PATH</code> \u73af\u5883\u53d8\u91cf\u8def\u5f84\uff0c\u8fd9\u4e2a\u8def\u5f84\u4e5f\u662f\u6839\u76ee\u5f55\uff0c\u9ed8\u8ba4\u4e3a\u7cfb\u7edf\u73af\u5883 <code>PATH</code> \u73af\u5883\u53d8\u91cf\u503c\u3002</li> <li>\u5176\u5b9e\u8fd9\u4e2a\u8def\u5f84\u624d\u662f Config \u6a21\u5f0f\u5927\u90e8\u5206\u60c5\u51b5\u4e0b\u80fd\u591f\u67e5\u627e\u5230\u5b89\u88c5\u5230\u7cfb\u7edf\u4e2d\u5404\u79cd\u5e93\u7684\u539f\u56e0\u3002\u8fd9\u4e2a\u8def\u5f84\u7684\u67e5\u627e\u89c4\u5219\u4e3a\uff1a\u904d\u5386 <code>PATH</code> \u73af\u5883\u53d8\u91cf\u4e2d\u7684\u5404\u8def\u5f84\uff0c\u5982\u679c\u8be5\u8def\u5f84\u5982\u679c\u4ee5 <code>bin</code> \u6216 <code>sbin</code> \u7ed3\u5c3e\uff0c\u5219\u81ea\u52a8\u56de\u9000\u5230\u4e0a\u4e00\u7ea7\u76ee\u5f55\u5f97\u5230\u6839\u76ee\u5f55\u3002\u5728\u7ec8\u7aef\u952e\u5165\u4ee5\u4e0b\u5185\u5bb9\u4ee5\u67e5\u770b\u7cfb\u7edf\u73af\u5883\u53d8\u91cf\u8def\u5f84\uff1a</li> </ul> <pre><code>echo $PATH\n</code></pre> <p>\u4e00\u822c\u60c5\u51b5\u8f93\u51fa\u7ed3\u679c\u5982\u4e0b\uff0c\u8fd9\u91cc\u5bf9\u6bcf\u4e2a\u8def\u5f84\u90fd\u505a\u4e86\u6362\u884c\u5904\u7406\uff0c\u5e76\u4e14\u52a0\u4e86\u4e9b\u7b80\u5355\u7684\u6ce8\u91ca\u3002</p> <pre><code>/home/&lt;user-name&gt;/.local/bin: # \u56de\u9000\u5230 /home/&lt;user-name&gt;/.local \u540e\u518d\u8fdb\u884c\u641c\u7d22\n/usr/local/sbin:              # \u56de\u9000\u5230 /usr/local \u540e\u518d\u8fdb\u884c\u641c\u7d22\n/usr/local/bin:               # \u540c\u4e0a\n/usr/sbin:                    # \u56de\u9000\u5230 /usr \u540e\u518d\u8fdb\u884c\u641c\u7d22\n/usr/bin:                     # \u540c\u4e0a\n/sbin:                        # \u56de\u9000\u5230 / \u540e\u518d\u8fdb\u884c\u641c\u7d22\n/bin:                         # \u540c\u4e0a\n/usr/games:\n/usr/local/games:\n/snap/bin                     # \u56de\u9000\u5230 /snap \u540e\u518d\u8fdb\u884c\u641c\u7d22\n</code></pre> <p>\u8bf4\u660e\u8fd9\u4e9b\u8def\u5f84\u4f1a\u88ab\u9ed8\u8ba4\u6dfb\u52a0\u5728 Config \u6a21\u5f0f\u7684\u641c\u7d22\u8def\u5f84\u4e2d\u3002</p> <p>CMAKE_SYSTEM_PREFIX_PATH \u7b49\u53d8\u91cf</p> <ul> <li>\u6211\u4eec\u5728\u5b89\u88c5 OpenCV \u7684\u65f6\u5019\uff0c\u53ef\u4ee5\u5728 <code>cmake-gui</code> \u4e2d\u4fee\u6539 <code>CMAKE_INSTALL_PREFIX</code> \u53d8\u91cf\u7684\u5185\u5bb9\uff0c\u628a OpenCV \u5b89\u88c5\u5728 <code>/opt/opencv</code> \u4e0b\uff0c\u6211\u4eec\u5728\u4f7f\u7528 <code>find_package</code> \u65f6\u4e5f\u4e0d\u9700\u8981\u6307\u540d\u8def\u5f84\uff0c\u8bf4\u660e\u9664\u4e86\u4e0a\u9762\u7684\u4e00\u4e9b\u53d8\u91cf\u4e4b\u5916\uff0c\u8fd8\u5b58\u5728\u53e6\u5916\u4e00\u7cfb\u5217\u8def\u5f84\u3002\u8fd9\u91cc\u5217\u51fa\u6700\u91cd\u8981\u7684\u4e00\u4e2a\u53d8\u91cf\uff1a<code>CMAKE_SYSTEM_PREFIX_PATH</code></li> <li>\u6211\u4eec\u53ef\u4ee5\u5728\u4e00\u4e2a CMakeLists.txt \u6587\u4ef6\u4e0b\uff0c\u8f93\u5165\u4ee5\u4e0b\u5185\u5bb9\uff1a</li> </ul> <pre><code>foreach(path ${CMAKE_SYSTEM_PREFIX_PATH})\n  message(STATUS \"${path}\")\nendforeach()\n</code></pre> <p>\u4f1a\u6253\u5370\u51fa\u4ee5\u4e0b\u5185\u5bb9</p> <pre><code>-- /usr/local\n-- /usr\n-- /\n-- /usr/local\n-- /usr/local\n-- /usr/X11R6\n-- /usr/pkg\n-- /opt\n</code></pre> <ul> <li>\u7559\u610f\u8be5\u53d8\u91cf\u6700\u540e\u4e00\u70b9\u5305\u542b\u7684\u5185\u5bb9\uff0c\u8fd9\u6b63\u662f\u6211\u4eec\u53ef\u4ee5\u628a\u7b2c\u4e09\u65b9\u5e93\u5b89\u88c5\u5728 <code>/opt</code> \u7684\u539f\u56e0\u3002\u4e8b\u5b9e\u4e0a\uff0c\u5f88\u591a\u8f6f\u4ef6\u5305\u90fd\u662f\u9ed8\u8ba4\u5b89\u88c5\u5728 <code>/opt</code> \u4e0b\u7684\uff0c\u8b6c\u5982 ROS\u3002</li> </ul> <p>::: tip \u8865\u5145 \u76f8\u5173\u5305\u542b\u7684\u5185\u5bb9\u8fd8\u6709\u975e\u5e38\u4e4b\u591a\uff0c\u6709\u5174\u8da3\u7684\u53ef\u4ee5\u9605\u8bfb\u5b98\u7f51\u548c\u6e90\u7801\uff0c\u8fd9\u91cc\u7ed9\u51fa\u5b98\u7f51\u548c\u6e90\u7801 GitLab \u5730\u5740\uff1a - <code>find_package</code> \u5bfb\u627e\u5305\u542b\u8def\u5f84\u7684\u6e90\u7801 GitLab\uff1a\u6e90\u7801 GitLab \u5730\u5740 - <code>find_package</code> \u5bfb\u627e\u5305\u542b\u8def\u5f84\u7684\u5b98\u7f51\uff1a\u5b98\u7f51\u7f51\u5740 :::</p>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/08-find_package%20%E8%AF%A6%E8%A7%A3/#43","title":"4.3 \u6839\u76ee\u5f55\u8def\u5f84\u8be6\u89e3","text":"<p>\u4e0a\u8ff0\u63d0\u53ca\u5230\u7684\u6839\u76ee\u5f55\u8def\u5f84\uff0c\u5728\u6307\u660e\u8fd9\u4e9b\u5185\u5bb9\u65f6\uff0cCMake \u4f1a\u9996\u5148\u68c0\u67e5\u8fd9\u4e9b\u6839\u76ee\u5f55\u8def\u5f84\u4e0b\u662f\u5426\u6709\u540d\u4e3a <code>&lt;PackageName&gt;Config.cmake</code> \u6216 <code>&lt;lower-case-package-name&gt;-config.cmake</code> \u7684\u6a21\u5757\u6587\u4ef6\uff0c\u5982\u679c\u6ca1\u6709\uff0cCMake \u4f1a\u7ee7\u7eed\u68c0\u67e5\u6216\u5339\u914d\u8fd9\u4e9b\u6839\u76ee\u5f55\u4e0b\u7684\u4ee5\u4e0b\u8def\u5f84\uff1a</p> <pre><code>&lt;prefix&gt;/(lib/&lt;arch&gt;|lib|share)/cmake/&lt;name&gt;*/\n&lt;prefix&gt;/(lib/&lt;arch&gt;|lib|share)/&lt;name&gt;*/\n&lt;prefix&gt;/(lib/&lt;arch&gt;|lib|share)/&lt;name&gt;*/(cmake|CMake)/\n</code></pre> <p>\u5176\u4e2d\u4e3a <code>arch</code> \u7cfb\u7edf\u67b6\u6784\u540d\uff0c\u5982 Ubuntu \u4e0b\u4e00\u822c\u4e3a\uff1a<code>x86_64-linux-gnu</code>\uff0c\u6574\u4e2a <code>(lib/&lt;arch&gt;|lib|share)</code> \u4e3a\u53ef\u9009\u8def\u5f84\uff0c\u4f8b\u5982 OpenCV \u5e93\u800c\u8a00\u4f1a\u68c0\u67e5\u6216\u5339\u914d\u4ee5\u4e0b\u5185\u5bb9\uff1a</p> <ol> <li><code>&lt;prefix&gt;/lib/x86_64-linux-gnu/opencv4/</code></li> <li><code>&lt;prefix&gt;/lib/cmake/opencv4/</code></li> <li><code>&lt;prefix&gt;/share/opencv4/</code></li> <li>\u2026\u2026</li> </ol> <p>::: warning \u4e0a\u6587\u63d0\u53ca\u8fc7\u7684 <code>&lt;PackageName&gt;_DIR</code> \u8def\u5f84\u4e0d\u662f\u6839\u76ee\u5f55\u8def\u5f84 :::</p>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/08-find_package%20%E8%AF%A6%E8%A7%A3/#5-findxxxcmake","title":"5. FindXXX.cmake \u7b80\u5355\u5199\u6cd5","text":"<p>\u6211\u4eec\u4f7f\u7528 Module \u6a21\u5f0f\uff0c\u5199\u4e00\u4e2a <code>FindXXX.cmake</code> \u6587\u4ef6\uff0c\u6765\u4f53\u9a8c\u4e00\u4e0b\u81ea\u5df1\u7684<code>find_package</code></p>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/08-find_package%20%E8%AF%A6%E8%A7%A3/#51","title":"5.1 \u6848\u4f8b","text":"<p>\u5047\u8bbe\u67d0\u5bb6\u76f8\u673a\u5382\u5546\u7684 SDK \u63d0\u4f9b\u4e86\u4ee5\u4e0b\u5185\u5bb9\uff0c\u5047\u8bbe\u5c06\u5176\u653e\u5728\u4e86 <code>/opt/camera</code> \u6587\u4ef6\u5939\u4e0b\uff0c\u8bf7\u521b\u5efa\u4e00\u4e2a <code>CameraDemo</code> \u9879\u76ee\uff0c\u5e76\u8bbe\u8ba1\u4e00\u4e2a <code>FindCamera.cmake</code> \u6587\u4ef6\u4f9b\u672c\u9879\u76ee\u4e2d\u7684\u5176\u4f59\u76ee\u6807\u5305\u542b\uff0c\u4f7f\u5176\u80fd\u591f\u94fe\u63a5\u81f3\u672c\u76f8\u673a\u7684 SDK\u3002</p> <pre><code>.\n\u251c\u2500\u2500 include\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 CameraApi.h\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 CameraDefine.h\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 CameraStatus.h\n\u2514\u2500\u2500 lib\n    \u2514\u2500\u2500 libMVSDK.so\n</code></pre>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/08-find_package%20%E8%AF%A6%E8%A7%A3/#52","title":"5.2 \u5206\u6790","text":"<p>\u6211\u4eec\u5728\u301005\u3011\u76ee\u6807\u6784\u5efa\u7684\u5bfc\u5165\u76ee\u6807\u4e2d\u9047\u5230\u8fc7\u7c7b\u4f3c\u7684\u60c5\u51b5\uff0c\u4f46\u8fd9\u91cc\u7684\u76f8\u673a SDK \u5e76\u6ca1\u6709\u4f4d\u4e8e\u672c\u9879\u76ee\u4e2d\u3002</p> <p>\u6ce8\u610f\u5230\u76f8\u673a\u5382\u5546\u7684 SDK \u5e76\u65e0\u63d0\u4f9b\u76f8\u5e94\u7684 <code>CameraConfig.cmake</code> \u6216 <code>camera-config.cmake</code> \u6587\u4ef6\uff0c\u56e0\u6b64\u9700\u8981\u81ea\u5df1\u624b\u5199 <code>FindCamera.cmake</code> \u6587\u4ef6\u3002</p> <p>\u6211\u4eec\u5148\u628a\u76f8\u673a\u9879\u76ee\u7684\u90e8\u7f72\u6846\u67b6\u7ed9\u5927\u6982\u5b9a\u4e49\u597d\uff1a</p> <pre><code>.\n\u251c\u2500\u2500 cmake\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 FindCamera.cmake\n\u251c\u2500\u2500 CMakeLists.txt\n\u2514\u2500\u2500 main.cpp\n</code></pre> <p>\u6d89\u53ca\u5230\u7684\u4e24\u4e2a CMake \u6587\u4ef6\u5df2\u7ecf\u6807\u7ea2\uff0c\u8fd9\u91cc\u7b80\u5355\u63cf\u8ff0\u4e00\u4e0b</p> <ul> <li> <p><code>FindCamera.cmake</code>\uff1a\u5176\u4ed6\u5e93\u76f4\u63a5\u5305\u542b\u3001\u94fe\u63a5 SDK \u63d0\u4f9b\u7684\u5e93\u80af\u5b9a\u662f\u4e0d\u884c\u7684\uff0c\u9700\u8981\u4e8b\u5148\u627e\u5230 SDK \u7684\u8def\u5f84\uff0c\u6b64\u6587\u4ef6\u5c31\u662f\u4e3a\u4e86\u63d0\u524d\u8ba9\u6574\u4e2a CMake \u5de5\u7a0b\u627e\u5230\u6b64 SDK\u3002</p> </li> <li> <p>\u9879\u76ee\u6839\u76ee\u5f55\u7684 <code>CMakeLists.txt</code>\uff1a\u6846\u67b6\u6574\u4f53\u914d\u7f6e\uff0c\u5305\u62ec\u9879\u76ee\u3001\u7f16\u8bd1\u5c5e\u6027\u3001\u53ef\u6267\u884c\u7a0b\u5e8f\u7684\u914d\u7f6e\u3002\u8fd9\u91cc <code>main.cpp</code> \u76f4\u63a5\u7528\u5230\u4e86 SDK \u7684\u5185\u5bb9\uff0c\u901a\u8fc7\u4ee5\u4e0b\u8bed\u53e5\u8fdb\u884c\u94fe\u63a5</p> </li> </ul> <pre><code>target_link_libraries(\n  demo\n  PRIVATE camera\n)\n</code></pre>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/08-find_package%20%E8%AF%A6%E8%A7%A3/#53","title":"5.3 \u914d\u7f6e","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/08-find_package%20%E8%AF%A6%E8%A7%A3/#531-cmakeliststxt","title":"5.3.1 \u9879\u76ee\u6839\u76ee\u5f55\u7684 CMakeLists.txt","text":"<p>\u2460 \u4e3b\u8981\u76ee\u7684</p> <ol> <li>\u8bbe\u7f6e <code>CMAKE_MODULE_PATH</code> \u6a21\u5757\u6a21\u5f0f\u7684\u5de5\u4f5c\u8def\u5f84</li> <li>\u89e3\u6790 <code>FindCamera.cmake</code>\uff0c\u5e76\u627e\u5230 camera \u5bf9\u5e94\u7684\u5e93</li> <li>\u521b\u5efa\u53ef\u6267\u884c\u7a0b\u5e8f\u76ee\u6807\u5e76\u94fe\u63a5</li> </ol> <p>\u2461 \u793a\u4f8b\u4ee3\u7801</p> <pre><code>cmake_minimum_required(VERSION 3.10)\nproject(CameraDemo)\n# \u672c\u7bc7 2.2.2 \u8282\u63d0\u53ca\u8fc7\uff0c\u4e0b\u4e00\u53e5\u662f\u8ba9 CMake \u5de5\u7a0b\u80fd\u591f\u627e\u5230 FindCamera.cmake\nlist(CMAKE_MODULE_PATH APPEND \"${CMAKE_SOURCE_DIR}/cmake\")\n\n# \u627e\u5230 SDK\nfind_package(Camera)\n\n# \u6dfb\u52a0\u53ef\u6267\u884c\u6587\u4ef6\u5e76\u94fe\u63a5\nadd_executable(demo main.cpp)\ntarget_link_libraries(\n  demo\n  PRIVATE camera\n)\n</code></pre>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/08-find_package%20%E8%AF%A6%E8%A7%A3/#532-findcameracmake","title":"5.3.2 FindCamera.cmake","text":"<p>\u2460 \u4e3b\u8981\u4efb\u52a1</p> <ol> <li>\u63d0\u4f9b\u4e00\u4e2a CMake \u76ee\u6807\u53d8\u91cf\uff08\u4e00\u822c\u662f\u5bfc\u5165\u76ee\u6807\uff09</li> <li>\u627e\u5230 SDK \u7684\u5934\u6587\u4ef6</li> <li>\u627e\u5230 SDK \u7684\u5e93\u6587\u4ef6</li> <li>\u63d0\u4f9b\u6709\u65e0\u627e\u5230\u7684\u72b6\u6001\u4fe1\u606f</li> </ol> <p>\u2461 \u8be6\u7ec6\u6ce8\u91ca\u7684\u793a\u4f8b\u4ee3\u7801</p> <pre><code># \u8bbe\u7f6e mvsdk \u7684\u8def\u5f84\uff08\u53ef\u81ea\u884c\u8bbe\u7f6e\uff09\nset(mvsdk_root \"/opt/camera\")\n\n# \u53d1\u73b0\u5934\u6587\u4ef6\u8def\u5f84\uff0c\u5e76\u8bbe\u7f6e Camera_INCLUDE_DIRS\nfind_path(\n  Camera_INCLUDE_DIR\n  NAMES CameraApi.h CameraDefine.h CameraStatus.h\n  PATHS \"${mvsdk_root}/include\"\n  NO_DEFAULT_PATH # \u9ed8\u8ba4\u8def\u5f84\u4e0b\u4f1a\u5305\u542b /usr/local \u7b49\u5185\u5bb9\uff0c\u8fd9\u53e5\u8bdd\u8868\u660e\u4e0d\u5305\u542b\u9ed8\u8ba4\u8def\u5f84\n)\n\n# \u53d1\u73b0\u5e93\u6587\u4ef6\u8def\u5f84\nfind_library(\n  Camera_LIB\n  NAMES \"libMVSDK.so\"\n  PATHS \"${mvsdk_root}/lib\"\n  NO_DEFAULT_PATH # \u540c find_path\n)\n\n# \u8bbe\u7f6e\u5bfc\u5165\u76ee\u6807\uff0c\u79f0\u4e3a mvsdk\nif(NOT TARGET mvsdk)\n  # \u5c06\u76ee\u6807\u8bbe\u7f6e\u4e3a\u5728\u9879\u76ee\u4e2d\u5168\u5c40\u53ef\u89c1 GLOBAL\n  add_library(mvsdk SHARED IMPORTED GLOBAL)\n  # \u4e3a\u5bfc\u5165\u76ee\u6807\u6dfb\u52a0\u76f8\u5173\u5c5e\u6027\n  set_target_properties(mvsdk PROPERTIES\n    INTERFACE_INCLUDE_DIRECTORIES \"${Camera_INCLUDE_DIR}\"\n    IMPORTED_LOCATION \"${Camera_LIB}\"\n  )\nendif()\n\nset(Camera_INCLUDE_DIRS ${Camera_INCLUDE_DIR})\nset(Camera_LIBS mvsdk)\n\n# \u8fd9\u91cc\u7528\u5230\u4e86\u4e00\u4e2a CMake \u81ea\u5e26\u7684\u51fd\u6570\uff0c\u4f1a\u6839\u636e\u6307\u5b9a\u5185\u5bb9\u8bbe\u7f6e Camera_FOUND \u53d8\u91cf\ninclude(FindPackageHandleStandardArgs)\n# \u610f\u4e3a\u5fc5\u9700\u7684\u53c2\u6570\u662f Camera_LIBS\uff0c\u5982\u679c Camera_LIBS \u4e3a\u7a7a\uff0c\u5219 Camera_FOUND\n# \u5c06\u88ab\u8bbe\u7f6e\u4e3a FALSE\uff0c\u5e76\u5728\u4f7f\u7528 find_package(Camera REQUIRED) \u65f6\u4e5f\u4f1a\u62a5\u9519\nfind_package_handle_standard_args(\n  Camera\n  REQUIRED_VARS Camera_LIBS Camera_INCLUDE_DIRS\n)\n</code></pre> <p>\u2462 FindPackageHandleStandardArgs\u8be6\u89e3</p>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/08-find_package%20%E8%AF%A6%E8%A7%A3/#6-xxxconfigcmake","title":"6. XXXConfig.cmake","text":"<p>\u5173\u4e8e <code>XXXConfig.cmake</code> \u6216 <code>xxx-config.cmake</code> \u7684\u5199\u6cd5\u4f1a\u5728\u540e\u7eed\u6587\u7ae0\u4e2d\u8be6\u7ec6\u8bf4\u660e\uff1a</p> <ul> <li>\u301009\u3011\u751f\u6210\u5668\u8868\u8fbe\u5f0f</li> <li>\u301010\u3011\u9879\u76ee\u7684\u5bfc\u51fa\u4e0e\u5b89\u88c5</li> </ul>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/09-%E7%94%9F%E6%88%90%E5%99%A8%E8%A1%A8%E8%BE%BE%E5%BC%8F/","title":"\u301009\u3011\u751f\u6210\u5668\u8868\u8fbe\u5f0f","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/09-%E7%94%9F%E6%88%90%E5%99%A8%E8%A1%A8%E8%BE%BE%E5%BC%8F/#1","title":"1. \u524d\u8a00","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/09-%E7%94%9F%E6%88%90%E5%99%A8%E8%A1%A8%E8%BE%BE%E5%BC%8F/#11-cmake","title":"1.1 CMake \u5de5\u4f5c\u6d41\u7a0b","text":"<p>CMake \u5de5\u4f5c\u6d41\u7a0b\u5206\u4e3a\u4e24\u6b65\uff0c==\u914d\u7f6e\u9636\u6bb5==\u548c==\u751f\u6210\u9636\u6bb5==\u3002\u6211\u4eec\u5728\u547d\u4ee4\u884c\u4e2d\u8f93\u5165<code>cmake ..</code>\u7684\u65f6\u5019\uff0c\u53ef\u4ee5\u5728\u8f93\u51fa\u5185\u5bb9\u7684\u6700\u540e\u770b\u5230\u8fd9\u6837\u7684\u4e24\u884c\u8bdd</p> <pre><code>-- Configuring done\n-- Generating done\n</code></pre> <p>\u5206\u522b\u6307\u4ee3\u4e86\u8fd9\u4e24\u4e2a\u9636\u6bb5</p>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/09-%E7%94%9F%E6%88%90%E5%99%A8%E8%A1%A8%E8%BE%BE%E5%BC%8F/#111-configure","title":"1.1.1 Configure \u9636\u6bb5","text":"<p>\u5728\u8fd9\u4e2a\u9636\u6bb5\uff0cCMake \u4f1a\u8bfb\u53d6\u4f60\u7684<code>CMakeLists.txt</code>\u6587\u4ef6\uff0c\u5e76\u6267\u884c\u5176\u4e2d\u7684\u547d\u4ee4\u3002\u8fd9\u4e9b\u547d\u4ee4\u53ef\u80fd\u4f1a\u68c0\u67e5\u7cfb\u7edf\u7684\u7279\u6027\uff08\u4f8b\u5982\uff0c\u67e5\u627e\u5e93\u6216\u8005\u7f16\u8bd1\u5668\u7279\u6027\uff09\uff0c\u8bbe\u7f6e\u53d8\u91cf\uff0c\u6216\u8005\u5b9a\u4e49\u6784\u5efa\u76ee\u6807\uff08\u4f8b\u5982\u5e93\u3001\u53ef\u6267\u884c\u6587\u4ef6\uff0c\u6216\u8005\u5176\u4ed6\u4f2a\u76ee\u6807\uff09\u3002\u8fd9\u4e2a\u9636\u6bb5\u7684\u4e3b\u8981\u76ee\u7684\u662f\u786e\u5b9a\u6784\u5efa\u8fc7\u7a0b\u9700\u8981\u7684\u6240\u6709\u4fe1\u606f\u3002</p>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/09-%E7%94%9F%E6%88%90%E5%99%A8%E8%A1%A8%E8%BE%BE%E5%BC%8F/#112-generate","title":"1.1.2 Generate \u9636\u6bb5","text":"<p>\u5728\u6b64\u9636\u6bb5 CMake \u4f1a\u751f\u6210\u5b9e\u9645\u7684\u5efa\u6784\u6863\u3002\u8fd9\u4e9b\u6587\u4ef6\u5305\u542b\u4e86\u5b9e\u9645\u7f16\u8bd1\u548c\u94fe\u63a5\u4f60\u7684\u4ee3\u7801\u6240\u9700\u8981\u7684\u547d\u4ee4\uff0c\u5305\u62ec</p> <ul> <li>\u5404\u79cd\u7f16\u8bd1\u9009\u9879</li> <li>\u4e0e\u76ee\u6807\u76f8\u5173\u7684\u64cd\u4f5c</li> </ul> <p>\u7684\u547d\u4ee4\u90fd\u662f\u5728\u751f\u6210\u9636\u6bb5\u6dfb\u52a0\u81f3\u5efa\u6784\u6863\u4e2d\u7684\u3002\u6bd4\u65b9\u8bf4</p> <pre><code>target_include_directories(\n  demo\n  PUBLIC include\n)\n\ntarget_link_libraries(\n  demo\n  PRIVATE core\n)\n</code></pre> <p>\u8fd9\u4e24\u4e2a\u547d\u4ee4\u5747\u751f\u6548\u4e8e==\u751f\u6210\u9636\u6bb5==\u3002\u800c\u540e\u6587\u51c6\u5907\u4ecb\u7ecd\u7684\u751f\u6210\u5668\u8868\u8fbe\u5f0f\uff0c\u5c31\u4f5c\u7528\u4e8e\u751f\u6210\u9636\u6bb5\u3002\u4e5f\u6b63\u56e0\u5982\u6b64\uff0c\u53ea\u6709\u80fd\u591f\u5728\u751f\u6210\u9636\u6bb5\u751f\u6548\u7684\u547d\u4ee4\u624d\u80fd\u4f7f\u7528\u751f\u6210\u5668\u8868\u8fbe\u5f0f\uff0c\u800c\u5728\u914d\u7f6e\u9636\u6bb5\u751f\u6548\u7684\u547d\u4ee4\uff0c\u4f8b\u5982\u7528\u4e8e\u8bbe\u7f6e\u53d8\u91cf\u7684 <code>set</code> \u547d\u4ee4\u5e76\u4e0d\u652f\u6301\u751f\u6210\u5668\u8868\u8fbe\u5f0f\u3002</p>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/09-%E7%94%9F%E6%88%90%E5%99%A8%E8%A1%A8%E8%BE%BE%E5%BC%8F/#12-cmake","title":"1.2 CMake \u7684\u751f\u6210\u5668\u8868\u8fbe\u5f0f\u662f\u4ec0\u4e48","text":"<p>\u751f\u6210\u5668\u8868\u8fbe\u5f0f\u5728\u751f\u6210\u6784\u5efa\u7cfb\u7edf\u671f\u95f4\u8fdb\u884c\u8ba1\u7b97\uff0c\u4ee5\u751f\u6210\u7279\u5b9a\u4e8e\u6bcf\u4e2a\u751f\u6210\u914d\u7f6e\u7684\u4fe1\u606f\u3002\u4ed6\u4eec\u6709\u5982\u4e0b\u5f62\u5f0f\uff1a<code>$&lt;...&gt;</code>\u3002\u53ef\u53c2\u8003Generator Expression\u3002</p>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/09-%E7%94%9F%E6%88%90%E5%99%A8%E8%A1%A8%E8%BE%BE%E5%BC%8F/#13","title":"1.3 \u4e3a\u4ec0\u4e48\u8981\u5f15\u5165\u751f\u6210\u5668\u8868\u8fbe\u5f0f","text":"<p>\u5728\u8bbe\u7f6e\u67d0\u4e9b\u7f16\u8bd1\u9009\u9879\u7684\u65f6\u5019\uff0c\u5982\u679c\u5f53\u6761\u4ef6\u8f83\u591a\uff0c\u8981\u5236\u4f5c\u7684\u7f16\u8bd1\u9009\u9879\u7248\u672c\u4e5f\u76f8\u5e94\u589e\u591a\u3002\u8fd9\u65f6\u53ef\u4ee5\u4f7f\u7528\u751f\u6210\u5668\u8868\u8fbe\u5f0f\u8bed\u6cd5\uff0c\u8ba9\u4e00\u90e8\u5206\u7f16\u8bd1\u4fe1\u606f\u5728\u751f\u6210\u9636\u6bb5\u81ea\u52a8\u5b8c\u6210\uff0c\u65e0\u9700\u5728\u914d\u7f6e\u9636\u6bb5\u8bbe\u7f6e\uff0c\u793a\u4f8b\u5982\u4e0b\uff1a</p> <pre><code># \u73b0\u8ba1\u5212\u7ed9 Debug \u548c Release \u4e24\u79cd\u6784\u5efa\u7c7b\u578b\u6dfb\u52a0\u4e0d\u540c\u7684\u7f16\u8bd1\u9009\u9879\nset(CMAKE_C_FLAGS_DEBUG \"${CMAKE_C_FLAGS_DEBUG} -g -O0\")\nset(CMAKE_CXX_FLAGS_DEBUG \"${CMAKE_CXX_FLAGS_DEBUG} -g -O0\")\nset(CMAKE_C_FLAGS_RELEASE \"${CMAKE_C_FLAGS_RELEASE} -O2\")\nset(CMAKE_CXX_FLAGS_RELEASE \"${CMAKE_CXX_FLAGS_RELEASE} -O2\")\n\n# \u4f7f\u7528\u751f\u6210\u5668\u8868\u8fbe\u5f0f\u53ef\u4ee5\u7b80\u5316\u6210\nadd_compile_options(\n  $&lt;$&lt;CONFIG:Debug&gt;:-g -O0&gt;\n  $&lt;$&lt;CONFIG:Release&gt;:-O2&gt;\n)\n</code></pre> <p>\u8fd9\u91cc\u7684 <code>add_compile_options</code> \u5c31\u5c5e\u4e8e\u5728\u751f\u6210\u9636\u6bb5\u751f\u6548\u7684\u547d\u4ee4\u3002\u4ee5\u4e0a\u4ee3\u7801\u5c5e\u4e8e==\u6761\u4ef6\u5b9a\u4e49==\uff0c\u5373\u5728\u4e0d\u540c\u7684\u6761\u4ef6\u4e0b\u751f\u6210\u4e0d\u540c\u7684\u53d8\u91cf\u3001\u5b8f\u7b49\u5185\u5bb9\u3002\u5176\u4e2d\u8fd9\u6bb5\u4ee3\u7801\u4f7f\u7528\u751f\u6210\u5668\u8868\u8fbe\u5f0f\u7684\u6548\u679c\u662f\uff0c\u5728\u4e0d\u540c\u7684\u6784\u5efa\u7c7b\u578b\u4e0b\uff08Debug\u3001Release\uff09\uff0c\u4f1a\u751f\u6210\u4e0d\u540c\u7684\u88ab\u6dfb\u52a0\u8fdb\u7f16\u8bd1\u9009\u9879\u7684\u5b57\u7b26\u4e32\u3002</p>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/09-%E7%94%9F%E6%88%90%E5%99%A8%E8%A1%A8%E8%BE%BE%E5%BC%8F/#2","title":"2. \u5e38\u7528\u751f\u6210\u5668\u8868\u8fbe\u5f0f","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/09-%E7%94%9F%E6%88%90%E5%99%A8%E8%A1%A8%E8%BE%BE%E5%BC%8F/#21","title":"2.1 \u5e03\u5c14\u751f\u6210\u5668\u8868\u8fbe\u5f0f","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/09-%E7%94%9F%E6%88%90%E5%99%A8%E8%A1%A8%E8%BE%BE%E5%BC%8F/#211","title":"2.1.1 \u903b\u8f91\u8fd0\u7b97\u7b26","text":"<ol> <li><code>$&lt;BOOL:string&gt;</code></li> </ol> <p>\u5982\u679c\u5b57\u7b26\u4e32\u4e3a\u7a7a\u3001<code>0</code>\u3001\u4e0d\u533a\u5206\u5927\u5c0f\u5199\u7684<code>FALSE</code>\u3001<code>OFF</code>\u3001<code>N</code>\u3001<code>NO</code>\u3001<code>IGNORE</code>\u3001<code>NOTFOUND</code>\uff0c\u6216\u8005\u533a\u5206\u5927\u5c0f\u5199\u7684\u4ee5<code>-NOTFOUND</code>\u7ed3\u5c3e\u7684\u5b57\u7b26\u4e32\uff0c\u5219\u8868\u8fbe\u5f0f\u7684\u503c\u4e3a<code>0</code>\uff0c\u5426\u5219\u4e3a<code>1</code></p> <pre><code>add_library(mylib ${SOURCES})\n\ntarget_compile_definitions(mylib PUBLIC\n  $&lt;$&lt;BOOL:${USE_OTHERLIB}&gt;:USE_OTHERLIB&gt;\n)\n</code></pre> <p>\u5728\u8fd9\u4e2a\u4f8b\u5b50\u4e2d\uff0c<code>$&lt;BOOL:${USE_OTHERLIB}&gt;</code> \u4f1a\u68c0\u67e5\u53d8\u91cf <code>USE_OTHERLIB</code> \u662f\u5426\u4e3a\u5047\u3002\u5982\u679c <code>USE_OTHERLIB</code> \u4e3a\u5047\uff0c\u90a3\u4e48\u8fd9\u4e2a\u8868\u8fbe\u5f0f\u5c31\u4f1a\u8fd4\u56de <code>0</code>\uff0c\u5426\u5219\u8fd4\u56de <code>1</code>\u3002\u7136\u540e\uff0c<code>$&lt;1:USE_OTHERLIB&gt;</code> \u4f1a\u5728\u524d\u9762\u7684\u8868\u8fbe\u5f0f\u4e3a\u771f\u65f6\u6dfb\u52a0\u4e00\u4e2a\u7f16\u8bd1\u5b9a\u4e49 <code>USE_OTHERLIB</code>\u3002</p> <ol> <li><code>$&lt;AND:conditions&gt;</code>\uff1a\u903b\u8f91\u4e0e</li> </ol> <p><code>conditons</code>\u662f\u4ee5\u9017\u53f7\u5206\u5272\u7684==\u6761\u4ef6\u5217\u8868==\uff0c\u4e00\u822c\u6765\u8bf4\uff0c\u6761\u4ef6\u662f\u5217\u8868\u7684\uff0c\u90fd\u662f\u4f7f\u7528\u9017\u53f7\u8fdb\u884c\u5206\u5272\uff0c\u540e\u6587\u4e0d\u518d\u8d58\u8ff0\u3002\u903b\u8f91\u8fd0\u7b97\u6761\u4ef6\u6210\u7acb\uff0c\u8868\u8fbe\u5f0f\u7684\u503c\u4e3a<code>0</code>\uff0c\u5426\u5219\u4e3a<code>1</code>\uff0c\u540e\u6587\u4e0d\u518d\u8d58\u8ff0\u3002</p> <pre><code>add_library(mylib ${SOURCES})\n\ntarget_compile_definitions(mylib PUBLIC\n  $&lt;$&lt;AND:$&lt;CONFIG:Debug&gt;,$&lt;TARGET_EXISTS:otherlib&gt;&gt;:USE_OTHERLIB&gt;\n)\n</code></pre> <p>\u5728\u8fd9\u4e2a\u4f8b\u5b50\u4e2d\uff0c<code>$&lt;AND:$&lt;CONFIG:Debug&gt;,$&lt;TARGET_EXISTS:otherlib&gt;&gt;</code>\u4f1a\u5728\u5f53\u524d\u914d\u7f6e\u4e3a<code>Debug</code>\u5e76\u4e14\u76ee\u6807 <code>otherlib</code> \u5b58\u5728\u65f6\u8fd4\u56de<code>1</code>\uff0c\u5426\u5219\u8fd4\u56de<code>0</code>\u3002\u7136\u540e\uff0c<code>$&lt;1:USE_OTHERLIB&gt;</code> \u4f1a\u5728\u524d\u9762\u7684\u8868\u8fbe\u5f0f\u4e3a\u771f\u65f6\u6dfb\u52a0\u4e00\u4e2a\u7f16\u8bd1\u5b9a\u4e49 <code>USE_OTHERLIB</code>\u3002</p> <ol> <li><code>$&lt;OR:conditions&gt;</code>\uff1a\u903b\u8f91\u6216</li> </ol> <p>\u5728\u7ed9\u5b9a\u7684\u4efb\u4f55\u6761\u4ef6\u4e3a\u771f\u65f6\u8fd4\u56de<code>1</code>\uff0c\u5426\u5219\u8fd4\u56de<code>0</code></p> <pre><code>add_library(mylib ${SOURCES})\n\ntarget_compile_definitions(mylib PUBLIC\n  $&lt;$&lt;OR:$&lt;CONFIG:Debug&gt;,$&lt;TARGET_EXISTS:otherlib&gt;&gt;:USE_OTHERLIB&gt;\n)\n</code></pre> <p>\u5728\u8fd9\u4e2a\u4f8b\u5b50\u4e2d\uff0c<code>$&lt;OR:$&lt;CONFIG:Debug&gt;,$&lt;TARGET_EXISTS:otherlib&gt;&gt;</code>\u4f1a\u5728\u5f53\u524d\u914d\u7f6e\u4e3a Debug \u6216\u8005\u76ee\u6807 <code>otherlib</code> \u5b58\u5728\u65f6\u8fd4\u56de 1\uff0c\u5426\u5219\u8fd4\u56de 0\u3002\u7136\u540e\uff0c<code>$&lt;1:USE_OTHERLIB&gt;</code> \u4f1a\u5728\u524d\u9762\u7684\u8868\u8fbe\u5f0f\u4e3a\u771f\u65f6\u6dfb\u52a0\u4e00\u4e2a\u7f16\u8bd1\u5b9a\u4e49 <code>USE_OTHERLIB</code>\u3002</p> <ol> <li><code>$&lt;NOT:condition&gt;</code>\uff1a\u903b\u8f91\u975e</li> </ol> <p>\u5728\u7ed9\u5b9a\u7684\u6761\u4ef6\u4e3a\u5047\u65f6\u8fd4\u56de<code>1</code>\uff0c\u5426\u5219\u8fd4\u56de<code>0</code></p> <pre><code>add_library(mylib ${SOURCES})\n\ntarget_compile_definitions(mylib PUBLIC\n  $&lt;$&lt;NOT:$&lt;TARGET_EXISTS:otherlib&gt;&gt;:USE_OTHERLIB&gt;\n)\n</code></pre> <p>\u5728\u8fd9\u4e2a\u4f8b\u5b50\u4e2d\uff0c<code>$&lt;NOT:$&lt;TARGET_EXISTS:otherlib&gt;&gt;</code>\u4f1a\u5728\u76ee\u6807<code>otherlib</code>\u4e0d\u5b58\u5728\u65f6\u8fd4\u56de<code>1</code>\uff0c\u5426\u5219\u8fd4\u56de<code>0</code>\u3002\u7136\u540e\uff0c<code>$&lt;1:USE_OTHERLIB&gt;</code> \u4f1a\u5728\u524d\u9762\u7684\u8868\u8fbe\u5f0f\u4e3a\u771f\u65f6\u6dfb\u52a0\u4e00\u4e2a\u7f16\u8bd1\u5b9a\u4e49 <code>USE_OTHERLIB</code>\u3002</p>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/09-%E7%94%9F%E6%88%90%E5%99%A8%E8%A1%A8%E8%BE%BE%E5%BC%8F/#212","title":"2.1.2 \u5b57\u7b26\u4e32\u6bd4\u8f83","text":"<ol> <li><code>$&lt;STREQUAL:string1,string2&gt;</code></li> </ol> <p>\u5224\u65ad\u5b57\u7b26\u4e32\u662f\u5426\u76f8\u7b49</p> <ol> <li><code>$&lt;EQUAL:value1,value2&gt;</code></li> </ol> <p>\u5224\u65ad\u6570\u503c\u662f\u5426\u76f8\u7b49</p> <ol> <li><code>$&lt;IN_LIST:string,list&gt;</code></li> </ol> <p>\u5224\u65ad<code>string</code>\u662f\u5426\u5305\u542b\u5728<code>list</code>\u4e2d\uff0c<code>list</code>\u4f7f\u7528\u5206\u53f7\u5206\u5272</p> <p>::: warning \u8fd9\u91cc\u7684<code>list</code>\u662f\u5728\u9017\u53f7\u540e\u9762\u7684\u5217\u8868\uff0c\u5373<code>${...}</code>\u6240\u8868\u793a\u7684\u5185\u5bb9\uff0c\u56e0\u6b64\u5176\u5185\u5bb9\u9700\u8981\u4f7f\u7528\u5206\u53f7\u5206\u5272\u3002 :::</p>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/09-%E7%94%9F%E6%88%90%E5%99%A8%E8%A1%A8%E8%BE%BE%E5%BC%8F/#213","title":"2.1.3 \u53d8\u91cf\u67e5\u8be2","text":"<ol> <li><code>$&lt;TARGET_EXISTS:target&gt;</code></li> </ol> <p>\u5224\u65ad\u76ee\u6807\u662f\u5426\u5b58\u5728</p> <ol> <li><code>$&lt;CONFIG:cfgs&gt;</code></li> </ol> <p>\u5224\u65ad\u7f16\u8bd1\u7c7b\u578b\u914d\u7f6e\u662f\u5426\u5305\u542b\u5728<code>cfgs</code>\u5217\u8868\uff08\u6bd4\u5982\"Release\uff0cDebug\"\uff09\u4e2d\uff1b\u4e0d\u533a\u5206\u5927\u5c0f\u5199</p> <ol> <li><code>$&lt;PLATFORM_ID:platform_ids&gt;</code></li> </ol> <p>\u5224\u65adCMake\u5b9a\u4e49\u7684\u5e73\u53f0ID\u662f\u5426\u5305\u542b\u5728<code>platform_ids</code>\u5217\u8868\u4e2d</p> <ol> <li><code>$&lt;COMPILE_LANGUAGE:languages&gt;</code></li> </ol> <p>\u5224\u65ad\u7f16\u8bd1\u8bed\u8a00\u662f\u5426\u5305\u542b\u5728<code>languages</code>\u5217\u8868\u4e2d</p>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/09-%E7%94%9F%E6%88%90%E5%99%A8%E8%A1%A8%E8%BE%BE%E5%BC%8F/#22","title":"2.2 \u5b57\u7b26\u4e32\u751f\u6210\u5668\u8868\u8fbe\u5f0f","text":"<p>\u4f7f\u7528\u751f\u6210\u5668\u8868\u8fbe\u5f0f\u7684\u4e3b\u8981\u76ee\u7684\u53ef\u80fd\u5c31\u662f\u56e0\u4e3a\u6b64\u529f\u80fd\u4e86\u3002\u6bd4\u5982 CMake \u5b98\u65b9\u7684\u4f8b\u5b50\uff1a\u57fa\u4e8e\u7f16\u8bd1\u5668 ID \u6307\u5b9ainclude\u76ee\u5f55\uff1a</p> <pre><code>include_directories(\"/usr/include/$&lt;CXX_COMPILER_ID&gt;/\")\n</code></pre> <p>\u6839\u636e\u7f16\u8bd1\u5668\u7684\u7c7b\u578b\uff0c<code>$&lt;CXX_COMPILER_ID&gt;</code>\u4f1a\u88ab\u66ff\u6362\u6210\u5bf9\u5e94\u7684ID\uff08\u6bd4\u5982\u201cGNU\u201d\u3001\u201cClang\u201d\uff09\u3002</p>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/09-%E7%94%9F%E6%88%90%E5%99%A8%E8%A1%A8%E8%BE%BE%E5%BC%8F/#221","title":"2.2.1 \u6761\u4ef6\u8868\u8fbe\u5f0f","text":"<ul> <li><code>$&lt;condition:true_string&gt;</code></li> </ul> <p>\u5982\u679c\u6761\u4ef6\u4e3a\u771f\uff0c\u5219\u7ed3\u679c\u4e3a<code>true_string</code>\uff0c\u5426\u5219\u4e3a\u7a7a</p> <ul> <li><code>$&lt;IF:condition,str1,str2&gt;</code></li> </ul> <p>\u5982\u679c\u6761\u4ef6\u4e3a\u771f\uff0c\u5219\u7ed3\u679c\u4e3a<code>str1</code>\uff0c\u5426\u5219\u4e3a<code>str2</code></p>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/09-%E7%94%9F%E6%88%90%E5%99%A8%E8%A1%A8%E8%BE%BE%E5%BC%8F/#222","title":"2.2.2 \u5b57\u7b26\u4e32\u8f6c\u6362","text":"<ul> <li><code>$&lt;LOWER_CASE:string&gt;</code></li> </ul> <p>\u5c06\u5b57\u7b26\u4e32\u8f6c\u4e3a\u5c0f\u5199</p> <pre><code>add_library(mylib ${SOURCES})\n\nset(TARGET_NAME \"MYLIB\")\n\ntarget_compile_definitions(mylib PUBLIC\n  TARGET_NAME=$&lt;LOWER_CASE:${TARGET_NAME}&gt;\n)\n</code></pre> <p>\u5728\u8fd9\u4e2a\u4f8b\u5b50\u4e2d\uff0c <code>$&lt;LOWER_CASE:${TARGET_NAME}&gt;</code>\u4f1a\u5c06<code>TARGET_NAME</code>\u53d8\u91cf\u7684\u503c\u8f6c\u6362\u4e3a\u5c0f\u5199\u3002\u7136\u540e\uff0c\u8fd9\u4e2a\u5c0f\u5199\u7684\u503c\u4f1a\u88ab\u8d4b\u7ed9\u7f16\u8bd1\u5b9a\u4e49 <code>TARGET_NAME</code>\u3002</p> <p>\u6240\u4ee5\uff0c<code>mylib</code> \u4f1a\u88ab\u7f16\u8bd1\u65f6\u5b9a\u4e49 <code>TARGET_NAME</code> \u4e3a <code>mylib</code>\u3002</p> <ul> <li><code>$&lt;UPPER_CASE:string&gt;</code>\uff0c\u5c06\u5b57\u7b26\u4e32\u8f6c\u4e3a\u5927\u5199</li> </ul> <p>\u751f\u6210\u5668\u8868\u8fbe\u5f0f\u79cd\u7c7b\u7e41\u591a\uff0c\u8fd9\u91cc\u4e0d\u518d\u4e00\u4e00\u5217\u4e3e</p>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/09-%E7%94%9F%E6%88%90%E5%99%A8%E8%A1%A8%E8%BE%BE%E5%BC%8F/#3","title":"3. \u6784\u5efa\u5b89\u88c5\u8868\u8fbe\u5f0f","text":"<p>\u8be5\u751f\u6210\u5668\u8868\u8fbe\u5f0f\u5c5e\u4e8e\u5b57\u7b26\u4e32\u751f\u6210\u5668\u8868\u8fbe\u5f0f\u7684\u4e00\u79cd\u3002\u8fd9\u4e2a\u95ee\u9898\u6765\u81ea\u4e8e\u301010\u3011\u9879\u76ee\u7684\u5bfc\u51fa\u4e0e\u5b89\u88c5\uff0c\u4f46\u4e0d\u770b\u5e76\u4e0d\u5f71\u54cd\u77e5\u8bc6\u70b9\u7684\u8bb2\u89e3\uff0c\u4e0b\u9762\u7ed9\u51fa\u8fd9\u4e2a\u95ee\u9898\u7684\u4ea7\u751f\u539f\u56e0\u3002</p>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/09-%E7%94%9F%E6%88%90%E5%99%A8%E8%A1%A8%E8%BE%BE%E5%BC%8F/#31","title":"3.1 \u95ee\u9898\u5f15\u51fa","text":"<p>\u5728\u5b89\u88c5\u5bfc\u51fa\u76ee\u6807\u7684\u65f6\u5019\uff0c\u5982\u679c\u5bfc\u51fa\u76ee\u6807\u4e2d\u5305\u542b\u7684\u76ee\u6807\u4f7f\u7528\u4e86 <code>target_include_directories</code> \u547d\u4ee4\uff0c\u4f8b\u5982</p> <pre><code>target_include_directories(\n  my_target PUBLIC include\n)\n</code></pre> <p>\u5219\u6267\u884c <code>cmake ..</code> \u7684\u64cd\u4f5c\u540e\u4f1a\u51fa\u73b0\u5f62\u5982</p> <pre><code>-- CMake Error in xxx/xxx/CMakeLists.txt:\n-- Target \"my_target\" INTERFACE_INCLUDE_DIRECTORIES property contains\n-- path:\n--  \n--   \"/xxx/xxx/include\"\n-- \n-- which is prefixed in the source directory.\n</code></pre> <p>\u7684\u95ee\u9898\uff0c\u8fd9\u8868\u793a\u5305\u542b\u76ee\u5f55\u5177\u6709\u7edd\u5bf9\u8def\u5f84\uff0c\u8fd9\u5176\u5b9e\u662f <code>install</code> \u6307\u5b9a\u7684\u5934\u6587\u4ef6\u5b89\u88c5\u8def\u5f84\uff08\u9ed8\u8ba4\u662f <code>/usr/local/include</code>\uff09\u4e0e <code>target_include_directories</code> \u6307\u5b9a\u7684\u8def\u5f84\uff08\u8fd9\u91cc\u662f\u90a3\u4e32\u7edd\u5bf9\u8def\u5f84 <code>/xxx/xxx/include</code>\uff09\u4e92\u76f8\u51b2\u7a81\u4e86</p>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/09-%E7%94%9F%E6%88%90%E5%99%A8%E8%A1%A8%E8%BE%BE%E5%BC%8F/#32","title":"3.2 \u89e3\u51b3\u65b9\u6cd5","text":"<p>\u6700\u4e3a\u6709\u6548\u4e14\u901a\u7528\u7684\u89e3\u51b3\u65b9\u6cd5\u662f\u4f7f\u7528\u5bfc\u51fa\u5b89\u88c5\u7684\u751f\u6210\u5668\u8868\u8fbe\u5f0f\uff0c\u6709 <code>$&lt;BUILD_INTERFACE&gt;:xxx</code> \u548c <code>$&lt;INSTALL_INTERFACE:xxx</code>\uff0c\u4e0b\u9762\u7ed9\u51fa\u4e00\u4e2a\u6bd4\u8f83\u5e38\u89c1\u7684\u793a\u4f8b\u3002</p> <pre><code>target_include_directories(\n  my_target PUBLIC\n  $&lt;BUILD_INTERFACE:${CMAKE_CURRENT_LIST_DIRS}/include&gt;\n  $&lt;INSTALL_INTERFACE:include/MyLibrary&gt;\n)\n</code></pre> <p>\u8fd9\u4e2a\u547d\u4ee4\u8868\u793a\uff0c\u5c06\u4e00\u7cfb\u5217\u5185\u5bb9\u4ee5\u516c\u5f00\u4f20\u64ad\u65b9\u5f0f\u5305\u542b\u4e8e\u76ee\u6807 <code>my_target</code> \u4e2d\uff0c\u8fd9\u91cc\u7684\u4e00\u7cfb\u5217\u5185\u5bb9\u5219\u662f\u4f1a\u6839\u636e\u5f53\u524d\u5904\u4e8e\u4f55\u79cd\u65b9\u5f0f\uff08==\u6784\u5efa==\u6216\u662f==\u5b89\u88c5==\uff09\u8fdb\u884c\u9009\u62e9\u3002<code>BUILD_INTERFACE</code> \u8868\u793a\u5728\u6784\u5efa\u65f6\u542f\u7528\uff0c<code>INSTALL_INTERFACE</code> \u8868\u793a\u5728\u5b89\u88c5\u65f6\u542f\u7528\u3002</p> <p>\u5047\u8bbe\u5bfc\u51fa\u76ee\u6807\u540d\u4e3a <code>MyModules</code>\uff0c\u53ef\u4ee5\u5728\u5b89\u88c5\u8def\u5f84 <code>&lt;path-to-install&gt;/cmake/MyModules.cmake</code> \u4e0b\u627e\u5230\u5982\u4e0b\u7c7b\u4f3c\u7684\u8bed\u53e5</p> <pre><code>set_target_properties(my_target PROPERTIES\n  INTERFACE_INCLUDE_DIRECTORIES \"${_IMPORT_PREFIX}/include/MyLibrary\"\n)\n</code></pre> <p>\u8fd9\u662f <code>INSTALL_INTERFACE</code> \u751f\u6210\u5668\u8868\u8fbe\u5f0f\u751f\u6548\u7684\u4ea7\u7269\u3002</p> <p>::: tip \u8865\u5145\u8bf4\u660e \u8fd9\u91cc\u5bf9\u4e0a\u6587\u51fa\u73b0\u7684\u4e09\u4e2a\u6807\u8bc6\u7b26\u505a\u4e2a\u7b80\u77ed\u7684\u4ecb\u7ecd - <code>my_target</code>\uff0c\u76ee\u6807\uff0c\u5305\u62ec\u4e8c\u8fdb\u5236\u76ee\u6807\u548c\u4f2a\u76ee\u6807\uff0c\u53ef\u53c2\u8003\u301005\u3011\u76ee\u6807\u6784\u5efa - <code>MyModules</code>\uff0c\u5bfc\u51fa\u76ee\u6807\uff0c\u53ef\u53c2\u8003\u301010\u3011\u9879\u76ee\u7684\u5bfc\u51fa\u4e0e\u5b89\u88c5 - <code>MyLibrary</code>\uff0c\u5305\u540d\uff0c\u4e00\u822c\u7528\u4e8e<code>find_package</code>\u3002\u53ef\u53c2\u8003\u301008\u3011find_package \u8be6\u89e3 :::</p>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/10-%E9%A1%B9%E7%9B%AE%E7%9A%84%E5%AF%BC%E5%87%BA%E4%B8%8E%E5%AE%89%E8%A3%85/","title":"\u301010\u3011\u9879\u76ee\u7684\u5bfc\u51fa\u4e0e\u5b89\u88c5","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/10-%E9%A1%B9%E7%9B%AE%E7%9A%84%E5%AF%BC%E5%87%BA%E4%B8%8E%E5%AE%89%E8%A3%85/#1","title":"1. \u524d\u8a00","text":"<p>\u5728\u301008\u3011find_package \u8be6\u89e3\u4e00\u6587\u4e2d\u6211\u4eec\u4e86\u89e3\u5230 <code>find_package</code> \u7684\u4e24\u79cd\u5de5\u4f5c\u65b9\u5f0f\uff0c\u7b2c\u4e00\u79cd\u7684 Module \u6a21\u5f0f\u9700\u8981\u6211\u4eec\u4e3a\u73b0\u6210\u7684\u7b2c\u4e09\u65b9\u5934\u6587\u4ef6\u5e93\u6587\u4ef6\u7f16\u5199 <code>FindXxx.cmake</code> \u4ece\u800c\u80fd\u591f\u4f7f\u7528 <code>find_package</code>\uff0c\u7b2c\u4e8c\u79cd\u7684 Config \u6a21\u5f0f\u5219\u662f\u6253\u5305\u9879\u76ee\u65f6\u91c7\u7528\u7684\u4e3b\u6d41\u65b9\u5f0f\uff0c\u5373\u901a\u8fc7\u7f16\u5199 <code>XxxConfig.cmake</code> \u6587\u4ef6\u6765\u4f7f\u7528 <code>find_package</code>\u3002\u5927\u591a\u6570\u5f00\u6e90\u9879\u76ee\uff0c\u82e5\u662f\u4f7f\u7528CMake\u63d0\u4f9b\u4e86\u7f16\u8bd1\u5b89\u88c5\u65b9\u5f0f\uff0c\u4e00\u5b9a\u4f1a\u6d89\u53ca\u5230\u8fd9\u4e00\u6587\u4ef6\uff0c\u4f8b\u5982 OpenCV \u7684 <code>cmake/templates</code> \u6587\u4ef6\u5939\u4e2d\u5c31\u6709 <code>OpenCVConfig.cmake.in</code> \u7684\u6a21\u677f\u6587\u4ef6\uff0c\u8fd9\u4e00\u6587\u4ef6\u5728CMake\u7684\u914d\u7f6e\u9636\u6bb5\u4f1a\u751f\u6210\u5bf9\u5e94\u7684 <code>OpenCVConfig.cmake</code> \u6587\u4ef6\u3002</p> <p>\u5bf9\u4e8e <code>XxxConfig.cmake</code> \u6587\u4ef6\u7684\u5199\u6cd5\u4f1a\u5728\u6700\u540e\u8fdb\u884c\u4ecb\u7ecd\uff0c\u5728\u4e00\u5f00\u59cb\u8ba9\u6211\u4eec\u5148\u4e86\u89e3\u4e00\u4e0b\u5b89\u88c5\u7684\u57fa\u672c\u547d\u4ee4\u3002</p>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/10-%E9%A1%B9%E7%9B%AE%E7%9A%84%E5%AF%BC%E5%87%BA%E4%B8%8E%E5%AE%89%E8%A3%85/#2","title":"2. \u6587\u4ef6\u3001\u76ee\u6807\u7684\u5b89\u88c5\u89c4\u5219","text":"<p>\u2014\u2014 <code>install</code> \u547d\u4ee4</p> <p>\u5728\u73b0\u4ee3 CMake \u4e2d\uff0c\u6240\u6709\u5185\u5bb9\u7684\u5b89\u88c5\uff0c\u5747\u6765\u81ea <code>install</code> \u547d\u4ee4\uff0c\u5305\u62ec\u6587\u4ef6\uff08\u5939\uff09\u3001\u4e8c\u8fdb\u5236\u76ee\u6807\u3001\u4f2a\u76ee\u6807\u4ee5\u53ca\u540e\u6587\u7684\u5bfc\u51fa\u76ee\u6807\u3002\u5728 <code>CMakeLists.txt</code> \u6587\u4ef6\u4e2d\u6dfb\u52a0\u4e86 <code>install</code> \u547d\u4ee4\u5e76\u4e0d\u4f1a\u76f4\u63a5\u6267\u884c\u5b89\u88c5\u64cd\u4f5c\uff0c\u5b9e\u9645\u4e0a <code>install</code> \u53ea\u662f\u7ed9\u51fa\u4e86\u5b89\u88c5\u7684\u89c4\u5219\uff0c\u5e76\u53d1\u751f\u5728\u751f\u6210\u9636\u6bb5\u3002\u53ef\u4ee5\u56de\u987e\u301001\u3011\u5b89\u88c5\u4e0e\u57fa\u672c\u4ecb\u7ecd\u7684\u5185\u5bb9\uff0cCMake \u7684\u4f5c\u7528\u662f\u751f\u6210\u5efa\u6784\u6863\uff0c\u800c\u9700\u8981\u5b89\u88c5\u7684\u5177\u4f53\u5185\u5bb9\u5c06\u4f1a\u751f\u6210\u5728\u8be5\u5efa\u6784\u6863\u4e2d\uff0c\u5982 Unix Makefile\u3002</p> <p>\u6211\u4eec\u53ef\u4ee5\u6267\u884c</p> <pre><code>cmake --install .\n</code></pre> <p>\u547d\u4ee4\uff0c\u5b8c\u6210\u5b9e\u9645\u7684\u5b89\u88c5\u64cd\u4f5c\u3002</p> <p>::: tip \u6b64\u5904\u53ea\u4ecb\u7ecd\u5177\u6709\u57fa\u672c\u6587\u4ef6\u7ed3\u6784\u7684\u5b89\u88c5\uff0c\u5bfc\u51fa\u76ee\u6807\u7684\u5b89\u88c5\u5728\u4e0b\u4e00\u8282\u8fdb\u884c\u4ecb\u7ecd\u3002 :::</p>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/10-%E9%A1%B9%E7%9B%AE%E7%9A%84%E5%AF%BC%E5%87%BA%E4%B8%8E%E5%AE%89%E8%A3%85/#21","title":"2.1 \u6587\u4ef6\u5b89\u88c5","text":"<p>\u5373\uff1a<code>install(FILES)</code></p> <p>\u8fd9\u91cc\u5148\u76f4\u63a5\u7ed9\u51fa\u6587\u4ef6\u5b89\u88c5\u7684 <code>install</code> \u547d\u4ee4\u7528\u6cd5\uff0c\u4e0b\u9762\u5217\u4e3e\u4e00\u4e9b\u5e38\u89c1\u7684\u53ef\u9009\u5185\u5bb9\u3002</p> <ul> <li><code>DESTINATION</code>\uff1a\u6307\u5b9a\u8981\u5b89\u88c5\u5230\u7684\u76ee\u6807\u76ee\u5f55\u3002</li> <li><code>PERMISSIONS</code>\uff1a\u6307\u5b9a\u8981\u5b89\u88c5\u6587\u4ef6\u7684\u6743\u9650\uff0c\u6743\u9650\u53c2\u6570\u8981\u6c42\u662f\u4e00\u7cfb\u5217 <code>OWNER_*</code>\u3001<code>GROUP_*</code> \u548c <code>WORLD_*</code> \u6743\u9650\u503c\u7684\u7ec4\u5408\uff0c\u4f8b\u5982 <code>OWNER_WRITE OWNER_READ GROUP_READ WORLD_READ</code>\u3002</li> <li><code>CONFIGURATIONS</code>\uff1a\u6307\u5b9a\u8981\u5728\u54ea\u4e9b\u6784\u5efa\u914d\u7f6e\u4e0b\u5b89\u88c5\u6587\u4ef6\u3002\u53ef\u4ee5\u4f7f\u7528\u4e00\u4e2a\u6216\u591a\u4e2a\u6784\u5efa\u914d\u7f6e\u7684\u540d\u79f0\u6765\u9650\u5b9a\u3002</li> <li><code>COMPONENT</code>\uff1a\u6307\u5b9a\u8981\u5c06\u6587\u4ef6\u5f52\u7c7b\u5230\u7684\u7ec4\u4ef6\u540d\u79f0\uff0c\u4ee5\u4fbf\u4e8e\u540e\u7eed\u8fdb\u884c\u7ba1\u7406\u548c\u6253\u5305\uff08\u89c1\u301013\u3011CPack\uff09\u3002</li> <li><code>RENAME</code>\uff1a\u6307\u5b9a\u5728\u5b89\u88c5\u65f6\u91cd\u547d\u540d\u6587\u4ef6\u6216\u76ee\u5f55\u7684\u540d\u79f0\u3002</li> <li><code>OPTIONAL</code>\uff1a\u8868\u793a\u5982\u679c\u6587\u4ef6\u4e0d\u5b58\u5728\u5219\u4e0d\u4f1a\u629b\u51fa\u9519\u8bef\u3002</li> </ul> <pre><code># \u5b9a\u4e49\u4e8e &lt;path-to-opencv&gt;/include/CMakeLists.txt \u4e2d\n\ninstall(FILES \"opencv2/opencv.hpp\"\n    DESTINATION ${OPENCV_INCLUDE_INSTALL_PATH}/opencv2\n    COMPONENT dev)\n</code></pre> <p>\u8fd9\u53e5\u547d\u4ee4\u6dfb\u52a0\u4e86\u5c06\u5355\u4e00\u6587\u4ef6 <code>opencv2/opencv.hpp</code> \u5b89\u88c5\u5230\u6307\u5b9a\u76ee\u5f55\u7684\u5b89\u88c5\u89c4\u5219\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u662f <code>/usr/local/include/opencv4/opencv2</code> \u4e2d\uff0c\u5e76\u5f52\u7c7b\u5230 <code>dev</code> \u7ec4\u4ef6\u7684\u5b89\u88c5\u89c4\u5219\u4e2d\uff0c\u5728\u6267\u884c <code>cmake --install .</code> \u547d\u4ee4\u7684\u65f6\u5019\u4f1a\u6267\u884c\u8be5\u5b89\u88c5\u64cd\u4f5c\u3002</p> <p>\u5176\u4f59\u53ef\u9009\u5185\u5bb9\u5982 <code>RENAME</code> \u7528\u6cd5\u4e0e\u4e0a\u6587\u7ed9\u51fa\u7684\u4f8b\u5b50\u7c7b\u4f3c\u3002</p>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/10-%E9%A1%B9%E7%9B%AE%E7%9A%84%E5%AF%BC%E5%87%BA%E4%B8%8E%E5%AE%89%E8%A3%85/#22","title":"2.2 \u76ee\u5f55\uff08\u6587\u4ef6\u5939\uff09\u5b89\u88c5","text":"<p>\u5373 <code>install(DIRECTORY)</code></p> <p>\u4f7f\u7528\u65b9\u5f0f\u4e0e\u6587\u4ef6\u5b89\u88c5\u57fa\u672c\u4e00\u81f4\uff0c\u4f46\u76f8\u6bd4\u4e8e\u6587\u4ef6\u5b89\u88c5\uff0c\u4e3b\u8981\u591a\u51fa\u4e86 <code>PATTERN</code>\u3001<code>EXCLUDE_PATTERN</code> \u548c <code>RECURSE</code> \u5173\u952e\u5b57\uff0c\u901a\u8fc7 <code>PATTERN</code> \u548c <code>EXCLUDE_PATTERN</code> \u53c2\u6570\u6307\u5b9a\u8981\u5305\u542b\u548c\u6392\u9664\u7684\u6587\u4ef6\uff0c\u4f7f\u7528 <code>RECURSE</code> \u53c2\u6570\u8fdb\u884c\u9012\u5f52\u5b89\u88c5\u3002\u4e0b\u9762\u7ed9\u51fa\u4e00\u4e2a\u7b80\u5355\u7684\uff0cOpenCV \u4e2d\u5b89\u88c5\u6587\u6863\u6240\u5728\u6587\u4ef6\u5939\u7684\u4f8b\u5b50\u3002</p> <pre><code># \u5b9a\u4e49\u4e8e &lt;path-to-opencv&gt;/doc/CMakeLists.txt \u4e2d\n\ninstall(DIRECTORY ${CMAKE_CURRENT_BINARY_DIR}/doxygen/html\n  DESTINATION \"${OPENCV_DOC_INSTALL_PATH}\"\n  COMPONENT \"docs\" OPTIONAL\n  ${compatible_MESSAGE_NEVER} # \u53ef\u4ee5\u4e0d\u7528\u7ba1\u8fd9\u53e5\u8bdd\n)\n</code></pre> <p>\u8fd9\u53e5\u547d\u4ee4\u5c06\u5f53\u524d\u4e8c\u8fdb\u5236\u751f\u6210\u76ee\u5f55\u4e2d\u7684 <code>doxygen/html</code> \u6587\u4ef6\u5939\u5b89\u88c5\u5230 <code>${OPENCV_DOC_INSTALL_PATH}</code> \u4e2d\uff0c\u5e76\u5f52\u7c7b\u5230 <code>docs</code> \u4e2d\uff0c<code>OPTIONAL</code> \u8bf4\u660e\u4e86\u5373\u4f7f\u8fd9\u4e2a\u76ee\u5f55\u4e0d\u5b58\u5728\uff0c\u4e5f\u4e0d\u4f1a\u629b\u51fa\u5b89\u88c5\u7684\u9519\u8bef\u3002\u540c\u6837\uff0c\u9700\u8981\u5728\u7ec8\u7aef\u6267\u884c <code>cmake --install .</code> \u547d\u4ee4\u4ee5\u5b8c\u6210\u5b89\u88c5\u3002</p>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/10-%E9%A1%B9%E7%9B%AE%E7%9A%84%E5%AF%BC%E5%87%BA%E4%B8%8E%E5%AE%89%E8%A3%85/#23","title":"2.3 \u76ee\u6807\u5b89\u88c5","text":"<p>\u5373 <code>install(TARGETS)</code>\uff0c\u5148\u7ed9\u51fa\u76ee\u6807\u5b89\u88c5\u7684\u7b7e\u540d</p> <pre><code>install(TARGETS &lt;target&gt;... [EXPORT &lt;export-name&gt;]\n        [RUNTIME_DEPENDENCIES &lt;arg&gt;...|RUNTIME_DEPENDENCY_SET &lt;set-name&gt;]\n        [&lt;artifact-option&gt;...]\n        [&lt;artifact-kind&gt; &lt;artifact-option&gt;...]...\n        [INCLUDES DESTINATION [&lt;dir&gt; ...]]\n        )\n</code></pre> <p>\u7528\u6cd5\u4e0e\u6587\u4ef6\u3001\u6587\u4ef6\u5939\u5b89\u88c5\u57fa\u672c\u4e00\u81f4\uff0c\u4f46\u7531\u4e8e CMake \u4e2d\u7684\u76ee\u6807\u4e0d\u4ec5\u4ec5\u5305\u542b\u52a8\u6001\u3001\u9759\u6001\u5e93\uff0c\u4e5f\u6709\u53ef\u6267\u884c\u6587\u4ef6\uff0c\u4e5f\u6709\u63a5\u53e3\u5e93\u3001\u5bfc\u5165\u5e93\u7b49\u4f2a\u76ee\u6807\uff0c\u56e0\u6b64 CMake \u76ee\u6807\u5b89\u88c5\u662f\u4e2a\u5e7f\u6cdb\u7684\u6982\u5ff5\uff0c\u63a5\u53e3\u4e0a\u4e5f\u80fd\u9002\u914d\u591a\u79cd\u76ee\u6807\u7684\u5b89\u88c5\uff0c\u4f8b\u5982\u4ee5\u4e0b\u547d\u4ee4</p> <pre><code>install(\n  TARGETS my_target\n  LIBRARY DESTINATION lib\n  ARCHIVE DESTINATION lib\n  RUNTIME DESTINATION bin\n)\n</code></pre> <p>\u5148\u6765\u8003\u8651\u4e8c\u8fdb\u5236\u76ee\u6807\u7684\u60c5\u51b5</p> <ul> <li><code>LIBRARY</code> \u6307\u4ee3\u7684\u662f Unix \u6587\u4ef6\u7cfb\u7edf\u7684\u5171\u4eab\u5e93</li> <li><code>ARCHIVE</code> \u6307\u4ee3\u7684\u662f Unix \u6587\u4ef6\u7cfb\u7edf\u7684\u9759\u6001\u5e93\uff0c\u4ee5\u53ca Windows \u4e0b\u7684\u9759\u6001\u94fe\u63a5\u5e93\u548c\u5bfc\u5165\u5e93</li> <li><code>RUNTIME</code> \u6307\u4ee3\u7684\u662f\u53ef\u6267\u884c\u6587\u4ef6\u4ee5\u53ca Windows \u4e0b\u7684\u52a8\u6001\u94fe\u63a5\u5e93</li> </ul> <p>\u5f53 <code>my_target</code> \u662f\u666e\u901a\u5e93\u76ee\u6807\u65f6\uff0c\u5728 Linux \u4e0b\uff0c\u5bf9\u5e94\u7684 <code>*.so</code> \u6216 <code>*.a</code> \u76ee\u6807\u4f1a\u88ab\u5b89\u88c5\u81f3 <code>&lt;prefix&gt;/lib</code> \u4e0b\uff0c\u540c\u6837\uff0c\u5728 Windows \u4e0b\uff0c\u5bf9\u5e94\u7684 <code>*.dll</code> \u548cDLL\u5bfc\u5165\u5e93 <code>*.lib</code> \u4e5f\u4f1a\u88ab\u5b89\u88c5\u5230 <code>&lt;prefix&gt;/lib</code> \u4e0b\u3002\u5f53 <code>my_target</code> \u662f\u53ef\u6267\u884c\u6587\u4ef6\u65f6\uff0c\u4f1a\u88ab\u5b89\u88c5\u5230 <code>&lt;prefix&gt;/bin</code> \u4e0b</p>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/10-%E9%A1%B9%E7%9B%AE%E7%9A%84%E5%AF%BC%E5%87%BA%E4%B8%8E%E5%AE%89%E8%A3%85/#3","title":"3. \u5bfc\u51fa\u76ee\u6807\u7684\u5b89\u88c5\u89c4\u5219","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/10-%E9%A1%B9%E7%9B%AE%E7%9A%84%E5%AF%BC%E5%87%BA%E4%B8%8E%E5%AE%89%E8%A3%85/#31","title":"3.1 \u4f55\u4e3a\u5bfc\u51fa\u76ee\u6807\u3001\u5bfc\u51fa\u914d\u7f6e","text":"<p>\u5728\u301005\u3011\u76ee\u6807\u6784\u5efa #2.4\u6211\u4eec\u4ecb\u7ecd\u8fc7 <code>IMPORTED</code> \u5bfc\u5165\u76ee\u6807\u7684\u6982\u5ff5\uff0c\u867d\u7136 <code>IMPORTED</code> \u76ee\u6807\u672c\u8eab\u5f88\u6709\u7528\uff0c\u4f46\u6211\u4eec\u4ecd\u7136\u9700\u8981\u77e5\u9053\u8fd9\u4e9b <code>IMPORTED</code> \u76ee\u6807\u6240\u6307\u4ee3\u6216\u8005\u5305\u542b\u7684\u6587\u4ef6\u5728\u78c1\u76d8\u4e0a\u7684\u4f4d\u7f6e\u3002 <code>IMPORTED</code> \u76ee\u6807\u7684\u771f\u6b63\u5f3a\u5927\u4e4b\u5904\u5728\u4e8e\uff0c\u5f53\u63d0\u4f9b\u76ee\u6807\u6587\u4ef6\u7684\u9879\u76ee\u8ba1\u5212\u63d0\u4f9b\u4e00\u4e2a CMake \u6587\u4ef6\u6765\u5e2e\u52a9\u5bfc\u5165\u5b83\u4eec\u65f6\uff0c\u53ef\u4ee5\u8bbe\u7f6e\u9879\u76ee\u4ee5\u751f\u6210\u5fc5\u8981\u7684\u4fe1\u606f\uff0c\u4ee5\u4fbf\u5176\u4ed6 CMake \u9879\u76ee\u53ef\u4ee5\u8f7b\u677e\u5730\u4f7f\u7528\u5b83\uff0c\u8fd9\u4e00\u5fc5\u8981\u7684\u4fe1\u606f\u5c31\u662f\u6240\u8c13\u7684\u5bfc\u51fa\u76ee\u6807\u3002</p> <p>\u5728\u5f00\u53d1\u5b8c\u4e00\u4e2a\u5e93\u7684\u65f6\u5019\uff0c\u9700\u8981\u5c06\u5176\u6253\u5305\u7ed9\u4ed6\u4eba\u4f7f\u7528\uff08\u6ce8\u610f\u4e0d\u662f\u6253\u5305\u8ba9\u4ed6\u4eba\u6e90\u7801\u7f16\u8bd1\uff0c\u800c\u662f\u76f4\u63a5\u62ff\u6765\u7528\uff09\uff0c\u6211\u4eec\u9700\u8981\u63d0\u4f9b\u4e00\u4e2a\u5305\u542b\u8fd9\u4e2a\u5e93\u91cc\u9762\u6240\u6709\u5f85\u5bfc\u51fa\u76ee\u6807\u4fe1\u606f\u7684 <code>*.cmake</code> \u6587\u4ef6\uff0c\u79f0\u4e3a\u5bfc\u51fa\u914d\u7f6e\u6587\u4ef6\u3002\u8be5\u6587\u4ef6\u6b63\u662f\u5728 CMake \u7684\u751f\u6210\u9636\u6bb5\u7531\u5bfc\u51fa\u76ee\u6807\u751f\u6210\u7684\u3002\u4e0d\u8fc7\uff0c\u8fd9\u4e00\u6587\u4ef6\u6211\u4eec\u5e76\u4e0d\u4f1a\u76f4\u63a5\u4f7f\u7528\uff0c\u800c\u662f\u95f4\u63a5\u7684\u901a\u8fc7\u4f7f\u7528 <code>XxxConfig.cmake</code> \u7684\u65b9\u5f0f\u4f7f\u7528\u8be5\u5bfc\u51fa\u76ee\u6807\u5bf9\u5e94\u7684 <code>*.cmake</code> \u5bfc\u51fa\u914d\u7f6e\u6587\u4ef6\u3002\u6211\u4eec\u5148\u56de\u5230\u6700\u57fa\u672c\u7684\uff0c\u5982\u4f55\u6dfb\u52a0\u5bfc\u51fa\u76ee\u6807\u548c\u751f\u6210\u5bfc\u51fa\u914d\u7f6e\u6587\u4ef6\u3002</p>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/10-%E9%A1%B9%E7%9B%AE%E7%9A%84%E5%AF%BC%E5%87%BA%E4%B8%8E%E5%AE%89%E8%A3%85/#32","title":"3.2 \u57fa\u672c\u8bed\u6cd5","text":"<p>\u9996\u5148\u6211\u4eec\u9700\u8981\u6307\u5b9a\u54ea\u4e9b\u76ee\u6807\u9700\u8981\u5bfc\u51fa\uff0c\u5e76\u4e14\u8bbe\u7f6e\u5bfc\u51fa\u76ee\u6807\u7684\u540d\u79f0\uff0c\u5047\u8bbe\u8fd8\u662f\u4e0a\u6587\u7684 <code>my_target</code> \u76ee\u6807\uff0c\u6211\u4eec\u5728\u4f7f\u7528 <code>install</code> \u547d\u4ee4\u65f6\u53ef\u4ee5\u6307\u5b9a <code>EXPORT</code>\uff0c\u5373</p> <pre><code>install(\n  TARGETS my_target\n  EXPORT MyModules\n  LIBRARY DESTINATION lib\n  ARCHIVE DESTINATION lib\n  RUNTIME DESTINATION bin\n)\n</code></pre> <p>::: warning <code>EXPORT</code> \u5fc5\u987b\u5728 <code>TARGETS</code> \u4e4b\u540e\uff0c<code>[&lt;artifact-option&gt;...]</code> \u4e4b\u524d\uff0c\u5982\u7b7e\u540d\u7684\u8981\u6c42\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u5982\u679c\u5199\u6210</p> <pre><code>install(\n  EXPORT MyModules\n  TARGETS my_target\n)\n</code></pre> <p>\u6216\u8005</p> <pre><code>install(\n  TARGETS my_target\n  LIBRARY DESTINATION lib\n  EXPORT MyModules\n)\n</code></pre> <p>\u90fd\u662f\u9519\u8bef\u7684\u5199\u6cd5\uff0c\u5728 CMake \u914d\u7f6e\u671f\u95f4\u4f1a\u62a5\u9519\u3002 :::</p> <p>\u8fd9\u91cc\u7684 <code>MyModules</code> \u5c31\u662f\u5bfc\u51fa\u76ee\u6807\u540d\uff0c\u5e76\u4e14\u8be5\u5bfc\u51fa\u76ee\u6807\u5305\u542b\u4e86\u5173\u4e8e <code>my_target</code> \u7684\u6240\u6709\u4fe1\u606f\uff0c\u5305\u62ec\u5934\u6587\u4ef6\u8def\u5f84\u3001\u5e93\u6587\u4ef6\u8def\u5f84\u7b49\u5185\u5bb9\u3002\u5982\u679c\u6211\u5728\u6b64\u4e4b\u4e0a\u7ee7\u7eed\u5199\u5165</p> <pre><code>install(\n  TARGETS my_target_2\n  EXPORT MyModules\n  LIBRARY DESTINATION lib\n  ARCHIVE DESTINATION lib\n)\n</code></pre> <p>\u5219\u6b64\u65f6\u5bfc\u51fa\u76ee\u6807 <code>MyModules</code> \u5305\u542b\u4e86\u4e24\u4e2a\u76ee\u6807\u7684\u5185\u5bb9\uff0c\u5373 <code>my_target</code> \u548c <code>my_target_2</code>\u3002</p> <p>\u6700\u540e\u9700\u8981\u5c06\u8be5\u5bfc\u51fa\u76ee\u6807\u8f6c\u6362\u4e3a\u5bf9\u5e94\u7684 <code>*.cmake</code> \u6587\u4ef6\uff0c\u5373\u6307\u5b9a\u5bfc\u51fa\u76ee\u6807\u7684\u5b89\u88c5\u7b56\u7565\uff0c\u8bed\u6cd5\u91c7\u7528 <code>install(EXPORTS)</code></p> <pre><code>install(\n  EXPORT MyModules\n  FILE MyModules.cmake\n  DESTINATION \"lib/cmake/${PROJECT_NAME}\" # \u4e00\u822c\u5b89\u88c5\u8def\u5f84\u4f1a\u8bbe\u7f6e\u5728\u6b64\u5904\n)\n</code></pre> <p>\u5982\u679c\u4e0d\u989d\u5916\u6307\u5b9a OpenCV \u7684\u5b89\u88c5\u8def\u5f84\uff0c\u53ef\u4ee5\u5728 <code>/usr/local/lib/cmake/opencv4</code> \u4e0b\u627e\u5230 <code>OpenCVModules.cmake</code> \u4ee5\u53ca <code>OpenCVModules-release.cmake</code>\u8fd9\u4e24\u4e2a\u6587\u4ef6\uff0c\u8fd9\u4e2a\u5c31\u662f OpenCV \u7684\u5bfc\u51fa\u914d\u7f6e\u6587\u4ef6\u3002</p>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/10-%E9%A1%B9%E7%9B%AE%E7%9A%84%E5%AF%BC%E5%87%BA%E4%B8%8E%E5%AE%89%E8%A3%85/#33","title":"3.3 \u5bfc\u51fa\u914d\u7f6e\u6587\u4ef6\u7684\u57fa\u672c\u5185\u5bb9","text":"<p>\u6211\u4eec\u5c31\u4ee5 OpenCV 4.8.0 \u5728\u6267\u884c\u5b8c\u5b89\u88c5\u547d\u4ee4\u4e4b\u540e\u751f\u6210\u7684\u5bfc\u51fa\u914d\u7f6e\u6587\u4ef6</p> <ol> <li><code>OpenCVModules.cmake</code>\uff0c\u70b9\u51fb\u6b64\u5904\u8df3\u8f6c\u81f3\u8be5\u6587\u4ef6</li> <li><code>OpenCVModules-release.cmake</code>\uff0c\u70b9\u51fb\u6b64\u5904\u8df3\u8f6c\u81f3\u8be5\u6587\u4ef6</li> </ol> <p>\u4e24\u4e2a\u6587\u4ef6\u4e2d\u7684\u5185\u5bb9\u8fdb\u884c\u4ecb\u7ecd\uff0c\u56e0\u4e3a\u8fd9\u7c7b\u6587\u4ef6\u662f\u7531\u5bfc\u51fa\u76ee\u6807\u5728\u5b89\u88c5\u540e\u81ea\u52a8\u751f\u6210\u7684\uff0c\u6240\u4ee5\u4e0d\u8bba\u662f\u4ec0\u4e48\u9879\u76ee\uff0c\u5728\u5185\u5bb9\u4e0a\u90fd\u5177\u6709\u76f8\u4f3c\u6027</p> <p>\u4e0a\u6587\u4e2d\u7684 <code>OpenCVModules.cmake</code> \u6587\u4ef6\uff0c\u5177\u6709\u4ee5\u4e0b\u51e0\u4e2a\u90e8\u5206</p> <ol> <li>\u9632\u6b62\u91cd\u590d\u5305\u542b\uff0c\u6765\u81ea\u5982\u4e0b\u6ce8\u91ca\uff1a</li> </ol> <pre><code># Protect against multiple inclusion, which would fail when already imported targets are added once more.</code></pre> <p>\u4f7f\u7528 <code>foreach</code> \u904d\u5386\u6240\u6709\u5f85\u5bfc\u5165\u76ee\u6807\u7684\u540d\u5b57\uff08\u5373\u5df2\u88ab\u5b89\u88c5\u7684\u76ee\u6807\u7684\u540d\u5b57\uff09\uff0c\u5224\u65ad\u8fd9\u4e9b\u53d8\u91cf\u662f\u5426\u5df2\u7ecf\u662f\u76ee\u6807\uff0c\u5982\u679c\u662f\u8bf4\u660e\u5df2\u7ecf\u91cd\u590d\u5305\u542b\u3002</p> <ol> <li>\u83b7\u53d6\u8be5\u9879\u76ee\u7684\u5b89\u88c5\u8def\u5f84\uff0c\u5e76\u8bbe\u7f6e\u4e3a\u4e00\u4e2a\u53d8\u91cf <code>_IMPORT_PREFIX</code>\uff0c\u8be5\u53d8\u91cf\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u6267\u884c\u4e86\u597d\u51e0\u6b21\u91cd\u590d\u7684\u547d\u4ee4</li> </ol> <pre><code>get_filename_component(_IMPORT_PREFIX \"${CMAKE_CURRENT_LIST_FILE}\" PATH)\nget_filename_component(_IMPORT_PREFIX \"${_IMPORT_PREFIX}\" PATH)\nget_filename_component(_IMPORT_PREFIX \"${_IMPORT_PREFIX}\" PATH)\nget_filename_component(_IMPORT_PREFIX \"${_IMPORT_PREFIX}\" PATH)\n</code></pre> <p>\u5982\u679c\u5f53\u524d\u6587\u4ef6\u8def\u5f84\u662f <code>/usr/local/lib/cmake/opencv4</code>\uff0c\u90a3\u4e48\u56db\u6b21\u8bbe\u7f6e <code>get_filename_component</code> \u5206\u522b\u8868\u793a</p> <ul> <li>\u5f97\u5230<code>/usr/local/lib/cmake/opencv4</code></li> <li>\u5f97\u5230<code>/usr/local/lib/cmake</code></li> <li>\u5f97\u5230<code>/usr/local/lib</code></li> <li>\u5f97\u5230<code>/usr/local</code></li> </ul> <p>\u6700\u7ec8\u7684 <code>_IMPORT_PREFIX</code> \u6b63\u662f\u9879\u76ee\u7684\u5b89\u88c5\u8def\u5f84 <code>/usr/local</code></p> <ol> <li>\u521b\u5efa\u5bfc\u5165\u76ee\u6807\uff0c\u5e76\u521d\u6b65\u8bbe\u7f6e\u5c5e\u6027</li> </ol> <p>\u8fd9\u662f\u8be5\u5bfc\u51fa\u914d\u7f6e\u6587\u4ef6\u7684\u6838\u5fc3\u6240\u5728\uff0c\u5305\u542b\u4e86\u7c7b\u4f3c\u5982\u4e0b\u7684\u4e00\u7cfb\u5217\u8bed\u53e5</p> <pre><code># Create imported target opencv_core\nadd_library(opencv_core SHARED IMPORTED)\n\n# Create imported target opencv_flann\nadd_library(opencv_flann SHARED IMPORTED)\n\nset_target_properties(opencv_flann PROPERTIES\n  INTERFACE_LINK_LIBRARIES \"opencv_core;opencv_core\"\n)\n</code></pre> <p>\u53ef\u80fd\u6709\u8bfb\u8005\u4f1a\u6ce8\u610f\u5230\uff0c\u8fd9\u91cc\u5e76\u6ca1\u6709\u4e3a\u5bfc\u5165\u76ee\u6807\u8bbe\u7f6e <code>IMPORTED_LOCATION</code> \u5c5e\u6027\u3002\u6ca1\u9519\uff0c\u6240\u4ee5\u8bf4\u8fd9\u91cc\u662f==\u521d\u6b65==\u8bbe\u7f6e\u5c5e\u6027\u3002</p> <ol> <li> <p>\u5305\u542b <code>OpenCVModules-&lt;config&gt;.cmake</code> \u6587\u4ef6\uff0c\u5728\u6b64\u6587\u4ef6\u4e2d==\u8fdb\u4e00\u6b65==\u8bbe\u7f6e\u5c5e\u6027\u3002\u5982\u679c\u8be5\u9879\u76ee\u662f</p> </li> <li> <p>Release \u6a21\u5f0f\u7f16\u8bd1\u7684\uff0c\u90a3\u4e48\u4f1a\u5305\u542b <code>OpenCVModules-release.cmake</code> \u6587\u4ef6</p> </li> <li>Debug \u6a21\u5f0f\u7f16\u8bd1\u7684\uff0c\u90a3\u4e48\u4f1a\u5305\u542b <code>OpenCVModules-debug.cmake</code> \u6587\u4ef6</li> <li>\u4e0d\u6307\u5b9a\u914d\u7f6e\u6a21\u5f0f\u7684\uff0c\u90a3\u4e48\u4f1a\u5305\u542b <code>OpenCVModules-noconfig.cmake</code> \u6587\u4ef6</li> </ol> <p>\u5728 <code>OpenCVModules-&lt;config&gt;.cmake</code> \u6587\u4ef6\u4e2d\u4f1a\u4e3a\u5bfc\u5165\u76ee\u6807\u8bbe\u7f6e <code>IMPORTED_LOCATION_&lt;config&gt;</code> \u7684\u76f8\u5173\u5c5e\u6027\uff0c\u4f8b\u5982</p> <pre><code># Import target \"opencv_core\" for configuration \"Release\"\nset_property(TARGET opencv_core APPEND PROPERTY IMPORTED_CONFIGURATIONS RELEASE)\nset_target_properties(opencv_core PROPERTIES\n  IMPORTED_LOCATION_RELEASE \"${_IMPORT_PREFIX}/lib/libopencv_core.so.4.8.0\"\n  IMPORTED_SONAME_RELEASE \"libopencv_core.so.408\"\n  )\n\nlist(APPEND _IMPORT_CHECK_TARGETS opencv_core )\n</code></pre> <p>\u65e0\u8bba\u662f\u8fd9\u91cc\u7684 <code>IMPORTED_LOCATION_RELEASE</code> \u8fd8\u662f\u81ea\u5df1\u8bbe\u7f6e\u5bfc\u5165\u76ee\u6807\u4e2d\u7684 <code>IMPORTED_LOCATION</code>\uff0c\u90fd\u4f1a\u4e3a\u76ee\u6807\u8bbe\u7f6e <code>LOCATION</code> \u5c5e\u6027\uff0c\u8fd9\u6b63\u662f\u76ee\u6807\u80fd\u591f\u88ab\u6b63\u786e\u94fe\u63a5\u7684\u5173\u952e\u3002</p> <ol> <li>\u68c0\u67e5\u6240\u6709\u5bfc\u5165\u76ee\u6807\u6240\u6307\u5b9a\u7684\u5e93\u6587\u4ef6\uff08<code>*.a</code> \u6216\u8005 <code>*.so</code>\uff09\u662f\u5426\u5b58\u5728\u3002</li> </ol> <p><code>OpenCVModules-&lt;config&gt;.cmake</code> \u6587\u4ef6\u4e2d\u4e3a\u6240\u6709\u7684\u5bfc\u5165\u76ee\u6807\u90fd\u8bbe\u7f6e\u4e86\u5e93\u6587\u4ef6\u7684\u8def\u5f84\uff0c\u8fd9\u4e2a\u8def\u5f84\u7684\u5b58\u5728\u4e0e\u5426\u5c06\u5728\u6b64\u8fdb\u884c\u5224\u65ad\uff0c\u4e0d\u5b58\u5728\u5c06\u4f1a\u7acb\u523b\u7ec8\u6b62 CMake \u7a0b\u5e8f\u3002</p>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/10-%E9%A1%B9%E7%9B%AE%E7%9A%84%E5%AF%BC%E5%87%BA%E4%B8%8E%E5%AE%89%E8%A3%85/#34-target_xxx","title":"3.4 \u56de\u987e\uff1a\u4e3a\u4f55\u8981\u4f7f\u7528 target_xxx","text":"<p>::: tip \u4e0b\u9762\u4ecb\u7ecd\u4e00\u4e2a\u7ecf\u5e38\u88ab\u63d0\u53ca\u7684\u8bdd\u9898\uff0c\u4e3a\u4ec0\u4e48\u8981\u4f7f\u7528 <code>target_xxx</code> :::</p> <p>\u5728\u301005\u3011\u76ee\u6807\u6784\u5efa #2\u4e00\u6587\u4e2d\u4ecb\u7ecd\u4e86 <code>target_include_directories</code> \u548c <code>target_link_libraries</code> \u7684\u7528\u6cd5\uff0c\u5e76\u6307\u51fa\u5c3d\u91cf\u4e0d\u8981\u4f7f\u7528 <code>include_directories</code> \u548c <code>link_libraries</code> \u4e24\u79cd\uff0c\u4e0b\u9762\u5c06\u6839\u636e\u672c\u6587\u5bfc\u51fa\u914d\u7f6e\u7684\u5185\u5bb9\u4ecb\u7ecd\u4e3a\u4f55\u8981\u4f7f\u7528 <code>target_xxx</code>\u3002</p> <p>\u4e00\u822c\u4f7f\u7528 <code>target_include_directories</code> \u7684\u65f6\u5019\uff0c\u9700\u8981\u5305\u542b\u7684\u76ee\u5f55\u4f1a\u4e0e\u6307\u5b9a\u7684 CMake \u76ee\u6807\u7ed1\u5b9a\u8d77\u6765\uff08\u8fd9\u91cc\u7684\u76ee\u6807\u540c\u6837\u53ef\u4ee5\u662f\u5e93\u3001\u53ef\u6267\u884c\u6587\u4ef6\u3001\u63a5\u53e3\u5e93\u7b49\u5185\u5bb9\uff09\uff0c\u6bd4\u65b9\u8bf4\u4ee5\u4e0b\u547d\u4ee4</p> <pre><code>add_library(aa aaa.cpp)\ntarget_include_directories(\n  aa PUBLIC\n  $&lt;BUILD_INTERFACE:${CMAKE_CURRENT_LIST_DIR}/include&gt;\n  $&lt;INSTALL_INTERFACE:include/MyLibrary&gt;\n)\n\n####################\n###  other code  ###\n####################\n\nadd_library(bb bbb.cpp)\ntarget_link_libraries(\n  bb\n  PUBLIC aa\n)\n</code></pre> <p>\u6839\u636e\u4ee5\u524d\u7684\u77e5\u8bc6</p> <ul> <li>\u4f1a\u628a <code>include</code> \u76ee\u5f55\u6dfb\u52a0\u5230 <code>aa</code> \u76ee\u6807\u4e0b</li> <li><code>aa</code> \u4f1a\u88ab <code>bb</code> \u6240\u94fe\u63a5</li> </ul> <p>\u6b64\u5916\uff0c\u5982\u679c <code>aa</code> \u548c <code>bb</code> \u76ee\u6807\u88ab\u5b89\u88c5\u81f3\u5bfc\u51fa\u76ee\u6807 <code>MyModules</code> \u4e0a\uff0c\u5e76\u4e14\u5b89\u88c5\uff0c\u5373\u4f7f\u7528\u4ee5\u4e0b\u4ee3\u7801</p> <pre><code>install(\n  TARGETS aa bb\n  EXPORT MyModules\n)\ninstall(\n  EXPORT MyModules\n  FILE MyModules.cmake\n  DESTINATION \"${CMAKE_INSTALL_LIBDIR}/cmake/MyLibrary\"\n)\n</code></pre> <p>\u8fd0\u884c <code>cmake --install .</code> \u540e\u53ef\u4ee5\u5728\u5b89\u88c5\u8def\u5f84 <code>&lt;path-to-install&gt;/cmake/MyLibrary/MyModules.cmake</code> \u4e0b\u627e\u5230\u5982\u4e0b\u7c7b\u4f3c\u7684\u8bed\u53e5</p> <pre><code># Create imported target aa\nadd_library(aa STATIC IMPORTED)\n\nset_target_properties(aa PROPERTIES\n  INTERFACE_INCLUDE_DIRECTORIES \"${_IMPORT_PREFIX}/include/MyLibrary\"\n)\n\n## Create imported target bb\nadd_library(bb STATIC IMPORTED)\n\nset_target_properties(bb PROPERTIES\n  INTERFACE_LINK_LIBRARIES \"aa\"\n)\n</code></pre> <p>\u8fd9\u4fbf\u662f\u4f7f\u7528 <code>target_xxx</code> \u547d\u4ee4\u7684\u4f5c\u7528\uff0c\u5728\u5bfc\u51fa\u5e76\u5b89\u88c5\u65f6\uff0c\u4f1a\u5c06\u8fd9\u4e9b\u94fe\u63a5\u3001\u5305\u542b\u5173\u7cfb\u7ee7\u7eed\u7ed1\u5b9a\u5728\u8be5\u76ee\u6807\u4e0a\uff0c\u800c\u4f7f\u7528 <code>include_directories</code> \u548c <code>link_libraries</code> \u5219\u6ca1\u6709\u8fd9\u4e9b\u6548\u679c\u3002\u5f53\u7136\uff0c\u5728\u4e0d\u9700\u8981\u8fdb\u884c\u5bfc\u51fa\u5b89\u88c5\u7684\u9879\u76ee\u4e2d\uff0c\u5b8c\u5168\u53ef\u4ee5\u4f7f\u7528\u8fd9\u4e9b\u4e0d\u5e26 <code>target_</code> \u524d\u7f00\u7684\u8fd9\u4e9b\u547d\u4ee4\u3002\u4e0d\u8fc7\u8fd9\u4e9b\u4e0d\u5e26 <code>target_</code> \u4e3a\u524d\u7f00\u7684\u547d\u4ee4\u4f1a\u4f5c\u4e3a\u5168\u5c40\u5305\u542b\u7684\u5f62\u5f0f\u7ed9\u5176\u4ed6\u76ee\u6807\u4f7f\u7528\uff0c\u6709\u4e00\u5b9a\u7684 \u201c\u6c61\u67d3\u201d \u5acc\u7591\u3002</p>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/10-%E9%A1%B9%E7%9B%AE%E7%9A%84%E5%AF%BC%E5%87%BA%E4%B8%8E%E5%AE%89%E8%A3%85/#4-xxxconfigcmake","title":"4. XxxConfig.cmake \u6587\u4ef6\u7684\u4e00\u822c\u5199\u6cd5","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/10-%E9%A1%B9%E7%9B%AE%E7%9A%84%E5%AF%BC%E5%87%BA%E4%B8%8E%E5%AE%89%E8%A3%85/#41","title":"4.1 \u5199\u6cd5","text":"<p>\u5728\u4f7f\u7528</p> <pre><code>find_package(OpenCV REQUIRED)\n</code></pre> <p>\u7684\u65f6\u5019\uff0c\u5c31\u662f\u6309\u7167\u641c\u7d22\u539f\u5219\uff0c\u5728\u7cfb\u7edf\u8def\u5f84\u4e0b\u5bfb\u627e <code>OpenCVConfig.cmake</code> \u6587\u4ef6\uff0c\u82e5\u6211\u4eec\u60f3\u901a\u8fc7\u4f7f\u7528 <code>Config</code> \u6a21\u5f0f\uff0c\u4f7f\u7528</p> <pre><code>find_package(MyLibrary REQUIRED)\n</code></pre> <p>\u6765\u53d1\u73b0\u5305\uff0c\u6211\u4eec\u4e5f\u9700\u8981\u5728\u5408\u9002\u7684\u4f4d\u7f6e\u521b\u5efa <code>MyLibraryConfig.cmake</code> \u6587\u4ef6\uff0c\u8fd9\u4e2a\u6587\u4ef6\u4e00\u822c\u662f\u901a\u8fc7\u4f7f\u7528\u6587\u4ef6\u5b89\u88c5\uff08\u5373 <code>install(FILES)</code> \u7684\u65b9\u5f0f\u5b89\u88c5\u5230\u6307\u5b9a\u4f4d\u7f6e\u7684\uff09\u3002\u4e00\u4e2a <code>XxxConfig.cmake</code> \u6587\u4ef6\u4e0e <code>FindXxx.cmake</code> \u5305\u542b\u7684\u5185\u5bb9\u57fa\u672c\u4e00\u81f4\uff0c\u5305\u542b</p> <ol> <li>\u641c\u7d22\u5934\u6587\u4ef6</li> <li>\u641c\u7d22\u5e93\u6587\u4ef6</li> <li>\u63d0\u4f9b CMake \u76ee\u6807\u53d8\u91cf</li> <li>\u641c\u5bfb\u7684\u7ed3\u679c\u3001\u72b6\u6001</li> </ol> <p>\u8fd9\u91cc\u76f4\u63a5\u7ed9\u51fa\u5185\u5bb9</p> <pre><code># ======================================================\n#  MyLibrary CMake \u914d\u7f6e\u6587\u4ef6\n# ======================================================\n\n# ======================================================\n#  \u5934\u6587\u4ef6\u641c\u7d22\n# ======================================================\n# \u83b7\u53d6\u6ca1\u6709 ../.. \u76f8\u5bf9\u8def\u5f84\u6807\u8bb0\u7684\u7edd\u5bf9\u8def\u5f84\nget_filename_component(ML_CONFIG_PATH \"${CMAKE_CURRENT_LIST_DIR}\" REALPATH)\nget_filename_component(ML_INSTALL_PATH \"${ML_CONFIG_PATH}/../../../\" REALPATH)\n\n# \u641c\u7d22\uff0c\u6dfb\u52a0\u81f3\u5168\u5c40\u53d8\u91cf MyLibrary_INCLUDE_DIRS\nset(ML_INCLUDE_COMPONENTS \"${ML_INSTALL_PATH}/include/MyLibrary\")\nset(MyLibrary_INCLUDE_DIRS \"\")\nforeach(d ${ML_INCLUDE_COMPONENTS})\n  get_filename_component(_d \"${d}\" REALPATH)\n  if(NOT EXISTS \"${_d}\")\n    message(WARNING \"MyLibrary: Include directory doesn't exist: '${d}'. MyLibrary installation may be broken. Skip...\")\n  else()\n    list(APPEND MyLibrary_INCLUDE_DIRS \"${_d}\")\n  endif()\nendforeach()\nunset(_d)\n\n# ======================================================\n# \u5e93\u6587\u4ef6\u641c\u7d22\n# ======================================================\n# \u5305\u542b\u5bfc\u51fa\u914d\u7f6e\u7684 *.cmake \u6587\u4ef6\ninclude(${CMAKE_CURRENT_LIST_DIR}/MyModules.cmake)\n\n# \u6dfb\u52a0\u81f3\u5168\u5c40\u53d8\u91cf MyLibrary_LIBS\nset(ML_LIB_COMPONENTS my_target;my_target_2)\nforeach(_mlcomponent ${ML_LIB_COMPONENTS})\n  set(MyLibrary_LIBS ${MyLibrary_LIBS} \"${_mlcomponent}\")\nendforeach()\n\n# ======================================================\n# \u641c\u5bfb\u7684\u7ed3\u679c\u3001\u72b6\u6001\n# ======================================================\ninclude(FindPackageHandleStandardArgs)\nfind_package_handle_standard_args(\n  MyLibrary\n  REQUIRED_VARS ML_INSTALL_PATH\n)\n</code></pre> <p>\u53ef\u4ee5\u7559\u610f\u5230\u8fd9\u91cc\u7684\u5e93\u6587\u4ef6\u641c\u7d22\u4e0d\u518d\u50cf <code>FindXxx.cmake</code> \u90a3\u6837\u9700\u8981\u81ea\u5df1\u6307\u5b9a\u52a8\u6001\u5e93\u6216\u9759\u6001\u5e93\u7684\u8def\u5f84\uff0c\u8fd9\u91cc\u662f\u5426\u662f\u52a8\u6001\u5e93\u6216\u8005\u9759\u6001\u5e93\u5b8c\u5168\u4e0d\u9700\u8981\u7531\u5bfc\u51fa\u8005\u6307\u5b9a\uff0c\u5bfc\u51fa\u8005\u53ea\u9700\u8981\u5305\u542b\u5bfc\u51fa\u914d\u7f6e\u7684\u6587\u4ef6\u5373\u53ef\uff0c\u56e0\u4e3a\u4e0e\u5e93\u76ee\u6807\u76f8\u5173\u7684\u8bbe\u7f6e\u6b63\u662f\u7531\u5bfc\u51fa\u914d\u7f6e\u5b8c\u6210\u3002\u7406\u8bba\u4e0a\uff0c\u5982\u679c\u4e0d\u9700\u8981\u5168\u5c40\u53d8\u91cf <code>xxx_INLCUDE_DIRS</code> \u6216\u8005 <code>xxx_LIBS</code> \u4ee5\u53ca\u641c\u5bfb\u7684\u72b6\u6001\u7684\u8bdd\uff0c<code>XxxConfig.cmake</code> \u6587\u4ef6\u53ef\u4ee5\u77ed\u5230\u53ea\u6709\u51e0\u884c\uff08\u6ce8\u91ca\u5220\u6389\u5c31\u662f 1 \u884c\uff09\uff1a</p> <pre><code># ======================================================\n#  MyLibrary CMake \u914d\u7f6e\u6587\u4ef6\n# ======================================================\n\ninclude(${CMAKE_CURRENT_LIST_DIR}/MyModules.cmake)\n</code></pre> <p>\u56e0\u4e3a\u5728 <code>MyLibrary</code> \u4e2d\uff0c\u76ee\u6807\u53ea\u6709 <code>my_target</code> \u548c <code>my_target_2</code>\uff0c\u5e76\u4e14\u4e0e\u5176\u76f8\u5173\u7684\u914d\u7f6e\u5168\u90e8\u8bbe\u7f6e\u5728\u4e86\u5bfc\u51fa\u76ee\u6807\u7684\u6587\u4ef6 <code>MyModules.cmake</code> \u4e2d\u3002</p>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/10-%E9%A1%B9%E7%9B%AE%E7%9A%84%E5%AF%BC%E5%87%BA%E4%B8%8E%E5%AE%89%E8%A3%85/#42-opencvconfigcmake","title":"4.2 \u5256\u6790 OpenCVConfig.cmake","text":"<p>\u4ee5\u4e0b\u5c55\u793a\u4e86 OpenCV 4.8.0 \u7684\u7528\u4e8e <code>find_package</code> \u7684 Config \u6587\u4ef6\uff0c\u70b9\u51fb\u6b64\u5904\u8df3\u8f6c\u81f3\u8be5\u6587\u4ef6\u3002</p> <p>\u6309\u7167\u6587\u4ef6\u4e2d\u7684\u987a\u5e8f\uff0c\u4e3b\u8981\u5305\u542b</p> <ol> <li>\u63d0\u4f9b\u6ce8\u91ca</li> </ol> <p><code>OpenCVConfig.cmake</code> \u6587\u4ef6\u63d0\u4f9b\u4e86\u5f88\u957f\u7684\u6ce8\u91ca\u5185\u5bb9\uff0c\u7528\u6237\u53ef\u4ee5\u76f4\u63a5\u5bf9\u7167\u6b64\u6ce8\u91ca\u5185\u5bb9\u8fdb\u884c\u4f7f\u7528</p> <ol> <li>\u63d0\u4f9b\u7248\u672c\u4fe1\u606f</li> </ol> <p>\u5728\u6b64\u6587\u4ef6\u7684\u4e00\u5f00\u5934\uff0cOpenCV \u5c31\u8bbe\u7f6e\u4e86\u7248\u672c\u53f7\u4fe1\u606f</p> <ol> <li>\u641c\u7d22\u5934\u6587\u4ef6</li> </ol> <p>\u5e38\u89c4\u64cd\u4f5c\uff0c\u4e0e\u4e0a\u6587\u7684\u4e00\u822c\u5199\u6cd5\u57fa\u672c\u4e00\u81f4</p> <ol> <li>\u641c\u7d22\u5e93\u6587\u4ef6\u3001\u63d0\u4f9b CMake \u76ee\u6807\u53d8\u91cf</li> </ol> <p>\u5e38\u89c4\u64cd\u4f5c\uff0c\u540c\u6837\u5206\u4e3a\u4e24\u4e2a\u90e8\u5206\u3002\u7b2c\u4e00\u90e8\u5206\u76f4\u63a5\u5305\u542b\u5bfc\u51fa\u914d\u7f6e\u6587\u4ef6 <code>OpenCVModules.cmake</code>\uff0c\u7528\u4e8e\u914d\u7f6e\u6240\u6709\u7684\u5bfc\u5165\u76ee\u6807\uff0c\u7b2c\u4e8c\u90e8\u5206\u8bbe\u7f6e <code>OpenCV_LIBS</code> \u53d8\u91cf\uff0c\u7528\u4e8e\u5305\u542b\u6240\u6709\u7684\u5bfc\u5165\u76ee\u6807\u3002</p> <p>::: warning    - \u4e0e\u4e0a\u6587\u4e00\u822c\u5199\u6cd5\u6709\u6240\u4e0d\u540c\u7684\u662f\uff0cOpenCV \u6ca1\u6709\u5728 <code>OpenCVModules.cmake</code> \u4e2d\u4e3a\u76ee\u6807\u914d\u7f6e\u5305\u542b\u5934\u6587\u4ef6\u7684\u641c\u7d22\u8def\u5f84\uff0c\u56e0\u4e3a OpenCV \u5728\u9879\u76ee\u4e2d\u4f7f\u7528\u7684 <code>ocv_target_include_directories</code> \u547d\u4ee4\u4f7f\u7528\u4e86 <code>PRIVATE</code> \u4f5c\u4e3a\u4f20\u64ad\u5c5e\u6027\uff0c\u90a3\u4e48\u4e5f\u5c31\u4e0d\u4f1a\u5728 <code>OpenCVModules.cmake</code> \u4e2d\u6709\u5305\u542b\u5934\u6587\u4ef6\u8def\u5f84\u7684\u914d\u7f6e\uff1b</p> <ul> <li> <p>\u4e0d\u8fc7\u5728 <code>OpenCVConfig.cmake</code> \u4e2d\u662f\u901a\u8fc7\u624b\u52a8 <code>foreach</code> \u6bcf\u4e2a\u5bfc\u5165\u76ee\u6807\u5e76\u8fdb\u884c <code>set_target_properties</code> \u64cd\u4f5c\uff0c\u4e3a\u6bcf\u4e2a\u5bfc\u5165\u76ee\u6807\u914d\u7f6e <code>INTERFACE_INCLUDE_DIRECTORIES</code> \u5c5e\u6027\u7684\u3002    :::</p> </li> <li> <p>\u641c\u5bfb\u7684\u7ed3\u679c\u3001\u72b6\u6001</p> </li> </ul> <p>\u5e38\u89c4\u64cd\u4f5c\uff0c\u540c\u6837\u662f\u4f7f\u7528 <code>find_package_handle_standard_args</code> \u547d\u4ee4\u83b7\u53d6\u641c\u7d22\u7684\u7ed3\u679c\u4e0e\u72b6\u6001</p>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/10-%E9%A1%B9%E7%9B%AE%E7%9A%84%E5%AF%BC%E5%87%BA%E4%B8%8E%E5%AE%89%E8%A3%85/#5-cmake","title":"5. CMake \u9879\u76ee\u5bfc\u51fa\u4e0e\u5b89\u88c5\u7684\u5185\u5bb9\u603b\u7ed3","text":"<p>\u603b\u7684\u6765\u8bf4\u9700\u8981\u5b8c\u6210</p> <ul> <li>\u6dfb\u52a0\u5e38\u89c4\u76ee\u6807\u7684\u5b89\u88c5\u89c4\u5219\uff0c\u5e76\u6307\u5b9a\u5bfc\u51fa\u76ee\u6807</li> <li>\u6dfb\u52a0\u5bfc\u51fa\u76ee\u6807\u7684\u5b89\u88c5\u89c4\u5219</li> <li>\u7f16\u5199 <code>XxxConfig.cmake</code> \u6587\u4ef6\uff0c\u5e76\u6dfb\u52a0\u5b89\u88c5\u89c4\u5219</li> <li>\u7f16\u8bd1\u9879\u76ee\uff0c\u6267\u884c\u5b89\u88c5\u6b65\u9aa4\uff0c\u4f8b\u5982 <code>cmake --install .</code></li> </ul>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/10-%E9%A1%B9%E7%9B%AE%E7%9A%84%E5%AF%BC%E5%87%BA%E4%B8%8E%E5%AE%89%E8%A3%85/#thinking","title":"\u601d\u8003 :thinking:","text":"<ol> <li>\u5bfc\u5165\u76ee\u6807\u548c\u5bfc\u51fa\u76ee\u6807\u6709\u4ec0\u4e48\u4e0d\u540c\uff1f\u4f7f\u7528\u573a\u666f\u662f\u4ec0\u4e48\uff1f</li> <li>\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u5b89\u88c5\u63a5\u53e3\u5e93\uff0c\u4f1a\u6709\u4ec0\u4e48\u6548\u679c\uff1f    <pre><code>install(\n  TARGETS my_interface\n  LIBRARY DESTINATION lib\n  ARCHIVE DESTINATION lib\n  RUNTIME DESTINATION bin\n)\n</code></pre></li> </ol> <p>\u7b54\u6848 \u3010\u70b9\u6b64\u67e5\u770b\u3011</p>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/11-%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/","title":"\u301011\u3011\u9879\u76ee\u5b9e\u6218","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/11-%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/#1","title":"1. \u5e38\u89c4\u975e\u8de8\u5e73\u53f0\u9879\u76ee","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/11-%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/#11_1","title":"1.1 \u9884\u671f\u76ee\u6807","text":"<p>\u73b0\u8ba1\u5212\u5f00\u53d1\u4e00\u4e2a\u4e13\u4e3a Linux \u5e73\u53f0\u8bbe\u8ba1\u7684\u89c6\u89c9\u5904\u7406\u5e93 <code>visionlib</code> \u53ca\u793a\u4f8b\u7a0b\u5e8f <code>vl_demo</code>\uff0c\u5e93\u5728\u4ece\u6e90\u7801\u7f16\u8bd1\u5b89\u88c5\u7684\u8fc7\u7a0b\u4e2d\u9700\u8981\u5b9e\u73b0\u4ee5\u4e0b\u529f\u80fd\uff1a</p> <ol> <li>\u9700\u8981\u652f\u6301 C++17 \u6807\u51c6\uff1b</li> <li>\u5f3a\u5236\u4f9d\u8d56 OpenCV 4 \u53ca\u4ee5\u4e0a\u7248\u672c\uff0c\u5e76\u7528\u5230\u5176\u4e2d\u7684 <code>core</code>\u3001<code>imgproc</code>\u3001<code>highgui</code> \u6a21\u5757\uff0c\u5206\u522b\u5bf9\u5e94 <code>opencv_core</code>\u3001<code>opencv_imgproc</code>\u3001<code>opencv_highgui</code> \u8fd9 3 \u4e2a CMake \u76ee\u6807\uff1b</li> <li>\u9ed8\u8ba4\u4ee5\u9759\u6001\u5e93\u7684\u5f62\u5f0f\u6784\u5efa <code>visionlib</code>\uff0c\u4f46\u5141\u8bb8\u7528\u6237\u901a\u8fc7 CMake \u9009\u9879\u8bbe\u7f6e\u6784\u5efa\u4e3a\u52a8\u6001\u5e93\uff1b</li> <li>\u5e93\u5305\u542b\u4e86 <code>vl_a</code>\u3001<code>vl_b</code>\u3001<code>vl_c</code> \u548c <code>vl_d</code> \u5171 4 \u4e2a\u6a21\u5757\uff0c\u5206\u522b\u5bf9\u5e94 <code>a</code>\u3001<code>b</code>\u3001<code>c</code> \u548c <code>d</code> 4 \u4e2a\u6587\u4ef6\u5939\uff0c\u5747\u9ed8\u8ba4\u53c2\u4e0e\u6784\u5efa\uff0c\u4f46\u662f\u5141\u8bb8\u7528\u6237\u901a\u8fc7 CMake \u9009\u9879\u8bbe\u7f6e\u4efb\u4e00\u6a21\u5757\u662f\u5426\u53c2\u4e0e\u6784\u5efa\uff1b</li> <li>\u9879\u76ee\u5305\u542b\u4e86\u4e00\u4e2a\u793a\u4f8b\u7a0b\u5e8f <code>vl_demo</code>\uff0c\u9ed8\u8ba4\u53c2\u4e0e\u6784\u5efa\uff0c\u5141\u8bb8\u7528\u6237\u901a\u8fc7 CMake \u9009\u9879\u8bbe\u7f6e\u5176\u662f\u5426\u53c2\u4e0e\u6784\u5efa\uff1b</li> <li>\u8fd9\u51e0\u4e2a\u6a21\u5757\u548c\u793a\u4f8b\u7a0b\u5e8f\u4e4b\u95f4\u5b58\u5728\u4f9d\u8d56\u5173\u7cfb\uff0c\u4f7f\u7528 \u2192 \u8868\u793a\u4f9d\u8d56\u5173\u7cfb\uff0c\u5982  \u8868\u793a <code>vl_c</code> \u4f9d\u8d56 <code>vl_a</code></li> </ol> <p>::: center      </p> <pre><code> **\u56fe 1-1\uff1a\u4f9d\u8d56\u5173\u7cfb\u56fe**\n</code></pre> <p>:::</p> <ol> <li>\u9879\u76ee\u7684\u5b89\u88c5\u76ee\u5f55\u4e3a <code>/usr/local</code>\uff0c\u5176\u4e2d</li> <li>\u793a\u4f8b\u7a0b\u5e8f\u5b89\u88c5\u5230 <code>/usr/local/bin</code></li> <li>\u5934\u6587\u4ef6\u5b89\u88c5\u5230 <code>/usr/local/include</code></li> <li>\u5e93\u6587\u4ef6\u5b89\u88c5\u5230 <code>/usr/local/lib</code></li> <li>CMake \u76f8\u5173\u914d\u7f6e\u6587\u4ef6\u5b89\u88c5\u5230 <code>/usr/local/lib/cmake/VisionLib</code></li> </ol>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/11-%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/#12","title":"1.2 \u8981\u6c42\u4e0e\u6587\u4ef6\u7ed3\u6784","text":"<p>\u8be5\u9879\u76ee\u4e2d\u6240\u6709\u7684 CMake \u76ee\u6807\u5fc5\u987b\u5747\u4ee5 <code>vl_</code> \u5f00\u5934\uff0c\u4f8b\u5982\u6587\u4ef6\u5939 <code>a</code> \u5bf9\u5e94\u7684\u76ee\u6807\u662f <code>vl_a</code>\uff0c\u8be5\u9879\u76ee\u7684\u6587\u4ef6\u7ed3\u6784\u5982\u4e0b</p> <p>``` :collapsed-lines . \u251c\u2500\u2500 modules \u2502   \u251c\u2500\u2500 a \u2502   \u2502   \u251c\u2500\u2500 include \u2502   \u2502   \u2502   \u2514\u2500\u2500 visionlib \u2502   \u2502   \u2502       \u2514\u2500\u2500 a.hpp \u2502   \u2502   \u2514\u2500\u2500 src \u2502   \u2502       \u251c\u2500\u2500 a1.cpp \u2502   \u2502       \u2514\u2500\u2500 a2.cpp \u2502   \u251c\u2500\u2500 b \u2502   \u2502   \u251c\u2500\u2500 include \u2502   \u2502   \u2502   \u2514\u2500\u2500 visionlib \u2502   \u2502   \u2502       \u2514\u2500\u2500 b.hpp \u2502   \u2502   \u2514\u2500\u2500 src \u2502   \u2502       \u251c\u2500\u2500 b1.cpp \u2502   \u2502       \u251c\u2500\u2500 b2.cpp \u2502   \u2502       \u251c\u2500\u2500 b3.cpp \u2502   \u2502       \u2514\u2500\u2500 b4.cpp \u2502   \u251c\u2500\u2500 c \u2502   \u2502   \u251c\u2500\u2500 include \u2502   \u2502   \u2502   \u2514\u2500\u2500 visionlib \u2502   \u2502   \u2502       \u2514\u2500\u2500 c.hpp \u2502   \u2502   \u2514\u2500\u2500 src \u2502   \u2502       \u2514\u2500\u2500 c.cpp \u2502   \u2514\u2500\u2500 d \u2502       \u251c\u2500\u2500 include \u2502       \u2502   \u2514\u2500\u2500 visionlib \u2502       \u2502       \u2514\u2500\u2500 d.hpp \u2502       \u2514\u2500\u2500 src \u2502           \u251c\u2500\u2500 d1.cpp \u2502           \u2514\u2500\u2500 d2.cpp \u2514\u2500\u2500 samples     \u2514\u2500\u2500 demo.cpp</p> <p>19 directories, 14 files <pre><code>### 1.3 \u5206\u6790\n\n- \u524d 3 \u4e2a\u9884\u671f\u76ee\u6807\u662f\u5173\u4e8e\u9879\u76ee\u7684\u8981\u6c42\uff0c\u53ef\u76f4\u63a5\u5728\u9879\u76ee\u6839\u76ee\u5f55\u7684 `CMakeLists.txt` \u4e2d\u5b9e\u73b0\n- \u7b2c 4 \u5230\u7b2c 6 \u4e2a\u9884\u671f\u76ee\u6807\u662f\u5173\u4e8e\u9879\u76ee\u7684\u4f9d\u8d56\u5173\u7cfb\uff0c\u53ef\u5728\u6bcf\u4e2a\u6a21\u5757\u7684 `CMakeLists.txt` \u4e2d\u5b9e\u73b0\n- \u6bcf\u4e2a\u6a21\u5757\u5747\u6d89\u53ca\u5230\u5934\u6587\u4ef6\u641c\u7d22\u8def\u5f84\u6dfb\u52a0\u3001\u6e90\u6587\u4ef6\u7f16\u8bd1\u3001\u5e93\u6587\u4ef6\u94fe\u63a5\u3001\u4f9d\u8d56\u5e93\u6dfb\u52a0\u3001\u5b89\u88c5\u76ee\u6807\u7b49\u64cd\u4f5c\uff0c\u53ef\u4ee5\u5c06\u8fd9\u4e9b\u5185\u5bb9\u5c01\u88c5\u5230\u4e00\u4e2a\u51fd\u6570\u4e2d\uff0c\u7136\u540e\u5728\u6bcf\u4e2a\u6a21\u5757\u7684 `CMakeLists.txt` \u4e2d\u8c03\u7528\n\n### 1.4 \u5b9e\u73b0\n\n\u5728\u9879\u76ee\u4e2d\u6dfb\u52a0\n\n- `CMakeLists.txt` \u2014\u2014 \u9879\u76ee\u6839\u76ee\u5f55\u7684 CMake \u914d\u7f6e\u6587\u4ef6\n- `cmake/VisionLibInstall.cmake` \u2014\u2014 \u9879\u76ee\u7684\u5b89\u88c5\u8def\u5f84\u914d\u7f6e\u6587\u4ef6\n- `cmake/VisionLibModule.cmake` \u2014\u2014 \u9879\u76ee\u7684 CMake \u51fd\u6570\u5e93\uff0c\u4e3b\u8981\u6d89\u53ca\u5230\u76ee\u6807\u7684\u4fbf\u6377\u521b\u5efa\n- `cmake/templates/VisionLibConfig.cmake.in` \u2014\u2014 \u9879\u76ee\u5728 `find_package` \u65f6\u9700\u8981\u7684\u914d\u7f6e\u6587\u4ef6\u6a21\u677f\n- `modules/CMakeLists.txt` \u2014\u2014 \u9879\u76ee\u7684\u6a21\u5757\u5217\u8868\n- `modules/a/CMakeLists.txt` \u2014\u2014 \u6a21\u5757 `a` \u7684 CMake \u914d\u7f6e\u6587\u4ef6\n- `modules/b/CMakeLists.txt` \u2014\u2014 \u6a21\u5757 `b` \u7684 CMake \u914d\u7f6e\u6587\u4ef6\n- `modules/c/CMakeLists.txt` \u2014\u2014 \u6a21\u5757 `c` \u7684 CMake \u914d\u7f6e\u6587\u4ef6\n- `modules/d/CMakeLists.txt` \u2014\u2014 \u6a21\u5757 `d` \u7684 CMake \u914d\u7f6e\u6587\u4ef6\n- `samples/CMakeLists.txt` \u2014\u2014 \u793a\u4f8b\u7a0b\u5e8f\u7684 CMake \u914d\u7f6e\u6587\u4ef6\n\n\u5171 10 \u4e2a\u6587\u4ef6\u3002\n\n#### 1.4.1 \u9879\u76ee\u914d\u7f6e\n\n::: code-tabs\n\n@tab CMakeLists.txt\n\n```cmake :collapsed-lines\ncmake_minimum_required(VERSION 3.10)\n\nproject(VisionLib)\n\n# ----------------------------------------------------------------------------\n#   \u914d\u7f6e\u9879\u76ee\n# ----------------------------------------------------------------------------\nset(CMAKE_CXX_STANDARD 17)\nset(CMAKE_CXX_STANDARD_REQUIRED ON)\n\nfind_package(OpenCV 4 REQUIRED)\noption(BUILD_SHARED_LIBS \"Build shared libraries?\" OFF)\n\ninclude(cmake/VisionLibInstall.cmake)\ninclude(cmake/VisionLibModule.cmake)\n\n# ----------------------------------------------------------------------------\n#   \u5c06\u5b50\u76ee\u5f55\u6dfb\u52a0\u5230\u6784\u5efa\u7cfb\u7edf\u4e2d\n# ----------------------------------------------------------------------------\nadd_subdirectory(modules)\nadd_subdirectory(samples)\n\n# ----------------------------------------------------------------------------\n#   \u5bfc\u51fa\u3001\u5b89\u88c5\u914d\u7f6e\n# ----------------------------------------------------------------------------\ninstall(\n  EXPORT VisionLibTargets\n  FILE VisionLibTargets.cmake\n  DESTINATION ${VL_CFG_INSTALL_PATH}\n  # VL_CFG_INSTALL_PATH \u5b9a\u4e49\u4e8e VisionLibInstall.cmake \u4e2d\n)\n\nconfigure_file(\n  cmake/templates/VisionLibConfig.cmake.in\n  \"${CMAKE_CURRENT_BINARY_DIR}/VisionLibConfig.cmake\"\n  @ONLY\n)\n\ninstall(\n  FILES \"${CMAKE_CURRENT_BINARY_DIR}/VisionLibConfig.cmake\"\n  DESTINATION ${VL_CFG_INSTALL_PATH}\n)\n</code></pre></p> <p>@tab VisionLibInstall.cmake</p> <pre><code># \u5b89\u88c5\u8def\u5f84\u76f8\u5173\u914d\u7f6e\n\nset(CMAKE_INSTALL_PREFIX \"/usr/local\")\nset(VL_INSTALL_PATH \"${CMAKE_INSTALL_PREFIX}\")\nset(VL_INC_INSTALL_PATH \"include/VisionLib\")\nset(VL_LIB_INSTALL_PATH \"lib\")\nset(VL_CFG_INSTALL_PATH \"${VL_LIB_INSTALL_PATH}/cmake/VisionLib\")\n</code></pre> <p>@tab VisionLibModule.cmake</p> <p>```cmake :collapsed-lines</p>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/11-%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/#visionlibconfigcmake","title":"\u7528\u4e8e\u6536\u96c6\u6240\u6709\u9700\u8981\u53c2\u4e0e\u6784\u5efa\u7684\u6a21\u5757\uff0c\u7ed9 VisionLibConfig.cmake \u4f7f\u7528","text":"<p>set(VL_LIB_COMPONENTS \"\" CACHE INTERNAL \"VisionLib components\")</p>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/11-%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/#-","title":"----------------------------------------------------------------------------","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/11-%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/#visionlib","title":"\u66f4\u65b0 VisionLib \u76ee\u6807\u6784\u5efa\u7684\u6807\u5fd7\u4f4d\uff0c\u7528\u4e8e\u63a7\u5236\u662f\u5426\u6784\u5efa\u6307\u5b9a\u6a21\u5757\uff0c\u4e0d\u5f71\u54cd\u7528\u6237\u7684\u9009\u62e9","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/11-%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/#-build_xxx_init","title":"- \u4e3b\u8981\u66f4\u65b0 <code>BUILD_xxx_INIT</code> \u53d8\u91cf","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/11-%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/#-build_xxx_init-on-off","title":"- \u5728\u6ee1\u8db3\u6761\u4ef6\u65f6\uff0c\u8bbe\u7f6e <code>BUILD_xxx_INIT</code> \u4e3a <code>ON</code>\uff0c\u5426\u5219\u4e3a <code>OFF</code>","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/11-%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/#_1","title":"\u7528\u6cd5:","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/11-%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/#vl_update_build-condition","title":"vl_update_build( [CONDITION])","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/11-%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/#_2","title":"\u793a\u4f8b:","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/11-%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/#vl_update_buildd-off","title":"vl_update_build(d OFF)","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/11-%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/#-_1","title":"---------------------------------------------------------------------------- <p>macro(vl_update_build name)   if(${ARGN})     set(BUILD${name}_INIT ON)   else()     set(BUILD${_name}_INIT OFF)   endif() endmacro()</p>","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/11-%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/#-_2","title":"----------------------------------------------------------------------------","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/11-%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/#_3","title":"\u6dfb\u52a0\u6a21\u5757","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/11-%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/#_4","title":"\u7528\u6cd5\uff1a","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/11-%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/#vl_add_module","title":"vl_add_module(","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/11-%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/#depends-vl_","title":"[DEPENDS   ...]             # \u4ee5 vl_ \u5f00\u5934\u7684\u6a21\u5757\u540d","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/11-%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/#ext_depends","title":"[EXT_DEPENDS   ...] # \u5916\u90e8\u4f9d\u8d56","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/11-%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/#_5","title":")","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/11-%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/#_6","title":"\u793a\u4f8b\uff1a","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/11-%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/#vl_add_modulea","title":"vl_add_module(a","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/11-%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/#depends-b-c","title":"DEPENDS b c","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/11-%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/#ext_depends-opencv_core","title":"EXT_DEPENDS opencv_core","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/11-%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/#_7","title":")","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/11-%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/#-_3","title":"---------------------------------------------------------------------------- <p>macro(vl_add_module name)   # \u5224\u65ad\u662f\u5426\u53c2\u4e0e\u6784\u5efa   if(NOT DEFINED BUILD${name}_INIT)     set(BUILD${name}_INIT ON)   endif()   option(BUILD${name}     \"Include ${_name} module into the VisionLib build\" ${BUILD${_name}_INIT}   ) # create option to enable/disable this module</p> <p>if(BUILD_${name})     # \u4ee5 vl \u5f00\u5934\u7684\u6a21\u5757\u540d\uff0c\u4f8b\u5982 vl_add_module(a) \u4f1a\u751f\u6210 vl_a     set(module_name vl_${name})     # \u89e3\u6790\u53c2\u6570     set(multi_args DEPENDS EXT_DEPENDS)     cmake_parse_arguments(VLMD \"\" \"\" \"${multi_args}\" ${ARGN})     # \u521b\u5efa\u76ee\u6807     aux_source_directory(src target_src)     add_library(${module_name} ${target_src})     # \u6dfb\u52a0\u5934\u6587\u4ef6\u641c\u7d22\u8def\u5f84\uff0c\u53ef\u53c2\u8003\u301009\u3011\u751f\u6210\u5668\u8868\u8fbe\u5f0f     target_include_directories(${module_name} PUBLIC       $       $       # VL_INC_INSTALL_PATH \u5b9a\u4e49\u4e8e VisionLibInstall.cmake \u4e2d     )     # \u6dfb\u52a0\u4f9d\u8d56     target_link_libraries(       ${module_name}       PUBLIC ${VLMD_EXT_DEPENDS}     )     foreach(m ${VLMD_DEPENDS})       target_link_libraries(         ${module_name}         PUBLIC vl${m}       )     endforeach()     # \u5b89\u88c5\u76ee\u6807     install(       DIRECTORY include/visionlib       DESTINATION ${VL_INC_INSTALL_PATH}     )     install(       TARGETS ${module_name}       EXPORT VisionLibTargets       LIBRARY DESTINATION ${VL_LIB_INSTALL_PATH}       ARCHIVE DESTINATION ${VL_LIB_INSTALL_PATH}     )     set(VL_LIB_COMPONENTS ${VL_LIB_COMPONENTS} \"${module_name}\" CACHE INTERNAL \"VisionLib components\")     unset(module_name)   endif() endmacro()","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/11-%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/#-_4","title":"----------------------------------------------------------------------------","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/11-%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/#_8","title":"\u6dfb\u52a0\u793a\u4f8b\u7a0b\u5e8f","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/11-%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/#_9","title":"\u7528\u6cd5\uff1a","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/11-%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/#vl_add_exe","title":"vl_add_exe(","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/11-%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/#sources","title":"SOURCES   ...               # \u6e90\u6587\u4ef6","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/11-%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/#depends-vl__1","title":"[DEPENDS   ...]             # \u4ee5 vl_ \u5f00\u5934\u7684\u6a21\u5757\u540d","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/11-%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/#ext_depends_1","title":"[EXT_DEPENDS   ...] # \u5916\u90e8\u4f9d\u8d56","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/11-%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/#_10","title":")","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/11-%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/#_11","title":"\u793a\u4f8b\uff1a","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/11-%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/#vl_add_exedemo","title":"vl_add_exe(demo","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/11-%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/#sources-democpp","title":"SOURCES demo.cpp","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/11-%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/#depends-a-b","title":"DEPENDS a b","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/11-%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/#ext_depends-opencv_highgui","title":"EXT_DEPENDS opencv_highgui","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/11-%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/#_12","title":")","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/11-%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/#-_5","title":"---------------------------------------------------------------------------- <p>macro(vl_add_exe name)   # \u5224\u65ad\u662f\u5426\u53c2\u4e0e\u6784\u5efa   if(NOT DEFINED BUILD${name}_INIT)     set(BUILD${name}_INIT ON)   endif()   option(BUILD${name}     \"Include ${_name} module into the VisionLib build\" ${BUILD${_name}_INIT}   ) # create option to enable/disable this module</p> <p>if(BUILD_${name})     set(module_name vl${name})     set(multi_args SOURCES DEPENDS EXT_DEPENDS)     cmake_parse_arguments(VLMD \"\" \"\" \"${multi_args}\" ${ARGN})     if(NOT VLMD_SOURCES)       message(FATAL_ERROR \"No sources provided for executable ${module_name}\")     endif()     add_executable(${module_name} ${VLMD_SOURCES})     target_link_libraries(       ${module_name}       PRIVATE ${VLMD_EXT_DEPENDS}     )     foreach(m ${VLMD_DEPENDS})       target_link_libraries(         ${module_name}         PRIVATE vl${m}       )     endforeach()     install(       TARGETS ${module_name}       RUNTIME DESTINATION bin     )     unset(module_name)   endif() endmacro() <pre><code>:::\n\n#### 1.4.2 \u6a21\u5757\u914d\u7f6e\n\n::: code-tabs\n\n@tab `modules`\n\n```cmake\nset(cur_path \"${CMAKE_CURRENT_SOURCE_DIR}\")\nfile(GLOB modules RELATIVE \"${cur_path}\" \"${cur_path}/*\")\n\nforeach(m ${modules})\n  if(IS_DIRECTORY ${cur_path}/${m})\n    add_subdirectory(${cur_path}/${m})\n  endif()\nendforeach()\n\n# \u7b80\u5355\u8d77\u89c1\uff0c\u4e5f\u53ef\u4ee5\u76f4\u63a5\u5199\n# add_subdirectory(a)\n# add_subdirectory(b)\n# add_subdirectory(c)\n# add_subdirectory(d)\n</code></pre></p> <p>@tab <code>modules/a</code></p> <pre><code>vl_add_module(a)\n</code></pre> <p>@tab <code>modules/b</code></p> <pre><code>vl_add_module(b\n  DEPENDS d\n  EXT_DEPENDS opencv_imgproc\n)\n</code></pre> <p>@tab <code>modules/c</code></p> <pre><code>vl_add_module(c\n  DEPENDS a\n  EXT_DEPENDS opencv_core\n)\n</code></pre> <p>@tab <code>modules/d</code></p> <pre><code>vl_add_module(d\n  DEPENDS b c\n)\n</code></pre> <p>:::</p>","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/11-%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/#143","title":"1.4.3 \u793a\u4f8b\u7a0b\u5e8f\u914d\u7f6e","text":"<p>::: code-tabs</p> <p>@tab samples/CMakeLists.txt</p> <p>```cmake :collapsed-lines vl_add_exe(demo   SOURCES demo.cpp   DEPENDS d   EXT_DEPENDS opencv_highgui ) <pre><code>:::\n\n#### 1.4.4 VisionLibConfig.cmake.in \u914d\u7f6e\n\n\u82e5\u5bf9\u8be5\u6587\u4ef6\u6709\u7591\u95ee\uff0c\u8bf7\u53c2\u8003[\u6b64\u5904](10-\u9879\u76ee\u7684\u5bfc\u51fa\u4e0e\u5b89\u88c5.md#_4-xxxconfig-cmake-\u6587\u4ef6\u7684\u4e00\u822c\u5199\u6cd5)\u3002\n\n::: code-tabs\n\n@tab VisionLibConfig.cmake.in\n\n```cmake :collapsed-lines\n# ----------------------------------------------------------------------------\n#  VisionLib CMake \u914d\u7f6e\u6587\u4ef6\n#\n#                  ** \u8be5\u6587\u4ef6\u7531 CMake \u751f\u6210\uff0c\u8bf7\u52ff\u624b\u52a8\u4fee\u6539 **\n#\n#  \u57fa\u672c\u7528\u6cd5\uff1a\n#    find_package(VisionLib REQUIRED)\n#    target_link_libraries(your_target PRIVATE vl_a vl_b ...)\n# ----------------------------------------------------------------------------\n\n# ----------------------------------------------------------------------------\n#   \u83b7\u53d6 VisionLib \u5b89\u88c5\u8def\u5f84\n# ----------------------------------------------------------------------------\nget_filename_component(VL_CONFIG_PATH\n  \"${CMAKE_CURRENT_LIST_FILE}\" PATH\n)\nset(VL_INSTALL_PATH \"@VL_INSTALL_PATH@\")\n\n# ----------------------------------------------------------------------------\n#   \u8bbe\u7f6e\u5934\u6587\u4ef6\u641c\u7d22\u8def\u5f84\u53d8\u91cf\n# ----------------------------------------------------------------------------\nset(VisionLib_INCLUDE_DIRS \"${VL_INSTALL_PATH}/@VL_INC_INSTALL_PATH@\")\n\n# ----------------------------------------------------------------------------\n#   \u8bbe\u7f6e\u5e93\u6587\u4ef6\u8def\u5f84\u53d8\u91cf\n# ----------------------------------------------------------------------------\nset(VisionLib_LIBS @VL_LIB_COMPONENTS@)\n\nif(NOT TARGET vl_a)\n  include(\"${VL_CONFIG_PATH}/VisionLibTargets.cmake\")\nendif()\n\n# ----------------------------------------------------------------------------\n#   \u641c\u5bfb\u7684\u7ed3\u679c\u3001\u72b6\u6001\n# ----------------------------------------------------------------------------\ninclude(FindPackageHandleStandardArgs)\n\nfind_package_handle_standard_args(VisionLib\n  REQUIRED_VARS VL_INSTALL_PATH\n)\n</code></pre></p> <p>:::</p>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/11-%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/#15-thinking","title":"1.5 \u601d\u8003 :thinking:","text":"<p>\u7528\u6237\u5728\u4f7f\u7528 VisionLib \u4e2d\u7684 <code>vl_d</code> \u76ee\u6807\u7684\u65f6\u5019\u4e00\u822c\u5728\u9879\u76ee\u4e2d\u4f1a\u5199\u4e0a</p> <pre><code>add_executable(demo main.cpp)\n\nfind_package(VisionLib REQUIRED)\n\ntarget_link_libraries(demo PRIVATE vl_d)\n</code></pre> <p>\u4f46\u662f\u8fd9\u65f6\u5019\u7f16\u8bd1\u4f1a\u51fa\u73b0\u5f62\u5982\u4ee5\u4e0b\u5185\u5bb9\u7684\u62a5\u9519</p> <pre><code>[ 50%] Building CXX object CMakeFiles/demo.dir/main.cpp.o\nIn file included from /usr/local/include/VisionLib/visionlib/d.hpp:3,\n                 from /path/to/vl_deploy_demo/main.cpp:1:\n/usr/local/include/VisionLib/visionlib/c.hpp:5:10: fatal error: opencv2/core.hpp: No such file or directory\n    5 | #include &lt;opencv2/core.hpp&gt;\n      |          ^~~~~~~~~~~~~~~~~~\ncompilation terminated.\nmake[2]: *** [CMakeFiles/demo.dir/build.make:76\uff1aCMakeFiles/demo.dir/main.cpp.o] error 1\nmake[1]: *** [CMakeFiles/Makefile2:83\uff1aCMakeFiles/demo.dir/all] error 2\nmake: *** [Makefile:91\uff1aall] error 2\n</code></pre> <p>\u8bf7\u5206\u6790\u51fa\u73b0\u8be5\u95ee\u9898\u7684\u539f\u56e0\u4ee5\u53ca\u89e3\u51b3\u65b9\u6cd5\u3002</p> <p>\u7b54\u6848 \u3010\u70b9\u6b64\u67e5\u770b\u3011</p>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/11-%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/#2","title":"2. \u5916\u90e8\u4f9d\u8d56\u7ba1\u7406","text":"<p>C/C++ \u4e00\u4e2a\u9971\u53d7\u8bdf\u75c5\u7684\u8bdd\u9898\u5c31\u662f\u5305\u7ba1\u7406\uff0c\u4e00\u4e9b\u73b0\u4ee3\u7684\u8bed\u8a00\u90fd\u5177\u6709\u6bd4\u8f83\u5b8c\u5584\u7684\u5305\u7ba1\u7406\u5de5\u5177\uff0c\u4f8b\u5982 Python \u7684 <code>pip</code>\u3001Node.js \u7684 <code>npm</code> \u548c <code>yarn</code>\u3001Rust \u7684 <code>cargo</code> \u7b49\uff0c\u800c C/C++ \u6ca1\u6709\u4e00\u4e2a\u7edf\u4e00\u7684\u3001\u5b98\u65b9\u7684\u5305\u7ba1\u7406\u5de5\u5177\uff0c\u5bfc\u81f4\u4e86 C/C++ \u9879\u76ee\u7684\u4f9d\u8d56\u7ba1\u7406\u975e\u5e38\u56f0\u96be\u3002CMake \u63d0\u4f9b\u4e86 <code>FetchContent</code> \u548c <code>ExternalProject</code> \u6a21\u5757\uff0c\u53ef\u4ee5\u7528\u4e8e\u7ba1\u7406\u9879\u76ee\u7684\u5916\u90e8\u4f9d\u8d56\uff0c\u76f8\u6bd4\u4e8e\u624b\u52a8\u4e0b\u8f7d\u3001\u7f16\u8bd1\u3001\u5b89\u88c5\uff0c<code>FetchContent</code> \u548c <code>ExternalProject</code> \u5df2\u7ecf\u5c3d\u53ef\u80fd\u7684\u7b80\u5316\u4e86\u8fd9\u4e2a\u8fc7\u7a0b\u3002</p> <p><code>ExternalProject</code> \u7528\u4e8e\u5728\u6784\u5efa\u8fc7\u7a0b\u4e2d\u4e0b\u8f7d\u3001\u914d\u7f6e\u3001\u6784\u5efa\u548c\u5b89\u88c5\u5916\u90e8\u9879\u76ee\u3002\u5b83\u901a\u5e38\u7528\u4e8e\u5904\u7406\u5927\u578b\u7684\u3001\u72ec\u7acb\u7684\u5916\u90e8\u9879\u76ee\u3002\u800c <code>FetchContent</code> \u7528\u4e8e\u5728\u914d\u7f6e\u9636\u6bb5\u4e0b\u8f7d\u548c\u6dfb\u52a0\u5916\u90e8\u9879\u76ee\u7684\u6e90\u4ee3\u7801\u3002\u5b83\u9002\u7528\u4e8e\u9700\u8981\u5c06\u5916\u90e8\u9879\u76ee\u7684\u6e90\u4ee3\u7801\u76f4\u63a5\u96c6\u6210\u5230\u4e3b\u9879\u76ee\u4e2d\u7684\u60c5\u51b5\u3002\u540e\u6587\u5c06\u4e3b\u8981\u4ecb\u7ecd <code>FetchContent</code> \u7684\u4f7f\u7528\uff0c<code>ExternalProject</code> \u7684\u4f7f\u7528\u53ef\u4ee5\u53c2\u8003\u5b98\u65b9\u6587\u6863\u3002</p>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/11-%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/#21-fetchcontent","title":"2.1 <code>FetchContent</code>","text":"<p><code>FetchContent</code> \u4f9d\u8d56\u7ba1\u7406\u5b9a\u4e49\u4e8e <code>FetchContent</code> CMake \u6a21\u5757\u4e2d\uff0c\u53ef\u4f7f\u7528</p> <pre><code>include(FetchContent)\n</code></pre> <p>\u6765\u5f15\u5165\u3002<code>FetchContent</code> \u6a21\u5757\u63d0\u4f9b\u4e86 <code>FetchContent_Declare</code>\u3001<code>FetchContent_MakeAvailable</code> \u7b49\u51fd\u6570\uff0c\u7528\u4e8e\u4e0b\u8f7d\u3001\u89e3\u538b\u3001\u914d\u7f6e\u3001\u7f16\u8bd1\u3001\u5b89\u88c5\u5916\u90e8\u9879\u76ee\u3002</p>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/11-%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/#211-fetchcontent_declare","title":"2.1.1 <code>FetchContent_Declare</code>","text":"<p>\u2014\u2014 \u58f0\u660e\u5916\u90e8\u4f9d\u8d56\u9879</p> <pre><code>FetchContent_Declare(\n  &lt;name&gt;\n  &lt;contentOptions&gt;...\n  [EXCLUDE_FROM_ALL]          # add in CMake 3.28\n  [SYSTEM]                    # add in CMake 3.25\n  [OVERRIDE_FIND_PACKAGE |\n   FIND_PACKAGE_ARGS args...] # add in CMake 3.24\n)\n</code></pre> <p>\u4e0a\u8ff0\u58f0\u660e\u7684\u53ef\u9009\u9879\u5747\u4e0d\u662f\u5f88\u91cd\u8981\uff0c\u91cd\u8981\u7684\u662f <code>&lt;contentOptions&gt;</code>\u3002\u4ee5\u4e0b\u662f\u4f7f\u7528 <code>FetchContent_Declare</code> \u58f0\u660e <code>googletest</code> \u9879\u76ee\u7684\u793a\u4f8b\uff0c\u63d0\u4f9b\u4e86\u4e24\u79cd\u65b9\u5f0f\u58f0\u660e\u5916\u90e8\u4f9d\u8d56\u9879\uff0c\u4e00\u79cd\u662f\u4f7f\u7528 Git \u5b58\u50a8\u5e93\u4f5c\u4e3a\u5916\u90e8\u4f9d\u8d56\u9879\uff0c\u53e6\u4e00\u79cd\u662f\u4f7f\u7528 URL \u5730\u5740\u4f5c\u4e3a\u5916\u90e8\u4f9d\u8d56\u9879\u3002</p> <p>::: code-tabs</p> <p>@tab \u4f7f\u7528 Git \u5b58\u50a8\u5e93</p> <pre><code>FetchContent_Declare(\n  googletest\n  GIT_REPOSITORY https://github.com/google/googletest.git\n  GIT_TAG        703bd9caab50b139428cea1aaff9974ebee5742e # release-1.10.0\n)\n\n# GIT_REPOSITORY: \u8868\u793a\u5916\u90e8\u4f9d\u8d56\u9879\u7684 Git \u4ed3\u5e93\u5730\u5740\uff1b\n# GIT_TAG:        \u8868\u793a\u5916\u90e8\u4f9d\u8d56\u9879\u7684 Git \u4ed3\u5e93\u7684\u6807\u7b7e\uff0c\u53ef\u4ee5\u662f\u5206\u652f\u540d\u3001\u6807\u7b7e\u540d\u3001\u63d0\u4ea4\u54c8\u5e0c\u7b49\uff0c\n#                 \u4f46\u5efa\u8bae\u662f\u7a33\u5b9a\u7684\u6807\u7b7e\u540d\u9632\u6b62\u4e0d\u7a33\u5b9a\u7684\u4ee3\u7801\u8fdb\u5165\u9879\u76ee\u3002\n</code></pre> <p>@tab \u4f7f\u7528 URL \u5730\u5740</p> <pre><code>FetchContent_Declare(\n  googletest\n  URL https://github.com/google/googletest/archive/main.zip\n)\n\n# URL: \u8868\u793a\u5916\u90e8\u4f9d\u8d56\u9879\u7684 URL \u5730\u5740\u3002\n</code></pre> <p>:::</p>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/11-%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/#212-fetchcontent_makeavailable","title":"2.1.2 <code>FetchContent_MakeAvailable</code>","text":"<p>\u2014\u2014 \u4f7f\u5916\u90e8\u4f9d\u8d56\u9879\u751f\u6548\uff0c\u5e76\u52a0\u5165\u6784\u5efa\u7cfb\u7edf</p> <pre><code>FetchContent_MakeAvailable(&lt;name1&gt; [&lt;name2&gt;...])\n</code></pre> <p>\u8be5\u547d\u4ee4\u4fdd\u8bc1\u5728\u8c03\u7528\u7ed3\u675f\u540e\uff0c\u6bcf\u4e2a\u547d\u540d\u7684\u4f9d\u8d56\u9879\u90fd\u53ef\u4f9b\u9879\u76ee\u4f7f\u7528\u3002\u4f8b\u5982\u4e0a\u6587\u7684 <code>googletest</code> \u9879\u76ee\uff0c\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u65b9\u5f0f\u4f7f\u7528\uff1a</p> <pre><code>FetchContent_MakeAvailable(googletest)\n</code></pre> <p>\u5982\u679c\u6709\u591a\u4e2a\u5916\u90e8\u4f9d\u8d56\u9879\uff0c\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u65b9\u5f0f\u4f7f\u7528\uff1a</p> <pre><code>FetchContent_MakeAvailable(ext1 ext2 ext3)\n</code></pre> <p>\u8be5\u547d\u4ee4\u5c06\u4f9d\u6b21\u914d\u7f6e <code>ext1</code>\u3001<code>ext2</code> \u548c <code>ext3</code> \u9879\u76ee</p>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/11-%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/#213-fetchcontent","title":"2.1.3 <code>FetchContent</code> \u793a\u4f8b","text":"<p>\u6765\u81ea\u3010\u590d\u6742\u4f9d\u8d56\u3011</p> <pre><code>include(FetchContent)\nFetchContent_Declare(\n  projB\n  GIT_REPOSITORY git@mycompany.com:git/projB.git\n  GIT_TAG        4a89dc7e24ff212a7b5167bef7ab079d\n)\nFetchContent_Declare(\n  projC\n  GIT_REPOSITORY git@mycompany.com:git/projC.git\n  GIT_TAG        4ad4016bd1d8d5412d135cf8ceea1bb9\n)\nFetchContent_Declare(\n  projD\n  GIT_REPOSITORY git@mycompany.com:git/projD.git\n  GIT_TAG        origin/integrationBranch\n)\n\n# Order is important, see notes in the discussion further below\nFetchContent_MakeAvailable(projD projB projC)\n</code></pre>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/11-%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/#22","title":"2.2 \u9884\u671f\u76ee\u6807","text":"<p>\u73b0\u8ba1\u5212\u5f00\u53d1\u4e00\u4e2a Windows \u5e73\u53f0\u4e0b\u7684 OPC UA \u901a\u4fe1\u5e93 <code>opcua</code>\uff0c\u8be5\u5e93\u4f9d\u8d56\u4e8e <code>open62541</code>[^1]\uff0c<code>open62541</code> \u662f\u4e00\u4e2a\u5f00\u6e90\u7684 OPC UA \u534f\u8bae\u6808\uff0c\u63d0\u4f9b\u4e86 OPC UA \u670d\u52a1\u7aef\u548c\u5ba2\u6237\u7aef\u7684 C \u8bed\u8a00\u5b9e\u73b0\u3002<code>opcua</code> \u5e93\u7684\u5f00\u53d1\u9700\u8981\u5b9e\u73b0\u4ee5\u4e0b\u529f\u80fd\uff1a</p> <ol> <li>\u9700\u8981\u652f\u6301 C++17 \u6807\u51c6\uff1b</li> <li>\u5f3a\u5236\u4f9d\u8d56 <code>open62541</code>\uff0c\u6ca1\u6709\u8be5\u5e93\u9700\u8981\u81ea\u52a8\u4e0b\u8f7d\u3001\u5e76\u6dfb\u52a0\u81f3\u9879\u76ee\u4e2d\uff0c\u5982\u679c\u662f\u81ea\u52a8\u4e0b\u8f7d\u7684 <code>open62541</code>\uff0c\u90a3\u4e48 <code>opcua</code> \u5e93\u5728\u5b89\u88c5\u65f6\u9700\u8981\u5c06 <code>open62541</code> ==\u4e00\u5e76\u5b89\u88c5==\uff1b</li> <li><code>open62541</code> \u7684\u914d\u7f6e\u8981\u6c42\u5982\u4e0b</li> <li>==\u65e0\u9700==\u542f\u7528 <code>UA_ENABLE_AMALGAMATION</code> \u9009\u9879\uff1b</li> <li>\u5176\u4ed6\u9009\u9879\u9ed8\u8ba4\u5373\u53ef\uff1b</li> <li>\u9ed8\u8ba4\u4ee5\u9759\u6001\u5e93\u7684\u5f62\u5f0f\u6784\u5efa <code>opcua</code>\uff0c\u4f46\u5141\u8bb8\u7528\u6237\u901a\u8fc7 CMake \u9009\u9879\u8bbe\u7f6e\u6784\u5efa\u4e3a\u52a8\u6001\u5e93\uff1b</li> <li><code>opcua</code> \u9879\u76ee\u7684\u5b89\u88c5\u76ee\u5f55\u4e3a <code>D:\\opcua</code>\uff0c\u5176\u4e2d</li> <li>\u5934\u6587\u4ef6\u5b89\u88c5\u5230 <code>D:\\opcua\\include</code>\uff1b</li> <li>\u9759\u6001\u5e93\u3001\u5bfc\u5165\u5e93\u6587\u4ef6\u5b89\u88c5\u5230 <code>D:\\opcua\\x64\\vc16\\lib</code>\uff1b</li> <li>\u52a8\u6001\u5e93\u6587\u4ef6\u5b89\u88c5\u5230 <code>D:\\opcua\\x64\\vc16\\bin</code>\uff08\u5982\u679c\u6784\u5efa\u4e3a\u52a8\u6001\u5e93\uff09\uff1b</li> <li>CMake \u76f8\u5173\u914d\u7f6e\u6587\u4ef6\u5b89\u88c5\u5230 <code>D:\\opcua\\x64\\vc16\\bin</code>\uff1b</li> <li><code>open62541</code> \u7684\u5b89\u88c5\u8981\u6c42\u7531 <code>open62541Config.cmake</code> \u6307\u5b9a\u4e86\uff0c\u5177\u4f53\u5b89\u88c5\u8def\u5f84\u4e0d\u505a\u8be6\u7ec6\u8bf4\u660e\uff0c\u53ea\u9700\u4fdd\u8bc1 <code>open62541</code> \u7684\u5b89\u88c5\u8def\u5f84\u5728 <code>D:\\opcua</code> \u4e0b\u5373\u53ef\u3002</li> </ol>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/11-%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/#23","title":"2.3 \u6587\u4ef6\u7ed3\u6784","text":"<p>\u8be5\u9879\u76ee\u7684\u6587\u4ef6\u7ed3\u6784\u5982\u4e0b\uff0c\u53c2\u8003\u81ea rmvl_opcua \u6a21\u5757\u3002</p> <p>``` :collapsed-lines . \u251c\u2500\u2500 include \u2502\u00a0\u00a0 \u251c\u2500\u2500 opcua \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 client.hpp \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 event.hpp \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 method.hpp \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 object.hpp \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 publisher.hpp \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 server.hpp \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 subscriber.hpp \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 utilities.hpp \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 variable.hpp \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 view.hpp \u2502\u00a0\u00a0 \u2514\u2500\u2500 opcua.hpp \u2514\u2500\u2500 src     \u251c\u2500\u2500 client.cpp     \u251c\u2500\u2500 cvt.hpp     \u251c\u2500\u2500 helper.cpp     \u251c\u2500\u2500 publisher.cpp     \u251c\u2500\u2500 server.cpp     \u2514\u2500\u2500 subscriber.cpp</p> <p>6 directories, 19 files <pre><code>### 2.4 \u5b9e\u73b0\n\n\u5728\u9879\u76ee\u4e2d\u6dfb\u52a0\n\n- `3rdparty/open62541/CMakeLists.txt` \u2014\u2014 `open62541` \u7684\u914d\u7f6e\u6587\u4ef6\n- `CMakeLists.txt` \u2014\u2014 \u9879\u76ee\u6839\u76ee\u5f55\u7684 CMake \u914d\u7f6e\u6587\u4ef6\n- `cmake/opcuaInstall.cmake` \u2014\u2014 \u9879\u76ee\u7684\u5b89\u88c5\u8def\u5f84\u914d\u7f6e\u6587\u4ef6\n- `cmake/opcuaConfig.cmake` \u2014\u2014 \u63d0\u4f9b\u7ed9\u7528\u6237\u5728 `find_package` \u65f6\u6240\u9700\u8981\u7684\u914d\u7f6e\u6587\u4ef6\uff08\u56e0\u4e3a\u6574\u4e2a\u9879\u76ee\u53ea\u6709\u4e00\u4e2a\u76ee\u6807\uff0c\u8fd9\u91cc\u5c31\u4e0d\u4f7f\u7528\u6a21\u677f\u6587\u4ef6\u4e86\uff09\n\n\u5171 4 \u4e2a\u6587\u4ef6\uff0c\u5982\u4e0b\u6587\u4ef6\u7ed3\u6784\u6240\u793a\n</code></pre> . \u251c\u2500\u2500 3rdparty \u2502   \u2514\u2500\u2500 open62541 \u2502       \u2514\u2500\u2500 CMakeLists.txt (New) \u251c\u2500\u2500 CMakeLists.txt         (New) \u251c\u2500\u2500 cmake \u2502   \u251c\u2500\u2500 opcuaConfig.cmake  (New) \u2502   \u2514\u2500\u2500 opcuaInstall.cmake (New) \u251c\u2500\u2500 include \u2502   \u2514\u2500\u2500 ... \u2514\u2500\u2500 src     \u2514\u2500\u2500 ... <pre><code>#### 2.4.1 \u9879\u76ee\u914d\u7f6e\n\n::: code-tabs\n\n@tab CMakeLists.txt\n\n```cmake :collapsed-lines\n# --------------------------------------------------------\n#  \u9879\u76ee\u914d\u7f6e\n# --------------------------------------------------------\ncmake_minimum_required(VERSION 3.16)\nproject(opcua)\n\nset(CMAKE_CXX_STANDARD 17)\noption(BUILD_SHARED_LIBS \"Build shared libraries?\" OFF)\n\ninclude(cmake/opcuaInstall.cmake)\n\n# --------------------------------------------------------\n#  \u5916\u90e8\u4f9d\u8d56\u7ba1\u7406\n# --------------------------------------------------------\nfind_package(open62541 QUIET)\nif(NOT open62541_FOUND)\n  add_subdirectory(3rdparty/open62541)\nendif()\n\n# --------------------------------------------------------\n#  \u76ee\u6807\u6784\u5efa\n# --------------------------------------------------------\naux_source_directory(src target_src)\nadd_library(opcua ${target_src})\n\ntarget_include_directories(opcua PUBLIC\n  $&lt;BUILD_INTERFACE:${CMAKE_CURRENT_SOURCE_DIR}/include&gt;\n  $&lt;INSTALL_INTERFACE:include&gt;\n)\n\ntarget_link_libraries(opcua\n  PUBLIC open62541::open62541\n)\n\ninstall(\n  TARGETS opcua\n  EXPORT opcuaTarget\n  LIBRARY DESTINATION ${OPCUA_BIN_INSTALL_PATH}\n  ARCHIVE DESTINATION ${OPCUA_LIB_INSTALL_PATH}\n  RUNTIME DESTINATION ${OPCUA_BIN_INSTALL_PATH}\n  INCLUDES DESTINATION ${OPCUA_INC_INSTALL_PATH}\n)\n\n# --------------------------------------------------------\n#  \u5bfc\u51fa\u3001\u5b89\u88c5\n# --------------------------------------------------------\ninstall(\n  EXPORT opcuaTarget\n  FILE opcuaTarget.cmake\n  DESTINATION ${OPCUA_CFG_INSTALL_PATH}\n)\n\ninstall(\n  FILES cmake/opcuaConfig.cmake\n  DESTINATION ${OPCUA_CFG_INSTALL_PATH}\n)\n</code></pre></p> <p>@tab opcuaInstall.cmake</p> <pre><code>set(CMAKE_INSTALL_PREFIX \"D:/opcua\")\nset(OPCUA_INSTALL_PATH \"${CMAKE_INSTALL_PREFIX}\")\nset(OPCUA_INC_INSTALL_PATH \"include\")\nset(OPCUA_LIB_INSTALL_PATH \"x64/vc16/lib\")\nset(OPCUA_BIN_INSTALL_PATH \"x64/vc16/bin\")\n# \u7406\u8bba\u4e0a\u8fd9\u4e2a\u8def\u5f84\u8981\u6839\u636e MSVC \u7248\u672c\u548c\u7cfb\u7edf\u67b6\u6784\u6765\u786e\u5b9a\uff0c\u8fd9\u91cc\u53ea\u662f\u4e3e\u4f8b\uff0c\u5c31\u4e0d\u505a\u989d\u5916\u5224\u65ad\u4e86\nset(OPCUA_CFG_INSTALL_PATH \"${OPCUA_LIB_INSTALL_PATH}\")\n</code></pre> <p>:::</p>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/11-%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/#242","title":"2.4.2 \u5916\u90e8\u4f9d\u8d56\u914d\u7f6e","text":"<p>::: code-tabs</p> <p>@tab 3rdparty/open62541/CMakeLists.txt</p> <pre><code>option(UA_ENABLE_AMALGAMATION \"Enable amalgamation\" OFF)\n\nFetchContent_Declare(\n  open62541\n  GIT_REPOSITORY https://github.com/open62541/open62541.git\n  GIT_TAG        v1.4.8\n)\n\nFetchContent_MakeAvailable(open62541)\n</code></pre> <p>:::</p>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/11-%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/#244-opcuaconfigcmake","title":"2.4.4 opcuaConfig.cmake \u914d\u7f6e","text":"<p>\u7531\u4e8e <code>opcua</code> \u9879\u76ee\u53ea\u6709\u4e00\u4e2a\u76ee\u6807\uff0c\u56e0\u6b64 <code>opcuaConfig.cmake</code> \u6587\u4ef6\u975e\u5e38\u7b80\u5355\uff0c\u65b9\u4fbf\u8d77\u89c1\u4e5f\u4e0d\u9700\u8981\u5411\u7528\u6237\u63d0\u4f9b\u8bf8\u5982 <code>opcua_INCLUDE_DIRS</code> \u548c <code>opcua_LIBS</code> \u8fd9\u6837\u7684\u96c6\u5408\u53d8\u91cf\uff0c\u56e0\u6b64 <code>opcuaConfig.cmake</code> \u53ea\u9700\u8981\u5b8c\u6210\u4ee5\u4e0b\u529f\u80fd\u5373\u53ef</p> <ul> <li>\u63d0\u4f9b CMake \u76ee\u6807\u53d8\u91cf\uff08\u5bfc\u5165 <code>opcua</code> \u76ee\u6807\uff09</li> <li>\u63d0\u4f9b <code>find_package</code> \u641c\u7d22\u7684\u7ed3\u679c\u548c\u72b6\u6001</li> </ul> <p>::: code-tabs</p> <p>@tab opcuaConfig.cmake</p> <pre><code># ----------------------------------------------------------------------------\n#  opcua CMake \u914d\u7f6e\u6587\u4ef6\n#\n#  \u57fa\u672c\u7528\u6cd5\uff1a\n#    find_package(opcua REQUIRED)\n#    target_link_libraries(your_target PRIVATE opcua)\n# ----------------------------------------------------------------------------\n\nif(NOT TARGET opcua)\n  include(${CMAKE_CURRENT_LIST_DIR}/opcuaTarget.cmake)\nendif()\n\ninclude(FindPackageHandleStandardArgs)\nfind_package_handle_standard_args(opcua)\n</code></pre> <p>:::</p>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/11-%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/#3","title":"3. \u4ea4\u53c9\u7f16\u8bd1\u9879\u76ee","text":"<p>CPU \u6709\u4e0d\u540c\u7684\u67b6\u6784\u3001\u6307\u4ee4\u96c6\uff0cC/C++ \u5f00\u53d1\u4e2d\u7684\u4ee3\u7801\u7f16\u8bd1\u540e\u7684\u53ef\u6267\u884c\u6587\u4ef6\uff0c\u5728\u4e0d\u540c\u7684 CPU \u4e0a\u76f4\u63a5\u8fd0\u884c\u65f6\u53ef\u80fd\u4f1a\u51fa\u73b0\u95ee\u9898\u3002\u5bf9\u6b64\u6709\u4e24\u79cd\u89e3\u51b3\u65b9\u6848\uff1a</p> <ul> <li>\u5728\u76ee\u6807\u5e73\u53f0\u4e0a\u76f4\u63a5\u7f16\u8bd1\u4ee3\u7801\uff0c\u4f8b\u5982\u4e3a\u4e86\u5728 64 \u4f4d ARM \u5e73\u53f0\u4e0a\u8fd0\u884c\u4ee3\u7801\uff0c\u53ef\u4ee5\u76f4\u63a5\u5728 <code>aarch64</code> \u5e73\u53f0\u4e0a\u7f16\u8bd1\u4ee3\u7801\u3002\u4f46\u4e00\u822c\u6765\u8bf4\uff0cARM \u5e73\u53f0\u5e38\u89c1\u4e8e\u5d4c\u5165\u5f0f\u8bbe\u5907\uff0c\u8fd9\u7c7b\u8bbe\u5907\u53ef\u80fd\u7f3a\u5c11\u7f16\u8bd1\u5de5\u5177\u94fe\uff0c\u5728\u6027\u80fd\u4e0a\u4e5f\u975e\u5e38\u6709\u9650\uff0c\u56e0\u6b64\u8fd9\u79cd\u65b9\u5f0f\u5e76\u4e0d\u9002\u7528\u4e8e\u6240\u6709\u60c5\u51b5\u3002</li> <li>\u76f4\u63a5\u5728 PC \u4e0a\u7f16\u8bd1\u76ee\u6807\u5e73\u53f0\u7684\u4ee3\u7801\uff0c\u7136\u540e\u5c06\u7f16\u8bd1\u597d\u7684\u4ee3\u7801\u79fb\u690d\uff08\u590d\u5236\u7c98\u8d34\uff09\u5230\u76ee\u6807\u5e73\u53f0\u4e0a\u8fd0\u884c\u3002\u8fd9\u79cd\u65b9\u5f0f\u79f0\u4e3a==\u4ea4\u53c9\u7f16\u8bd1==\uff0c\u5728\u5d4c\u5165\u5f0f Linux \u5f00\u53d1\u4e2d\u975e\u5e38\u5e38\u89c1\uff0c\u4f8b\u5982\u5728 <code>amd64</code> \u5e73\u53f0\u4e0a\u7f16\u8bd1 ARM \u5e73\u53f0\u7684\u4ee3\u7801\u3002</li> </ul>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/11-%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/#31","title":"3.1 \u5de5\u5177\u94fe\u6587\u4ef6\u7684\u7f16\u5199","text":"<p>CMake \u63d0\u4f9b\u4e86\u5f3a\u5927\u7684\u4ea4\u53c9\u7f16\u8bd1\u652f\u6301\uff0c\u800c\u4e14\u4ec5\u9700\u4e00\u4e2a==\u5de5\u5177\u94fe\u6587\u4ef6==\u5373\u53ef\u5b8c\u6210\u4ea4\u53c9\u7f16\u8bd1\u7684\u5de5\u4f5c\u3002\u5de5\u5177\u94fe\u6587\u4ef6\u662f\u4e00\u4e2a CMake \u811a\u672c\uff0c\u7528\u4e8e\u6307\u5b9a\u4ea4\u53c9\u7f16\u8bd1\u7684\u5de5\u5177\u94fe\uff0c\u4f8b\u5982\u7f16\u8bd1\u5668\u3001\u94fe\u63a5\u5668\u3001\u5e93\u6587\u4ef6\u8def\u5f84\u7b49\u3002\u5de5\u5177\u94fe\u6587\u4ef6\u6ca1\u6709\u4e25\u683c\u7684\u547d\u540d\u89c4\u5219\uff0c\u5c31\u5982\u540c\u666e\u901a\u7684 <code>*.cmake</code> \u6587\u4ef6\u4e00\u6837\uff0c\u4e0d\u8fc7\u4e00\u822c\u4e60\u60ef\u4e0a\u4f1a\u5728\u5de5\u5177\u94fe\u6587\u4ef6\u7684\u540d\u5b57\u4e2d\u63d0\u5230\u5e73\u53f0\u6216 <code>toolchain</code> \u5b57\u6837\uff0c\u5728 CMake \u914d\u7f6e\u8fc7\u7a0b\u4e2d\uff0c\u4f7f\u7528 <code>-DCMAKE_TOOLCHAIN_FILE</code> \u9009\u9879\u6307\u5b9a\u5de5\u5177\u94fe\u6587\u4ef6\uff0c\u4f8b\u5982</p> <pre><code>cmake -DCMAKE_TOOLCHAIN_FILE=toolchain-aarch64.cmake ..\n</code></pre> <p>\u4e00\u822c\u6765\u8bf4\uff0c\u5de5\u5177\u94fe\u6587\u4ef6\u7684\u5185\u5bb9\u5982\u4e0b\uff1a</p> <pre><code># \u6307\u5b9a\u76ee\u6807\u7cfb\u7edf\nset(CMAKE_SYSTEM_NAME Linux)\n# \u6307\u5b9a\u76ee\u6807\u5904\u7406\u5668\u67b6\u6784\nset(CMAKE_SYSTEM_PROCESSOR aarch64)\n\n# \u6307\u5b9a\u76ee\u6807\u7cfb\u7edf\u7684\u6839\u76ee\u5f55\uff0c\u5c06\u76f4\u63a5\u5f71\u54cd\u7f16\u8bd1\u5668\u548c\u94fe\u63a5\u5668\u7684\u884c\u4e3a\nset(CMAKE_SYSROOT \"/path/to/sysroot\")\n\n# \u6307\u5b9a C \u4ea4\u53c9\u7f16\u8bd1\u5668\nset(CMAKE_C_COMPILER \"/path/to/arm-gcc\")\n# \u6307\u5b9a C++ \u4ea4\u53c9\u7f16\u8bd1\u5668\nset(CMAKE_CXX_COMPILER \"/path/to/arm-g++\")\n\n# \u6307\u5b9a CMake \u67e5\u627e\u6587\u4ef6\u7684\u8def\u5f84\uff0c\u4f8b\u5982 find_package\nset(CMAKE_FIND_ROOT_PATH \"/path/to/sysroot\")\n# \u4e0d\u67e5\u627e\u7a0b\u5e8f\nset(CMAKE_FIND_ROOT_PATH_MODE_PROGRAM NEVER)\n# \u53ea\u67e5\u627e\u5e93\nset(CMAKE_FIND_ROOT_PATH_MODE_LIBRARY ONLY)\n# \u53ea\u67e5\u627e\u5934\u6587\u4ef6\nset(CMAKE_FIND_ROOT_PATH_MODE_INCLUDE ONLY)\n</code></pre>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/11-%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/#32","title":"3.2 \u9884\u671f\u76ee\u6807","text":"<p>\u73b0\u8ba1\u5212\u5f00\u53d1\u4e00\u4e2a EtherCAT \u534f\u8bae\u7684\u673a\u68b0\u81c2\u9a71\u52a8\u7a0b\u5e8f <code>ec_robot</code>\uff0c\u8be5\u7a0b\u5e8f\u9700\u8981\u5728 aarch64 \u67b6\u6784\u7684 Linux \u5e73\u53f0\u4e0b\u8fd0\u884c\uff0c<code>ec_robot</code> \u9879\u76ee\u7684\u5f00\u53d1\u9700\u8981\u5b9e\u73b0\u4ee5\u4e0b\u529f\u80fd\uff1a</p> <ol> <li>\u9700\u8981\u4f7f\u7528\u6307\u5b9a\u7684\u5de5\u5177\u94fe\u8fdb\u884c\u4ea4\u53c9\u7f16\u8bd1\uff0c\u76ee\u6807\u7cfb\u7edf\u6839\u76ee\u5f55\u5047\u8bbe\u5728 <code>/home/ecdev/buildroot/host/</code> \u4e0b</li> <li>C \u4ea4\u53c9\u7f16\u8bd1\u5668\u4e3a <code>aarch64-linux-gnu-gcc</code>\uff0c\u4f4d\u4e8e\u76ee\u6807\u7cfb\u7edf\u6839\u76ee\u5f55\u7684 <code>/usr/bin</code> \u76ee\u5f55\u4e0b\uff1b</li> <li>C++ \u4ea4\u53c9\u7f16\u8bd1\u5668\u4e3a <code>aarch64-linux-gnu-g++</code>\uff0c\u4f4d\u4e8e\u76ee\u6807\u7cfb\u7edf\u6839\u76ee\u5f55\u7684 <code>/usr/bin</code> \u76ee\u5f55\u4e0b\uff1b</li> <li>\u9700\u8981\u652f\u6301 C++17 \u6807\u51c6\uff1b</li> <li>\u5f3a\u5236\u4f9d\u8d56 IgH \u5b9e\u73b0\u7684 <code>EtherCAT</code> \u4e3b\u7ad9\u9a71\u52a8\u5e93\uff0c\u5bf9\u5e94\u7684\u914d\u7f6e\u6587\u4ef6\u5728 <code>/home/ecdev/buildroot/host/usr/lib/cmake/ethercat</code> \u4e0b\uff0c\u5bf9\u5e94\u7684\u76ee\u6807\u540d\u4e3a <code>EtherLab::EtherCAT</code>\uff1b</li> <li><code>ec_robot</code> \u9879\u76ee==\u65e0\u9700==\u5b89\u88c5\uff0c\u53ea\u9700\u6784\u5efa\u5373\u53ef\u3002</li> <li>\u6ca1\u6709\u590d\u6742\u7684\u6587\u4ef6\u7ed3\u6784\uff0c\u672c\u9879\u76ee\u53ea\u6709\u4e00\u4e2a <code>src</code> \u76ee\u5f55\uff0c\u5185\u5bb9\u5982\u4e0b\uff1a</li> </ol> <pre><code>.\n\u2514\u2500\u2500 src\n    \u251c\u2500\u2500 ec_robot.cpp\n    \u251c\u2500\u2500 ec_robot.hpp\n    \u2514\u2500\u2500 main.cpp\n</code></pre>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/11-%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/#33","title":"3.3 \u5206\u6790","text":"<ul> <li>\u9700\u8981\u5b9e\u73b0\u4e00\u4e2a\u5de5\u5177\u94fe\u6587\u4ef6 <code>toolchain-aarch64.cmake</code>\uff0c\u7528\u4e8e\u6307\u5b9a\u4ea4\u53c9\u7f16\u8bd1\u7684\u5de5\u5177\u94fe\uff1b</li> <li><code>EtherCATConfig.cmake</code> \u6587\u4ef6\u5728 <code>find_package</code> \u7684 Config \u6a21\u5f0f\u80fd\u591f\u76f4\u63a5\u627e\u5230\u7684\u4f4d\u7f6e\uff0c\u524d\u63d0\u662f\u5de5\u5177\u94fe\u6587\u4ef6\u4e2d\u7684 <code>CMAKE_FIND_ROOT_PATH</code> \u8bbe\u7f6e\u6b63\u786e\uff1b</li> <li>\u9879\u76ee\u9664\u4e86\u5de5\u5177\u94fe\u6587\u4ef6\u5916\uff0c\u53ea\u9700\u8981\u4e00\u4e2a <code>CMakeLists.txt</code> \u6587\u4ef6\uff0c\u5e76\u4e14\u6784\u5efa\u65b9\u5f0f\u548c\u666e\u901a\u9879\u76ee\u4e00\u6837\u3002</li> </ul>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/11-%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/#34","title":"3.4 \u5b9e\u73b0","text":"<p>\u5728\u9879\u76ee\u4e2d\u6dfb\u52a0</p> <ul> <li><code>platform/toolchain-aarch64.cmake</code> \u2014\u2014 \u4ea4\u53c9\u7f16\u8bd1\u5de5\u5177\u94fe\u6587\u4ef6</li> <li><code>CMakeLists.txt</code> \u2014\u2014 \u9879\u76ee\u6839\u76ee\u5f55\u7684 CMake \u914d\u7f6e\u6587\u4ef6</li> </ul> <p>\u5171 2 \u4e2a\u6587\u4ef6\uff0c\u5982\u4e0b\u6587\u4ef6\u7ed3\u6784\u6240\u793a</p> <pre><code>.\n\u251c\u2500\u2500 CMakeLists.txt              (New)\n\u251c\u2500\u2500 src\n\u2502   \u251c\u2500\u2500 ec_robot.cpp\n\u2502   \u251c\u2500\u2500 ec_robot.hpp\n\u2502   \u2514\u2500\u2500 main.cpp\n\u2514\u2500\u2500 platform\n    \u2514\u2500\u2500 toolchain-aarch64.cmake (New)\n</code></pre> <p>::: code-tabs</p> <p>@tab CMakeLists.txt</p> <p>```cmake :collapsed-lines cmake_minimum_required(VERSION 3.16)</p> <p>project(ec_robot)</p> <p>set(CMAKE_CXX_STANDARD 17)</p> <p>find_package(EtherCAT REQUIRED)</p> <p>aux_source_directory(src target_src) add_executable(ec_robot ${target_src})</p> <p>target_link_libraries(ec_robot   PRIVATE EtherLab::EtherCAT ) <pre><code>@tab platform/toolchain-aarch64.cmake\n\n```cmake\nset(CMAKE_SYSTEM_NAME Linux)\nset(CMAKE_SYSTEM_PROCESSOR aarch64)\n\nset(CMAKE_SYSROOT \"/home/ecdev/buildroot/host\")\n\nset(CMAKE_C_COMPILER \"/home/ecdev/buildroot/host/usr/bin/aarch64-linux-gnu-gcc\")\nset(CMAKE_CXX_COMPILER \"/home/ecdev/buildroot/host/usr/bin/aarch64-linux-gnu-g++\")\n\nset(CMAKE_FIND_ROOT_PATH \"/home/ecdev/buildroot/host\")\nset(CMAKE_FIND_ROOT_PATH_MODE_PROGRAM NEVER)\nset(CMAKE_FIND_ROOT_PATH_MODE_LIBRARY ONLY)\nset(CMAKE_FIND_ROOT_PATH_MODE_INCLUDE ONLY)\n</code></pre></p> <p>:::</p> <p>\u4e0d\u8981\u60ca\u8bb6\u4e3a\u4ec0\u4e48 <code>CMakeLists.txt</code> \u4e2d\u6ca1\u6709\u5f15\u7528\u5de5\u5177\u94fe\u6587\u4ef6\uff0c\u56e0\u4e3a\u4e60\u60ef\u4e0a\u4f1a\u5728 CMake \u6267\u884c\u914d\u7f6e\u751f\u6210\u8fc7\u7a0b\u65f6\u518d\u6307\u5b9a\u5de5\u5177\u94fe\u6587\u4ef6\u3002</p> <p>\u6253\u5f00\u9879\u76ee\u6839\u76ee\u5f55\uff0c\u5728\u547d\u4ee4\u884c\u4e2d\u6267\u884c</p> <pre><code>mkdir build\ncmake -B build -S . -DCMAKE_TOOLCHAIN_FILE=platform/toolchain-aarch64.cmake\ncmake --build build\n</code></pre> <p>\u5373\u53ef\u5b8c\u6210\u7f16\u8bd1\u3002\u53ef\u80fd\u6709\u90e8\u5206\u8bfb\u8005\u6ca1\u6709\u89c1\u8fc7 <code>-B</code> \u548c <code>-S</code> \u9009\u9879\uff0c\u8fd9\u662f CMake 3.13 \u7248\u672c\u5f15\u5165\u7684\u529f\u80fd\u3002<code>-B</code> \u9009\u9879\u7528\u4e8e\u6307\u5b9a\u6784\u5efa\u76ee\u5f55\uff0c<code>-S</code> \u9009\u9879\u7528\u4e8e\u6307\u5b9a\u6e90\u7801\u76ee\u5f55\uff0c\u8fd9\u6837\u53ef\u4ee5\u5c06\u6784\u5efa\u76ee\u5f55\u548c\u6e90\u7801\u76ee\u5f55\u5206\u5f00\uff0c\u907f\u514d\u5728\u6e90\u7801\u76ee\u5f55\u4e2d\u751f\u6210\u6784\u5efa\u6587\u4ef6\u3002</p> <p>\u7f16\u8bd1\u540e\u7684\u53ef\u6267\u884c\u6587\u4ef6\u5728 <code>build</code> \u76ee\u5f55\u4e0b\uff0c\u53ef\u4ee5\u76f4\u63a5\u590d\u5236\u5230\u76ee\u6807\u5e73\u53f0\u4e0a\u8fd0\u884c\uff0c\u4f8b\u5982\u53ef\u4ee5\u4f7f\u7528 SSH \u5de5\u5177\u7684 <code>scp</code> \u547d\u4ee4\u5c06\u6587\u4ef6\u590d\u5236\u5230\u76ee\u6807\u5e73\u53f0\u4e0a\uff0c\u4f46\u8981\u786e\u4fdd\u76ee\u6807\u5e73\u53f0\u6709 <code>libethercat.so</code> \u7684\u5e93\u6587\u4ef6\uff0c\u5e76\u4e14\u4fdd\u8bc1\u590d\u5236\u540e\u7684\u53ef\u6267\u884c\u6587\u4ef6\u80fd\u591f\u627e\u5230\u3002</p>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/11-%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/#4","title":"4. \u8de8\u5e73\u53f0\u9879\u76ee","text":"<p>\u4ea4\u53c9\u7f16\u8bd1\u9879\u76ee\u867d\u7136\u6d89\u53ca\u5230\u4e0d\u540c\u7684\u5e73\u53f0\uff0c\u4f46\u662f\u53ea\u9700\u8981\u4e00\u4e2a\u5de5\u5177\u94fe\u6587\u4ef6\u5373\u53ef\uff0c\u56e0\u4e3a\u5927\u90e8\u5206\u4ea4\u53c9\u7f16\u8bd1\u9879\u76ee\u90fd\u53ea\u6d89\u53ca Linux \u5185\u6838\uff0c\u53ea\u4e0d\u8fc7\u6d89\u53ca\u5230\u4e0d\u540c\u7684 CPU \u67b6\u6784\u3001OS\u3001\u6587\u4ef6\u7cfb\u7edf\uff0c\u800c\u8de8\u5e73\u53f0\u9879\u76ee\u5219\u9700\u8981\u8003\u8651\u4e0d\u540c\u5e73\u53f0\u7684\u5dee\u5f02\uff0c\u4f8b\u5982 Windows \u548c Linux \u4e24\u4e2a\u5e73\u53f0\u7684\u5dee\u5f02\u5c31\u975e\u5e38\u5927\u3002</p> <p>\u8de8\u5e73\u53f0\u662f\u9879\u76ee\u5f00\u53d1\u7684\u4e00\u4e2a\u91cd\u8981\u65b9\u5411\uff0c\u6309\u7167 ISO \u6807\u51c6\u7f16\u5199\u7684 C++ \u7a0b\u5e8f\u8de8\u5e73\u53f0\u6027\u8f83\u597d\uff0c\u4f46\u662f\u5728\u5b9e\u9645\u5f00\u53d1\u4e2d\uff0c\u5f80\u5f80\u4f1a\u4f7f\u7528\u4e00\u4e9b\u5e73\u53f0\u76f8\u5173\u6216\u8005\u662f\u7f16\u8bd1\u5668\u76f8\u5173\u7684 API\uff0c\u8fd9\u5c31\u5bfc\u81f4\u4e86\u8de8\u5e73\u53f0\u7684\u56f0\u96be\u3002\u4f7f\u7528 CMake \u5b8c\u6210\u8de8\u5e73\u53f0\u9879\u76ee\u7684\u5f00\u53d1\u662f\u4e00\u4e2a\u4e0d\u9519\u7684\u9009\u62e9\uff0cCMake \u63d0\u4f9b\u4e86\u5f88\u591a\u5de5\u5177\u548c\u51fd\u6570\uff0c\u53ef\u4ee5\u5e2e\u52a9\u5f00\u53d1\u8005\u66f4\u597d\u7684\u5b9e\u73b0\u8de8\u5e73\u53f0\u9879\u76ee\u3002\u4e00\u822c\u6765\u8bf4\uff0c\u8de8\u5e73\u53f0\u9879\u76ee\u7684\u5f00\u53d1\u9700\u8981\u8003\u8651\u4ee5\u4e0b\u51e0\u4e2a\u65b9\u9762\uff1a</p> <ul> <li>\u7f16\u8bd1\u5668\u7684\u7f16\u8bd1\u9009\u9879\u4e0d\u540c\uff0c\u4f8b\u5982\u7528\u4e8e\u63a7\u5236 C++ \u8bed\u8a00\u6807\u51c6\u7684\u9009\u9879\uff0c\u5728 GCC \u4e2d\u662f <code>-std=c++&lt;ver&gt;</code>\uff0c\u5728 MSVC \u4e2d\u662f <code>/std:c++&lt;ver&gt;</code>\uff1b</li> </ul> <p>::: important   \u4e0d\u8fc7\u5728 CMake \u4e2d\uff0c\u53ef\u4ee5\u4f7f\u7528 <code>CMAKE_CXX_STANDARD</code> \u53d8\u91cf\u6765\u6307\u5b9a C++ \u6807\u51c6\uff0cCMake \u4f1a\u6839\u636e\u4e0d\u540c\u7684\u7f16\u8bd1\u5668\u81ea\u52a8\u9009\u62e9\u6b63\u786e\u7684\u7f16\u8bd1\u9009\u9879\uff0c\u8fd9\u91cc\u53ea\u662f\u4e3e\u4e2a\u4f8b\u5b50\u3002   :::</p> <ul> <li>\u4e0d\u540c\u5e73\u53f0\u7684\u5e93\u6587\u4ef6\u540e\u7f00\u540d\u4e0d\u540c\uff0c\u4f8b\u5982 Windows \u4e0b\u7684\u9759\u6001\u5e93\u6587\u4ef6\u540e\u7f00\u540d\u662f <code>*.lib</code>\uff0cLinux \u4e0b\u7684\u9759\u6001\u5e93\u6587\u4ef6\u540e\u7f00\u540d\u662f <code>*.a</code>\uff0c\u5e76\u4e14\u5e93\u6587\u4ef6\u7684\u7ec4\u7ec7\u65b9\u5f0f\u4e5f\u4e0d\u540c\uff0cWindows \u4e0b\u5728\u94fe\u63a5\u52a8\u6001\u5e93\u65f6\u9700\u8981\u4f7f\u7528\u5bfc\u5165\u5e93 <code>*.lib</code>\uff0cLinux \u4e0b\u5728\u94fe\u63a5\u52a8\u6001\u5e93\u65f6\u5219\u76f4\u63a5\u4f7f\u7528\u52a8\u6001\u5e93 <code>*.so</code>\u3002</li> <li>\u9ed8\u8ba4\u5b89\u88c5\u8def\u5f84\u4e0d\u540c\uff0cWindows \u4e0b\u7684\u9ed8\u8ba4\u5b89\u88c5\u8def\u5f84\u662f <code>C:\\Program Files</code>\uff0cLinux \u4e0b\u7684\u9ed8\u8ba4\u5b89\u88c5\u8def\u5f84\u662f <code>/usr/local</code>\uff0c\u4f46 Windows \u4e0d\u5efa\u8bae\u76f4\u63a5\u5b89\u88c5\u5230 <code>C:\\Program Files</code>\uff0c\u800c Linux \u5219\u6ca1\u6709\u8fc7\u591a\u7684\u9650\u5236\u3002</li> </ul>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/11-%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/#41","title":"4.1 \u9884\u671f\u76ee\u6807","text":"<p>\u73b0\u8ba1\u5212\u5f00\u53d1\u4e00\u4e2a\u8de8\u5e73\u53f0\u7684\u57fa\u7840\u6570\u503c\u7b97\u6cd5\u548c\u6700\u4f18\u5316\u5e93 <code>numopt</code>\uff0c\u8be5\u5e93\u9700\u8981\u652f\u6301 Windows \u548c Linux \u4e24\u4e2a\u5e73\u53f0\uff0c<code>numopt</code> \u9879\u76ee\u7684\u5f00\u53d1\u9700\u8981\u5b9e\u73b0\u4ee5\u4e0b\u529f\u80fd\uff1a</p> <ol> <li>\u9700\u8981\u652f\u6301 C++17 \u6807\u51c6\uff1b</li> <li>\u9ed8\u8ba4\u4ee5\u9759\u6001\u5e93\u7684\u5f62\u5f0f\u6784\u5efa <code>numopt</code>\uff0c\u4f46\u5141\u8bb8\u7528\u6237\u901a\u8fc7 CMake \u9009\u9879\u8bbe\u7f6e\u6784\u5efa\u4e3a\u52a8\u6001\u5e93\uff1b</li> <li>\u5e93\u5305\u542b\u4e86 <code>core</code>\u3001<code>num</code> \u548c <code>opt</code> 3 \u4e2a\u6a21\u5757\u548c <code>numopt_version</code> 1 \u4e2a\u53ef\u6267\u884c\u6587\u4ef6\uff0c\u5176\u4e2d <code>num</code> \u548c <code>opt</code> \u4f9d\u8d56 <code>core</code> \u6a21\u5757\uff0c<code>numopt_version</code> \u4f9d\u8d56 <code>core</code> \u6a21\u5757\uff1b</li> <li><code>numopt</code> \u9879\u76ee\u7684\u9ed8\u8ba4\u5b89\u88c5\u76ee\u5f55\u5982\u4e0b</li> </ol> \u5185\u5bb9 Window \u5b89\u88c5\u8def\u5f84 Linux \u5b89\u88c5\u8def\u5f84 \u9879\u76ee\u6839\u76ee\u5f55 <code>${CMAKE_BINARY_DIR}/install</code> \u8bb0\u4f5c <code>&lt;prefix&gt;</code> <code>/usr/local</code> \u8bb0\u4f5c <code>&lt;prefix&gt;</code> \u5934\u6587\u4ef6 <code>&lt;prefix&gt;\\include</code> <code>&lt;prefix&gt;/include/numopt</code> \u53ef\u6267\u884c\u6587\u4ef6 <code>&lt;prefix&gt;\\x64\\vc16\\bin</code> <code>&lt;prefix&gt;/bin</code> \u9759\u6001\u5e93\u6587\u4ef6 <code>&lt;prefix&gt;\\x64\\vc16\\lib</code> <code>&lt;prefix&gt;/lib</code> \u52a8\u6001\u5e93\u6587\u4ef6 <code>&lt;prefix&gt;\\x64\\vc16\\bin</code> <code>&lt;prefix&gt;/lib</code> \u5bfc\u5165\u5e93\u6587\u4ef6 <code>&lt;prefix&gt;\\x64\\vc16\\lib</code> \u2014\u2014 CMake \u914d\u7f6e\u6587\u4ef6 <code>&lt;prefix&gt;\\x64\\vc16\\lib</code> <code>&lt;prefix&gt;/lib/cmake/numopt</code> <ol> <li>\u9700\u8981\u63d0\u4f9b <code>uninstall</code> \u76ee\u6807\uff0c\u7528\u4e8e\u5378\u8f7d\u5df2\u5b89\u88c5\u7684\u6587\u4ef6\uff0c\u5728\u6267\u884c</li> </ol> <pre><code>cmake --build . --target uninstall\n</code></pre> <p>\u540e\uff0c\u5b89\u88c5\u76ee\u5f55\u4e0b\u7684\u6587\u4ef6\u90fd\u4f1a\u88ab\u5220\u9664\u3002</p> <p>\u6587\u4ef6\u7ed3\u6784\u5982\u4e0b\uff1a</p> <p>``` :collapsed-lines . \u251c\u2500\u2500 modules \u2502   \u251c\u2500\u2500 core \u2502   \u2502   \u251c\u2500\u2500 include \u2502   \u2502   \u2502   \u2514\u2500\u2500 ... \u2502   \u2502   \u2514\u2500\u2500 src \u2502   \u2502       \u2514\u2500\u2500 ... \u2502   \u251c\u2500\u2500 num \u2502   \u2502   \u251c\u2500\u2500 include \u2502   \u2502   \u2502   \u2514\u2500\u2500 ... \u2502   \u2502   \u2514\u2500\u2500 src \u2502   \u2502       \u2514\u2500\u2500 ... \u2502   \u2514\u2500\u2500 opt \u2502       \u251c\u2500\u2500 include \u2502       \u2502   \u2514\u2500\u2500 ... \u2502       \u2514\u2500\u2500 src \u2502           \u2514\u2500\u2500 ... \u2514\u2500\u2500 samples     \u2514\u2500\u2500 version.cpp <pre><code>### 4.2 \u5b9e\u73b0\n\n\u5728\u9879\u76ee\u6784\u5efa\u90e8\u5206\u548c[\u5e38\u89c4\u975e\u8de8\u5e73\u53f0\u9879\u76ee](#_1-\u5e38\u89c4\u975e\u8de8\u5e73\u53f0\u9879\u76ee)\u4e00\u81f4\uff0c\u53ea\u662f\u5728\u5b89\u88c5\u90e8\u5206\u9700\u8981\u8003\u8651\u4e0d\u540c\u5e73\u53f0\u7684\u5dee\u5f02\uff0c\u56e0\u6b64\u8de8\u5e73\u53f0\u9879\u76ee\u53ea\u662f\u6bd4\u5e38\u89c4\u9879\u76ee\u591a\u4e86\u4e00\u4e9b\u5e73\u53f0\u76f8\u5173\u7684\u914d\u7f6e\u3002\n\n\u548c\u5e38\u89c4\u975e\u8de8\u5e73\u53f0\u9879\u76ee\u4e00\u6837\uff0c\u5728\u9879\u76ee\u4e2d\u6dfb\u52a0\n\n- `modules/core/CMakeLists.txt` \u2014\u2014 `core` \u6a21\u5757\u7684 CMake \u914d\u7f6e\u6587\u4ef6\n- `modules/num/CMakeLists.txt` \u2014\u2014 `num` \u6a21\u5757\u7684 CMake \u914d\u7f6e\u6587\u4ef6\n- `modules/opt/CMakeLists.txt` \u2014\u2014 `opt` \u6a21\u5757\u7684 CMake \u914d\u7f6e\u6587\u4ef6\n- `modules/CMakelists.txt` \u2014\u2014 \u9879\u76ee\u7684\u6a21\u5757\u5217\u8868\n- `samples/CMakeLists.txt` \u2014\u2014 \u793a\u4f8b\u7a0b\u5e8f\u7684 CMake \u914d\u7f6e\u6587\u4ef6\n- `CMakeLists.txt` \u2014\u2014 \u9879\u76ee\u6839\u76ee\u5f55\u7684 CMake \u914d\u7f6e\u6587\u4ef6\n- `cmake/numoptInstall.cmake` \u2014\u2014 \u4e0e\u9879\u76ee\u5b89\u88c5\u8def\u5f84\u76f8\u5173\u7684\u914d\u7f6e\u6587\u4ef6\n- `cmake/templates/numoptConfig.cmake.in` \u2014\u2014 \u9879\u76ee\u7684 CMake \u914d\u7f6e\u6587\u4ef6\u7684\u6a21\u677f\u6587\u4ef6\n- `cmake/templates/cmake_uninstall.cmake.in` \u2014\u2014 \u81ea\u5b9a\u4e49\u5378\u8f7d\u76ee\u6807\u7684\u6a21\u677f\u6587\u4ef6\n\n\u5171 7 \u4e2a\u6587\u4ef6\uff0c\u5982\u4e0b\u6587\u4ef6\u7ed3\u6784\u6240\u793a\n\n``` :collapsed-lines\n.\n\u251c\u2500\u2500 CMakeLists.txt                   (New)\n\u251c\u2500\u2500 cmake\n\u2502   \u251c\u2500\u2500 numoptInstall.cmake          (New)\n\u2502   \u2514\u2500\u2500 templates\n\u2502       \u251c\u2500\u2500 cmake_uninstall.cmake.in (New)\n\u2502       \u2514\u2500\u2500 numoptConfig.cmake.in    (New)\n\u251c\u2500\u2500 modules\n\u2502   \u251c\u2500\u2500 core\n\u2502   \u2502   \u251c\u2500\u2500 CMakeLists.txt           (New)\n\u2502   \u2502   \u251c\u2500\u2500 include\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 ...\n\u2502   \u2502   \u2514\u2500\u2500 src\n\u2502   \u2502       \u2514\u2500\u2500 ...\n\u2502   \u251c\u2500\u2500 num\n\u2502   \u2502   \u251c\u2500\u2500 CMakeLists.txt           (New)\n\u2502   \u2502   \u251c\u2500\u2500 include\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 ...\n\u2502   \u2502   \u2514\u2500\u2500 src\n\u2502   \u2502       \u2514\u2500\u2500 ...\n\u2502   \u251c\u2500\u2500 opt\n\u2502   \u2502   \u251c\u2500\u2500 CMakeLists.txt           (New)\n\u2502   \u2502   \u251c\u2500\u2500 include\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 ...\n\u2502   \u2502   \u2514\u2500\u2500 src\n\u2502   \u2502       \u2514\u2500\u2500 ...\n\u2502   \u2514\u2500\u2500 CMakeLists.txt               (New)\n\u2514\u2500\u2500 samples\n    \u251c\u2500\u2500 CMakeLists.txt               (New)\n    \u2514\u2500\u2500 version.cpp\n</code></pre></p> <p>\u65b9\u4fbf\u8d77\u89c1\uff0c\u5c31\u4e0d\u6dfb\u52a0\u7c7b\u4f3c\u4e8e <code>vl_add_module</code> \u548c <code>vl_add_exe</code> \u7684\u5b8f\u4e86\u3002</p>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/11-%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/#421","title":"4.2.1 \u9879\u76ee\u914d\u7f6e","text":"<p>::: code-tabs</p> <p>@tab CMakeLists.txt</p> <p>```cmake :collapsed-lines</p>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/11-%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/#-_6","title":"----------------------------------------------------------------------------","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/11-%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/#_13","title":"\u9879\u76ee\u914d\u7f6e","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/11-%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/#-_7","title":"---------------------------------------------------------------------------- <p>cmake_minimum_required(VERSION 3.16)</p> <p>project(   numopt   LANGUAGES CXX )</p> <p>set(CMAKE_CXX_STANDARD 17)</p> <p>option(BUILD_SHARED_LIBS \"Build shared libraries?\" OFF)</p> <p>include(cmake/numoptInstall.cmake)</p>","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/11-%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/#-_8","title":"----------------------------------------------------------------------------","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/11-%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/#_14","title":"\u76ee\u6807\u6784\u5efa","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/11-%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/#-_9","title":"----------------------------------------------------------------------------","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/11-%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/#main-target","title":"main target <p>add_subdirectory(modules)</p>","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/11-%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/#executable-target","title":"executable target <p>add_subdirectory(samples)</p>","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/11-%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/#uninstall-target","title":"uninstall target <p>if(NOT TARGET uninstall)   configure_file(     \"${CMAKE_CURRENT_SOURCE_DIR}/cmake/templates/cmake_uninstall.cmake.in\"     \"${CMAKE_CURRENT_BINARY_DIR}/cmake_uninstall.cmake\"     IMMEDIATE @ONLY   )</p> <p>add_custom_target(uninstall     COMMAND ${CMAKE_COMMAND} -P ${CMAKE_CURRENT_BINARY_DIR}/cmake_uninstall.cmake   ) endif()</p>","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/11-%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/#-_10","title":"----------------------------------------------------------------------------","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/11-%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/#_15","title":"\u5bfc\u51fa\u3001\u5b89\u88c5","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/11-%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/#-_11","title":"---------------------------------------------------------------------------- <p>install(   EXPORT numoptModules   DESTINATION ${NUMOPT_CFG_INSTALL_PATH}   FILE numoptModules.cmake )</p> <p>file(RELATIVE_PATH NUMOPT_INSTALL_RELATIVE_PATH    \"${CMAKE_INSTALL_PREFIX}/${NUMOPT_CFG_INSTALL_PATH}/\" ${CMAKE_INSTALL_PREFIX})</p> <p>configure_file(   cmake/numoptConfig.cmake.in   \"${CMAKE_CURRENT_BINARY_DIR}/numoptConfig.cmake\"   @ONLY )</p> <p>install(   FILES \"${CMAKE_CURRENT_BINARY_DIR}/numoptConfig.cmake\"   DESTINATION ${NUMOPT_CFG_INSTALL_PATH} ) <pre><code>@tab cmake/numoptInstall.cmake\n\n```cmake :collapsed-lines\n# ----------------------------------------------------------\n#  \u9879\u76ee\u5b89\u88c5\u8def\u5f84\u7684\u9884\u5148\u914d\u7f6e\n# ----------------------------------------------------------\nif(NOT CMAKE_TOOLCHAIN_FILE)\n  if(WIN32)\n    set(CMAKE_INSTALL_PREFIX \"${CMAKE_BINARY_DIR}/install\")\n  else()\n    set(CMAKE_INSTALL_PREFIX \"/usr/local\")\n  endif()\nelse()\n  # \u4ea4\u53c9\u7f16\u8bd1\u65f6\u7684\u5b89\u88c5\u8def\u5f84\n  set(CMAKE_INSTALL_PREFIX \"${CMAKE_BINARY_DIR}/install\")\nendif()\n\n# ----------------------------------------------------------\n#  MSVC \u5b89\u88c5\u8def\u5f84\u7684\u9884\u5148\u914d\u7f6e\n# ----------------------------------------------------------\nif(MSVC)\n  if(\"${CMAKE_GENERATOR}\" MATCHES \"(Win64|IA64)\")\n    set(ARCH_forMSVC \"x64\")\n  elseif(\"${CMAKE_GENERATOR_PLATFORM}\" MATCHES \"ARM64\")\n    set(ARCH_forMSVC \"ARM64\")\n  elseif(\"${CMAKE_GENERATOR}\" MATCHES \"ARM\")\n    set(ARCH_forMSVC \"ARM\")\n  elseif(\"${CMAKE_SIZEOF_VOID_P}\" STREQUAL \"8\")\n    set(ARCH_forMSVC \"x64\")\n  else()\n    set(ARCH_forMSVC x86)\n  endif()\n\n  if(MSVC_VERSION EQUAL 1400)\n    set(RUNTIME_forMSVC vc8)\n  elseif(MSVC_VERSION EQUAL 1500)\n    set(RUNTIME_forMSVC vc9)\n  elseif(MSVC_VERSION EQUAL 1600)\n    set(RUNTIME_forMSVC vc10)\n  elseif(MSVC_VERSION EQUAL 1700)\n    set(RUNTIME_forMSVC vc11)\n  elseif(MSVC_VERSION EQUAL 1800)\n    set(RUNTIME_forMSVC vc12)\n  elseif(MSVC_VERSION EQUAL 1900)\n    set(RUNTIME_forMSVC vc14)\n  elseif(MSVC_VERSION MATCHES \"^191[0-9]$\")\n    set(RUNTIME_forMSVC vc15)\n  elseif(MSVC_VERSION MATCHES \"^192[0-9]$\")\n    set(RUNTIME_forMSVC vc16)\n  elseif(MSVC_VERSION MATCHES \"^19[34][0-9]$\")\n    set(RUNTIME_forMSVC vc17)\n  endif()\nendif()\n\n# ----------------------------------------------------------\n#  \u5b89\u88c5\u8def\u5f84\u8bbe\u7f6e\n# ----------------------------------------------------------\nif(MSVC)\n  if(DEFINED ARCH_forMSVC AND DEFINED RUNTIME_forMSVC)\n    set(MSVC_INSTALL_PREFIX \"${ARCH_forMSVC}/${RUNTIME_forMSVC}\")\n  else()\n    set(MSVC_INSTALL_PREFIX \"\")\n  endif()\n\n  set(NUMOPT_INC_INSTALL_PATH \"include\")\n  set(NUMOPT_LIB_INSTALL_PATH \"${MSVC_INSTALL_PREFIX}/lib\")\n  set(NUMOPT_BIN_INSTALL_PATH \"${MSVC_INSTALL_PREFIX}/bin\")\n  set(NUMOPT_CFG_INSTALL_PATH \"${MSVC_INSTALL_PREFIX}/lib\")\nelseif()\n  set(NUMOPT_INC_INSTALL_PATH \"include/numopt\")\n  set(NUMOPT_LIB_INSTALL_PATH \"lib\")\n  set(NUMOPT_BIN_INSTALL_PATH \"bin\")\n  set(NUMOPT_CFG_INSTALL_PATH \"lib/cmake/numopt\")\nendif()\n</code></pre></p> <p>:::</p>","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/11-%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/#422","title":"4.2.2 \u6a21\u5757\u914d\u7f6e","text":"<p><code>modules</code> \u76ee\u5f55\u4e0b\u7684 <code>CMakeLists.txt</code> \u548c\u5404\u4e2a\u6a21\u5757\u7684 <code>CMakeLists.txt</code> \u6587\u4ef6\u5982\u4e0b\uff1a</p> <p>::: code-tabs</p> <p>@tab modules</p> <pre><code>add_subdirectory(core)\nadd_subdirectory(num)\nadd_subdirectory(opt)\n</code></pre> <p>@tab <code>core</code> \u6a21\u5757</p> <p>```cmake :collapsed-lines aux_source_directory(src core_src)</p> <p>add_library(core ${core_src})</p> <p>target_include_directories(core PUBLIC   $   $ ) <p>install(TARGETS core   LIBRARY DESTINATION ${NUMOPT_BIN_INSTALL_PATH}   ARCHIVE DESTINATION ${NUMOPT_LIB_INSTALL_PATH}   RUNTIME DESTINATION ${NUMOPT_BIN_INSTALL_PATH}   INCLUDES DESTINATION ${NUMOPT_INC_INSTALL_PATH} ) <pre><code>@tab `num` \u6a21\u5757\n\n```cmake :collapsed-lines\naux_source_directory(src num_src)\n\nadd_library(num ${num_src})\n\ntarget_include_directories(num PUBLIC\n  $&lt;BUILD_INTERFACE:${CMAKE_CURRENT_SOURCE_DIR}/include&gt;\n  $&lt;INSTALL_INTERFACE:${NUMOPT_INC_INSTALL_PATH}&gt;\n)\n\ntarget_link_libraries(num PUBLIC core)\n\ninstall(TARGETS num\n  LIBRARY DESTINATION ${NUMOPT_BIN_INSTALL_PATH}\n  ARCHIVE DESTINATION ${NUMOPT_LIB_INSTALL_PATH}\n  RUNTIME DESTINATION ${NUMOPT_BIN_INSTALL_PATH}\n  INCLUDES DESTINATION ${NUMOPT_INC_INSTALL_PATH}\n)\n</code></pre></p> <p>@tab <code>opt</code> \u6a21\u5757</p> <p>```cmake :collapsed-lines aux_source_directory(src opt_src)</p> <p>add_library(opt ${opt_src})</p> <p>target_include_directories(opt PUBLIC   $   $ ) <p>target_link_libraries(opt PUBLIC core)</p> <p>install(TARGETS opt   LIBRARY DESTINATION ${NUMOPT_BIN_INSTALL_PATH}   ARCHIVE DESTINATION ${NUMOPT_LIB_INSTALL_PATH}   RUNTIME DESTINATION ${NUMOPT_BIN_INSTALL_PATH}   INCLUDES DESTINATION ${NUMOPT_INC_INSTALL_PATH} ) <pre><code>:::\n\n::: tip\n\u7531\u4e8e\u6ca1\u6709\u4f7f\u7528\u5b8f\uff0c`core` \u6a21\u5757\u3001`num` \u6a21\u5757\u548c `opt` \u6a21\u5757\u7684\u914d\u7f6e\u5199\u4e86\u5927\u91cf\u7684\u91cd\u590d\u4ee3\u7801\uff0c\u53ef\u8bfb\u6027\u964d\u4f4e\u3002\u56e0\u6b64\u5728\u5fc5\u8981\u65f6\u5019\u4f7f\u7528\u5b8f\u662f\u4e00\u4e2a\u4e0d\u9519\u7684\u9009\u62e9\u3002\u8fd9\u91cc\u5c31\u4e0d\u518d\u5c55\u793a\u5b8f\u7684\u4f7f\u7528\uff0c\u8bfb\u8005\u53ef\u4ee5\u6309\u7167[\u5e38\u89c4\u975e\u8de8\u5e73\u53f0\u9879\u76ee\u914d\u7f6e](#_1-4-1-\u9879\u76ee\u914d\u7f6e)\u4e2d\u7684\u5185\u5bb9\u81ea\u884c\u6dfb\u52a0\u5b8f\u3002\n:::\n\n#### 4.2.3 \u793a\u4f8b\u7a0b\u5e8f\u914d\u7f6e\n\n::: code-tabs\n\n@tab samples/CMakeLists.txt\n\n```cmake :collapsed-lines\nadd_executable(numopt_version version.cpp)\n\ntarget_link_libraries(numopt_version PRIVATE core)\n</code></pre></p> <p>:::</p>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/11-%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/#424-cmake","title":"4.2.4 CMake \u914d\u7f6e\u6587\u4ef6\u6a21\u677f","text":"<p><code>cmake_uninstall.cmake.in</code> \u6587\u4ef6\u53c2\u8003\u81ea\u6b64\u5904\uff0c\u7528\u6237\u5728\u5b9e\u9645\u4f7f\u7528\u65f6\u6700\u597d\u52a0\u4e0a\u51fa\u5904\u3002</p> <p>::: code-tabs</p> <p>@tab numoptConfig.cmake.in</p> <p>```cmake :collapsed-lines</p>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/11-%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/#-_12","title":"----------------------------------------------------------------------------","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/11-%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/#numopt-cmake","title":"numopt CMake \u914d\u7f6e\u6587\u4ef6","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/11-%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/#_16","title":"","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/11-%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/#cmake","title":"** \u8be5\u6587\u4ef6\u7531 CMake \u751f\u6210\uff0c\u8bf7\u52ff\u624b\u52a8\u4fee\u6539 **","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/11-%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/#_17","title":"","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/11-%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/#_18","title":"\u57fa\u672c\u7528\u6cd5\uff1a","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/11-%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/#find_packagenumopt-required","title":"find_package(numopt REQUIRED)","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/11-%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/#target_link_librariesyour_target-private-numopt_libs","title":"target_link_libraries(your_target PRIVATE ${numopt_LIBS})","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/11-%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/#-_13","title":"----------------------------------------------------------------------------","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/11-%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/#-_14","title":"----------------------------------------------------------------------------","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/11-%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/#numopt","title":"\u83b7\u53d6 numopt \u5b89\u88c5\u8def\u5f84","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/11-%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/#-_15","title":"---------------------------------------------------------------------------- <p>get_filename_component(NUMOPT_CONFIG_PATH \"${CMAKE_CURRENT_LIST_FILE}\" PATH) get_filename_component(NUMOPT_INSTALL_PATH   \"${NUMOPT_CONFIG_PATH}/@NUMOPT_INSTALL_RELATIVE_PATH@\" REALPATH )</p>","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/11-%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/#-_16","title":"----------------------------------------------------------------------------","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/11-%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/#_19","title":"\u8bbe\u7f6e\u5934\u6587\u4ef6\u641c\u7d22\u8def\u5f84\u53d8\u91cf","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/11-%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/#-_17","title":"---------------------------------------------------------------------------- <p>set(numopt_INCLUDE_DIRS \"${NUMOPT_INSTALL_PATH}/@NUMOPT_INC_INSTALL_PATH@\")</p>","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/11-%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/#-_18","title":"----------------------------------------------------------------------------","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/11-%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/#_20","title":"\u8bbe\u7f6e\u5e93\u6587\u4ef6\u8def\u5f84\u53d8\u91cf","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/11-%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/#-_19","title":"---------------------------------------------------------------------------- <p>set(numopt_LIBS @NUMOPT_LIB_COMPONENTS@)</p> <p>if(NOT TARGET core)   include(\"${NUMOPT_CONFIG_PATH}/numoptModules.cmake\") endif()</p>","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/11-%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/#-_20","title":"----------------------------------------------------------------------------","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/11-%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/#_21","title":"\u641c\u5bfb\u7684\u7ed3\u679c\u3001\u72b6\u6001","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/11-%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/#-_21","title":"---------------------------------------------------------------------------- <p>include(FindPackageHandleStandardArgs)</p> <p>find_package_handle_standard_args(numopt   REQUIRED_VARS numopt_INSTALL_PATH ) <pre><code>@tab cmake_uninstall.cmake.in\n\n```cmake :collapsed-lines\n# -----------------------------------------------\n# File that provides \"make uninstall\" target\n# We use the file 'install_manifest.txt'\n#\n# Details:\n# https://gitlab.kitware.com/cmake/community/-/wikis/FAQ#can-i-do-make-uninstall-with-cmake\n# -----------------------------------------------\n\nif(NOT EXISTS \"@CMAKE_BINARY_DIR@/install_manifest.txt\")\n  message(FATAL_ERROR\n    \"Cannot find install manifest: \\\"@CMAKE_BINARY_DIR@/install_manifest.txt\\\"\"\n  )\nendif()\n\nfile(READ \"@CMAKE_BINARY_DIR@/install_manifest.txt\" files)\nstring(REGEX REPLACE \"\\n\" \";\" files \"${files}\")\nforeach(file ${files})\n  message(STATUS \"Uninstalling: $ENV{DESTDIR}${file}\")\n  if(IS_SYMLINK \"$ENV{DESTDIR}${file}\" OR EXISTS \"$ENV{DESTDIR}${file}\")\n    execute_process(\n      COMMAND \"@CMAKE_COMMAND@\" \"-E\" \"remove\" \"$ENV{DESTDIR}${file}\"\n      OUTPUT_VARIABLE rm_out\n      RESULT_VARIABLE rm_retval\n    )\n    if(NOT \"${rm_retval}\" STREQUAL 0)\n      message(FATAL_ERROR \"Problem when removing $ENV{DESTDIR}${file}\")\n    endif()\n  else(IS_SYMLINK \"$ENV{DESTDIR}${file}\" OR EXISTS \"$ENV{DESTDIR}${file}\")\n    message(STATUS \"File $ENV{DESTDIR}${file} does not exist.\")\n  endif()\nendforeach()\n</code></pre></p> <p>:::</p>","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/11-%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/#43-visual-studio","title":"4.3 \u9488\u5bf9 Visual Studio \u7684\u7279\u6b8a\u8bbe\u8ba1","text":"<p>\u5bf9\u4e8e\u591a\u4e2a\u76ee\u6807\u7684\u9879\u76ee\uff0c\u4f1a\u751f\u6210\u591a\u4e2a\u5e93\u6587\u4ef6\uff0c\u4f8b\u5982\u672c <code>numopt</code> \u9879\u76ee\uff0c\u5728 Windows \u4e0b\u4f1a\u751f\u6210 <code>core.lib</code>\u3001<code>num.lib</code> \u548c <code>opt.lib</code> 3 \u4e2a\u5e93\u6587\u4ef6\uff0c\u5728 Visual Studio \u4e2d\uff0c\u5229\u7528\u8fd9 3 \u4e2a\u5e93\u6587\u4ef6\u8fdb\u884c\u5f00\u53d1\uff0c\u9700\u8981\u518d\u9879\u76ee\u4e2d\u624b\u52a8\u6dfb\u52a0\uff0c\u8fd9\u6837\u4f1a\u589e\u52a0\u5f00\u53d1\u8005\u7684\u5de5\u4f5c\u91cf\u3002\u4e3a\u4e86\u7b80\u5316\u5f00\u53d1\u8005\u7684\u5de5\u4f5c\uff0c\u53ef\u4ee5\u5c06\u8fd9 3 \u4e2a\u5e93\u6587\u4ef6\u6253\u5305\u6210\u4e00\u4e2a <code>numopt_world.lib</code> \u6587\u4ef6\uff0c\u8fd9\u6837\u5f00\u53d1\u8005\u53ea\u9700\u8981\u6dfb\u52a0\u4e00\u4e2a\u5e93\u6587\u4ef6\u5373\u53ef\u3002</p> <p>\u4f8b\u5982 OpenCV \u539f\u5148\u4f1a\u751f\u6210 <code>opencv_core.lib</code>\u3001<code>opencv_imgproc.lib</code> \u4ee5\u53ca <code>opencv_highgui.lib</code> \u7b49\u5bfc\u5165\u5e93\u6587\u4ef6\uff0c\u5728\u542f\u7528 <code>BUILD_opencv_world</code> \u9009\u9879\u540e\uff0c\u5219\u4e0d\u518d\u751f\u6210\u539f\u5148\u7684\u5e93\u6587\u4ef6\uff0c\u800c\u662f\u751f\u6210\u4e00\u4e2a <code>opencv_world.lib</code> \u5bfc\u5165\u5e93\u6587\u4ef6\u3002\u8fd9\u65f6\u5f00\u53d1\u8005\u5728\u4f7f\u7528 Visual Studio \u5bf9\u9879\u76ee\u7684\u5bfc\u5165\u5e93\u8fdb\u884c\u914d\u7f6e\u7684\u65f6\u5019\uff0c\u53ea\u9700\u6dfb\u52a0 <code>opencv_world.lib</code> \u8be5\u5bfc\u5165\u5e93\u6587\u4ef6\u7684\u8def\u5f84\u548c\u540d\u5b57\u5373\u53ef\u3002</p> <p>\u4e00\u4e2a\u7b80\u5355\u7684\u5b9e\u73b0\u65b9\u5f0f\u662f\u5728 <code>core</code>\u3001<code>num</code> \u548c <code>opt</code> \u6a21\u5757\u7684 <code>CMakeLists.txt</code> \u6587\u4ef6\u4e2d\u6dfb\u52a0\u5224\u65ad\uff0c\u4e0b\u9762\u4ee5 <code>core</code> \u6a21\u5757\u4e3a\u4f8b\uff1a</p> <pre><code>if(NOT BUILD_WORLD)\n  # \u539f\u5148\u7684\u914d\u7f6e\nelse()\n  aux source_directory(src core_src)\n  set(NUMOPT_SRC \"${NUMOPT_SRCS} ${core_src}\" CACHE INTERNAL \"\")\n  set(NUMOPT_INC \"${NUMOPT_INC} ${CMAKE_CURRENT_SOURCE_DIR}/include\" CACHE INTERNAL \"\")\n  # \u7531\u4e8e\u6ca1\u6709\u5916\u90e8\u4f9d\u8d56\u5e93\uff0c\u6240\u4ee5\u5c31\u4e0d\u5199 NUMOPT_LIB \u4e86\nendif()\n</code></pre> <p>\u4fee\u6539\u9879\u76ee\u7684\u6839\u76ee\u5f55\u7684 <code>CMakeLists.txt</code> \u6587\u4ef6</p> <p>```cmake :collapsed-lines</p>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/11-%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/#_22","title":"...","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/11-%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/#-_22","title":"----------------------------------------------------------------------------","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/11-%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/#_23","title":"\u76ee\u6807\u6784\u5efa","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/11-%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/#-_23","title":"---------------------------------------------------------------------------- <p>if(BUILD_WORLD)   set(NUMOPT_SRC \"\" CACHE INTERNAL \"\")   set(NUMOPT_INC \"\" CACHE INTERNAL \"\")   # \u7531\u4e8e\u6ca1\u6709\u5916\u90e8\u4f9d\u8d56\u5e93\uff0c\u6240\u4ee5\u5c31\u4e0d\u5199 NUMOPT_LIB \u4e86 endif()</p> <p>add_subdirectory(modules) add_subdirectory(samples)</p> <p>if(BUILD_WORLD)   add_library(numopt_world ${NUMOPT_SRC})   target_include_directories(numopt_world PUBLIC     $     $   ) endif()","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/11-%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/#_24","title":"... <pre><code>\u8fd8\u6709\u4e00\u79cd\u5b9e\u73b0\u65b9\u5f0f\u662f\u4f7f\u7528[\u5bf9\u8c61\u5e93](05-\u76ee\u6807\u6784\u5efa.md#_3-1-1-\u5bf9\u8c61\u5e93)\uff0c\u5c06 `core`\u3001`num` \u548c `opt` \u6a21\u5757\u7684\u6e90\u6587\u4ef6\u7f16\u8bd1\u6210\u5bf9\u8c61\u6587\u4ef6\uff0c\u7136\u540e\u518d\u5c06\u8fd9\u4e9b\u5bf9\u8c61\u6587\u4ef6\u94fe\u63a5\u6210\u4e00\u4e2a\u5e93\u6587\u4ef6\u3002\u4f8b\u5982\n\n```cmake\nadd_library(core_obj OBJECT ${core_src})\n</code></pre> <p>\u5f00\u53d1\u8005\u53ef\u4ee5\u81ea\u884c\u589e\u52a0 <code>if</code> \u5224\u65ad\uff0c\u6839\u636e\u81ea\u5df1\u7684\u9700\u6c42\u6765\u9009\u62e9\u5408\u9002\u7684\u5b9e\u73b0\u65b9\u5f0f\u3002</p> <p>\u4f7f\u7528\u5f62\u5982\u4ee5\u4e0b\u7684\u4ee3\u7801\u6765\u5b89\u88c5\uff1a</p> <p>::: code-tabs</p> <p>@tab <code>core</code> \u6a21\u5757</p> <pre><code>add_library(core_obj OBJECT ${core_src})\n\ninstall(TARGETS core_obj\n  EXPORT numoptModules\n)\n</code></pre> <p>@tab <code>num</code> \u6a21\u5757</p> <pre><code>add_library(num_obj OBJECT ${num_src})\n\ninstall(TARGETS num_obj\n  EXPORT numoptModules\n)\n</code></pre> <p>@tab <code>opt</code> \u6a21\u5757</p> <pre><code>add_library(opt_obj OBJECT ${opt_src})\n\ninstall(TARGETS opt_obj\n  EXPORT numoptModules\n)\n</code></pre> <p>:::</p> <p>\u4e0d\u8fc7\uff0c\u5bf9\u8c61\u5e93\u7b49\u6548\u4e8e\u5b89\u88c5\u4e00\u4e2a\u63a5\u53e3\u5e93\uff0c\u5b89\u88c5\u63a5\u53e3\u5e93\u7684\u6548\u679c\u53ef\u4ee5\u53c2\u8003\u301010\u3011\u9879\u76ee\u7684\u5bfc\u51fa\u4e0e\u5b89\u88c5 - \u601d\u8003\u4e2d\u7684\u7b2c 2 \u4e2a\u95ee\u9898\uff0c\u56e0\u6b64\u5728\u5bfc\u51fa\u914d\u7f6e\u6587\u4ef6\u4e2d\u4e5f\u5177\u6709\u76f8\u5e94\u7684\u4fe1\u606f\uff0c\u4f8b\u5982 <code>numoptModules.cmake</code> \u5bfc\u51fa\u914d\u7f6e\u6587\u4ef6\u4e2d\u4f1a\u5305\u542b\u5927\u81f4\u5982\u4e0b\u5185\u5bb9</p> <pre><code># Create imported target core_obj\nadd_library(core_obj INTERFACE IMPORTED)\n\n# Create imported target num_obj\nadd_library(num_obj INTERFACE IMPORTED)\n\n# Create imported target opt_obj\nadd_library(opt_obj INTERFACE IMPORTED)\n</code></pre> <p>::: warning \u5982\u679c\u5e0c\u671b\u5728 <code>numoptModules.cmake</code> \u5bfc\u51fa\u914d\u7f6e\u6587\u4ef6\u4e2d\u53ea\u5305\u542b\u4e00\u4e2a <code>numopt_world</code> \u76ee\u6807\u800c\u4e0d\u5305\u542b <code>core_obj</code> \u7b49\u7531\u5bf9\u8c61\u5e93\u5bfc\u51fa\u751f\u6210\u7684\u63a5\u53e3\u5e93\uff0c\u53ef\u4ee5\u4f7f\u7528\u7b2c\u4e00\u79cd\u65b9\u6848\u3002 :::</p>","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/11-%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/#_25","title":"\u5199\u5728\u540e\u9762","text":"<p>\u6709\u5173 CMake \u9879\u76ee\u5b9e\u6218\u7684\u5185\u5bb9\u53ef\u4ee5\u53c2\u8003 RMVL[^2] \u9879\u76ee\u7684 CMake \u6846\u67b6\uff0c\u672c\u6587\u6d89\u53ca\u5230\u7684</p> <ul> <li>\u5e38\u89c4\u76ee\u6807\u6784\u5efa\u7684\u5185\u5bb9</li> <li>\u5916\u90e8\u4f9d\u8d56\u7ba1\u7406\u7684\u5185\u5bb9</li> <li>\u4ea4\u53c9\u7f16\u8bd1\u7684\u5185\u5bb9</li> <li>\u8de8\u5e73\u53f0\u7684\u5185\u5bb9</li> </ul> <p>\u5bf9\u5e94\u7684 CMake \u914d\u7f6e\uff0c\u90fd\u80fd\u5728 RMVL \u9879\u76ee\u4e2d\u627e\u5230\u3002</p> <p>[^1]: open62541 developers. open62541, September 2014. [^2]: zhaoxi and other RMVL developers. rmvl, September 2023.</p>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/12-CTest%20%E5%B7%A5%E5%85%B7/","title":"\u301012\u3011CTest \u5de5\u5177","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/12-CTest%20%E5%B7%A5%E5%85%B7/#1","title":"1. \u524d\u8a00","text":"<p>CMake \u63d0\u4f9b\u4e86\u4e00\u4e2a\u540d\u4e3a CTest \u7684\u5de5\u5177\uff0c\u7528\u4e8e\u7ba1\u7406\u548c\u8fd0\u884c\u6d4b\u8bd5\u7528\u4f8b\u3002\u4e3b\u8981\u529f\u80fd\u6709</p> <ul> <li>\u81ea\u52a8\u53d1\u73b0\u548c\u8fd0\u884c\u6d4b\u8bd5</li> <li>\u5e76\u884c\u6d4b\u8bd5\u6267\u884c</li> <li>\u6d4b\u8bd5\u7ed3\u679c\u6536\u96c6\u548c\u62a5\u544a</li> </ul> <p>::: tip</p> <p>\u6d4b\u8bd5\u4e00\u822c\u5206\u4e3a\u4ee5\u4e0b\u51e0\u79cd\u7c7b\u578b\uff1a</p> <ul> <li>\u5355\u5143\u6d4b\u8bd5 \u2014\u2014 \u5b83\u662f\u5bf9\u8f6f\u4ef6\u4e2d\u7684\u6700\u5c0f\u53ef\u6d4b\u8bd5\u5355\u5143\u8fdb\u884c\u68c0\u67e5\u548c\u9a8c\u8bc1\u7684\u8fc7\u7a0b\u3002\u5355\u5143\u6d4b\u8bd5\u901a\u5e38\u662f\u7531\u5f00\u53d1\u4eba\u5458\u7f16\u5199\u7684\uff0c\u7528\u4e8e\u9a8c\u8bc1\u4ee3\u7801\u7684\u6b63\u786e\u6027\u3002\u5355\u5143\u6d4b\u8bd5\u7684\u76ee\u7684\u662f\u786e\u4fdd\u4ee3\u7801\u7684\u6bcf\u4e2a\u90e8\u5206\u90fd\u80fd\u6b63\u5e38\u5de5\u4f5c\uff0c\u4ece\u800c\u63d0\u9ad8\u4ee3\u7801\u7684\u8d28\u91cf\u3002\u5355\u5143\u6d4b\u8bd5\u4e00\u822c\u9694\u79bb\u6027\u5f3a\uff0c\u4e0d\u4f9d\u8d56\u5916\u90e8\u7ec4\u4ef6\u3002</li> <li>\u96c6\u6210\u6d4b\u8bd5 \u2014\u2014 \u5b83\u662f\u5bf9\u8f6f\u4ef6\u4e2d\u7684\u591a\u4e2a\u6a21\u5757\u8fdb\u884c\u8054\u5408\u6d4b\u8bd5\u7684\u8fc7\u7a0b\u3002\u96c6\u6210\u6d4b\u8bd5\u901a\u5e38\u662f\u7531\u6d4b\u8bd5\u4eba\u5458\u548c\u5f00\u53d1\u4eba\u5458\u5171\u540c\u7f16\u5199\u7684\uff0c\u7528\u4e8e\u9a8c\u8bc1\u8f6f\u4ef6\u7684\u6574\u4f53\u529f\u80fd\u3002\u96c6\u6210\u6d4b\u8bd5\u7684\u76ee\u7684\u662f\u786e\u4fdd\u8f6f\u4ef6\u7684\u5404\u4e2a\u6a21\u5757\u80fd\u591f\u534f\u540c\u5de5\u4f5c\uff0c\u4ece\u800c\u63d0\u9ad8\u8f6f\u4ef6\u7684\u8d28\u91cf\u3002\u96c6\u6210\u6d4b\u8bd5\u4e00\u822c\u9700\u8981\u6d4b\u8bd5\u73af\u5883\u3002</li> <li>\u7cfb\u7edf\u6d4b\u8bd5 \u2014\u2014 \u5b83\u662f\u5bf9\u8f6f\u4ef6\u7684\u6574\u4f53\u529f\u80fd\u8fdb\u884c\u6d4b\u8bd5\u7684\u8fc7\u7a0b\u3002\u7cfb\u7edf\u6d4b\u8bd5\u901a\u5e38\u662f\u7531\u6d4b\u8bd5\u4eba\u5458\u7f16\u5199\u7684\uff0c\u7528\u4e8e\u9a8c\u8bc1\u8f6f\u4ef6\u7684\u6574\u4f53\u529f\u80fd\u3002\u7cfb\u7edf\u6d4b\u8bd5\u7684\u76ee\u7684\u662f\u786e\u4fdd\u8f6f\u4ef6\u7684\u6574\u4f53\u529f\u80fd\u80fd\u591f\u6ee1\u8db3\u7528\u6237\u7684\u9700\u6c42\u3002\u7cfb\u7edf\u6d4b\u8bd5\u4e00\u822c\u9700\u8981\u5b8c\u6574\u7684\u6d4b\u8bd5\u73af\u5883\uff0c\u4e3b\u8981\u5728\u529f\u80fd\u3001\u6027\u80fd\u3001\u8d1f\u8f7d\u3001\u5b89\u5168\u7b49\u65b9\u9762\u8fdb\u884c\u6d4b\u8bd5\u3002</li> </ul> <p>:::</p>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/12-CTest%20%E5%B7%A5%E5%85%B7/#2-ctest","title":"2. CTest \u7684\u57fa\u672c\u4ecb\u7ecd","text":"<p>\u5728\u5b89\u88c5 CMake \u7684\u540c\u65f6\uff0cCTest \u4e5f\u4f1a\u88ab\u5b89\u88c5\u3002\u56e0\u6b64\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u5728 <code>CMakeLists.txt</code> \u6587\u4ef6\u4e2d\u4f7f\u7528 CTest \u76f8\u5173\u7684\u5185\u5bb9\u3002</p>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/12-CTest%20%E5%B7%A5%E5%85%B7/#21","title":"2.1 \u542f\u7528\u6d4b\u8bd5","text":"<p>\u5728\u6dfb\u52a0\u6d4b\u8bd5\u4e4b\u524d\uff0c\u6211\u4eec\u9700\u8981\u5728 <code>CMakeLists.txt</code> \u6587\u4ef6\u4e2d\u542f\u7528\u6d4b\u8bd5\u3002\u542f\u7528\u6d4b\u8bd5\u7684\u65b9\u6cd5\u662f\u5728 <code>CMakeLists.txt</code> \u6587\u4ef6\u4e2d\u6dfb\u52a0</p> <pre><code>enable_testing()\n</code></pre> <p>\u6211\u4eec\u5148\u51c6\u5907\u4e00\u4e2a\u7b80\u5355\u7684\u8ba1\u7b97\u4e24\u6570\u4e4b\u548c\u7684\u9879\u76ee\uff0c\u76ee\u5f55\u5982\u4e0b</p> <pre><code>Add\n\u251c\u2500\u2500 CMakeLists.txt\n\u251c\u2500\u2500 main.cpp\n\u251c\u2500\u2500 add.cpp\n\u2514\u2500\u2500 add.hpp\n</code></pre> <p>::: code-tabs</p> <p>@tab <code>add.cpp</code></p> <pre><code>#include \"add.hpp\"\n\nint add(int a, int b)\n{\n    return a + b;\n}\n</code></pre> <p>@tab <code>add.hpp</code></p> <pre><code>#ifndef ADD_HPP\n#define ADD_HPP\n\nint add(int a, int b);\n\n#endif // ADD_HPP\n</code></pre> <p>@tab <code>main.cpp</code></p> <p>```cpp :collapsed-lines=6</p>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/12-CTest%20%E5%B7%A5%E5%85%B7/#include","title":"include","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/12-CTest%20%E5%B7%A5%E5%85%B7/#include_1","title":"include","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/12-CTest%20%E5%B7%A5%E5%85%B7/#include-addhpp","title":"include \"add.hpp\" <p>int main(int argc, char *argv[]) {     if (argc &lt; 4)     {         printf(\"Usage: %s   \\n\", argv[0]);         return -1;     } <pre><code>int a = std::atoi(argv[1]);\nint b = std::atoi(argv[2]);\nint predict = std::atoi(argv[3]);\nint sum = add(a, b);\nreturn sum == predict ? 0 : -1;\n</code></pre> <p>} <code>:::  \u8fd9\u662f\u4e00\u4e2a\u7b80\u5355\u7684\u8ba1\u7b97\u4e24\u6570\u4e4b\u548c\u7684\u9879\u76ee\uff0c\u9700\u8981\u7528\u6237\u8f93\u5165 3 \u4e2a\u547d\u4ee4\u884c\u53c2\u6570\uff0c\u5206\u522b\u662f\u4e24\u4e2a\u52a0\u6570\u548c\u9884\u671f\u7684\u548c\u3002\u5982\u679c\u8ba1\u7b97\u7ed3\u679c\u4e0e\u9884\u671f\u7684\u548c\u76f8\u7b49\uff0c\u5219\u8fd4\u56de `0`\uff0c\u5426\u5219\u8fd4\u56de `-1`\u3002\u7136\u540e\uff0c\u6211\u4eec\u5728 `CMakeLists.txt` \u6587\u4ef6\u4e2d\u5199\u5165\u4ee5\u4e0b\u5185\u5bb9</code>cmake cmake_minimum_required(VERSION 3.16)  project(Add)  add_library(add STATIC add.cpp) add_executable(demo main.cpp)  target_link_libraries(demo PRIVATE add)  enable_testing() ```</p> <p>\u81f3\u6b64\uff0c\u6211\u4eec\u5b8c\u6210\u4e86\u6d4b\u8bd5\u7684\u524d\u671f\u51c6\u5907\u5de5\u4f5c\u3002</p>","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/12-CTest%20%E5%B7%A5%E5%85%B7/#22","title":"2.2 \u6dfb\u52a0\u6d4b\u8bd5","text":"<p>\u5728 <code>CMakeLists.txt</code> \u6587\u4ef6\u4e2d\u6dfb\u52a0\u6d4b\u8bd5\u7684\u65b9\u6cd5\u662f\u4f7f\u7528 <code>add_test</code> \u547d\u4ee4\u3002<code>add_test</code> \u547d\u4ee4\u7684\u8bed\u6cd5\u5982\u4e0b</p> <pre><code>add_test(\n  NAME &lt;name&gt;                         # \u6d4b\u8bd5\u7684\u540d\u79f0\uff0c\u53ef\u4ee5\u968f\u4fbf\u5199\uff0c\u4f46\u6700\u597d\u89c1\u540d\u77e5\u610f\n  COMMAND &lt;command&gt; [arg1 [arg2 ...]] # \u6d4b\u8bd5\u7684\u547d\u4ee4\uff0c\u53ef\u4ee5\u662f\u4e00\u4e2a\u53ef\u6267\u884c\u6587\u4ef6\u6216\u4e00\u4e2a\u811a\u672c\n)\n</code></pre> <p>\u5176\u4e2d\uff0c<code>name</code> \u662f\u6d4b\u8bd5\u7684\u540d\u79f0\uff0c<code>command</code> \u662f\u6d4b\u8bd5\u7684\u547d\u4ee4\u3002\u6211\u4eec\u5728 <code>CMakeLists.txt</code> \u6587\u4ef6\u672b\u5c3e\u5199\u5165\u4ee5\u4e0b\u5185\u5bb9\u4ee5\u6dfb\u52a0 5 \u4e2a\u6d4b\u8bd5</p> <pre><code>add_test(NAME AddTest.positive COMMAND demo 1 2 3)\nadd_test(NAME AddTest.negative COMMAND demo -1 -2 -3)\nadd_test(NAME AddTest.zero COMMAND demo 0 0 0)\nadd_test(NAME AddTest.mixed COMMAND demo 1 -2 -1)\nadd_test(NAME AddTest.failed_example COMMAND demo 1 2 4)\n</code></pre>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/12-CTest%20%E5%B7%A5%E5%85%B7/#23","title":"2.3 \u8fd0\u884c\u6d4b\u8bd5","text":"<p>\u5728\u9879\u76ee\u6839\u76ee\u5f55\u4e0b\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\uff0c\u6784\u5efa\u9879\u76ee</p> <pre><code>mkdir build\ncd build\ncmake ..\ncmake --build .\n</code></pre> <p>\u7136\u540e\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u8fd0\u884c\u6d4b\u8bd5</p> <pre><code>ctest\n</code></pre> <p>\u8fd0\u884c\u7ed3\u679c\u5982\u4e0b</p> <pre><code>Test project /path/to/Add/build\n    Start 1: AddTest.positive\n1/5 Test #1: AddTest.positive .................   Passed    0.00 sec\n    Start 2: AddTest.negative\n2/5 Test #2: AddTest.negative .................   Passed    0.00 sec\n    Start 3: AddTest.zero\n3/5 Test #3: AddTest.zero .....................   Passed    0.00 sec\n    Start 4: AddTest.mixed\n4/5 Test #4: AddTest.mixed ....................   Passed    0.00 sec\n    Start 5: AddTest.failed_example\n5/5 Test #5: AddTest.failed_example ...........***Failed    0.00 sec\n\n80% tests passed, 1 tests failed out of 5\n\nTotal Test time (real) =   0.01 sec\n</code></pre>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/12-CTest%20%E5%B7%A5%E5%85%B7/#3-googletest","title":"3. \u4e0e GoogleTest \u7ed3\u5408\u4f7f\u7528","text":"<p>GoogleTest \u662f Google \u5f00\u53d1\u7684\u4e00\u4e2a C++ \u6d4b\u8bd5\u6846\u67b6\uff0c\u5b83\u63d0\u4f9b\u4e86\u4e30\u5bcc\u7684\u65ad\u8a00\u548c\u6d4b\u8bd5\u7528\u4f8b\u7ba1\u7406\u529f\u80fd\uff0cCMake \u4e5f\u63d0\u4f9b\u4e86 GoogleTest \u76f8\u5173\u7684\u5b8f\u548c\u51fd\u6570\uff0c\u53ef\u4ee5\u5f88\u65b9\u4fbf\u7684\u5c06 GoogleTest \u4e0e CTest \u96c6\u6210\u3002</p>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/12-CTest%20%E5%B7%A5%E5%85%B7/#31","title":"3.1 \u6587\u4ef6\u51c6\u5907","text":"<p>\u9996\u5148\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u5220\u9664 <code>main.cpp</code> \u6587\u4ef6\uff0c\u4f46\u53ef\u4ee5\u6dfb\u52a0\u4e00\u4e2a\u6d4b\u8bd5\u6587\u4ef6 <code>test_add.cpp</code>\uff0c\u53d8\u66f4\u540e\u7684\u76ee\u5f55\u7ed3\u6784\u5982\u4e0b</p> <pre><code>Add\n\u251c\u2500\u2500 CMakeLists.txt\n\u251c\u2500\u2500 add.cpp\n\u251c\u2500\u2500 add.hpp\n\u2514\u2500\u2500 test_add.cpp\n</code></pre> <p><code>test_add.cpp</code> \u6587\u4ef6\u5185\u5bb9\u5982\u4e0b</p> <pre><code>#include &lt;gtest/gtest.h&gt;\n\n#include \"add.hpp\"\n\nTEST(AddTest, Positive) { EXPECT_EQ(add(1, 2), 3); }\nTEST(AddTest, Negative) { EXPECT_EQ(add(-1, -2), -3); }\nTEST(AddTest, Zero) { EXPECT_EQ(add(0, 0), 0); }\nTEST(AddTest, Mixed) { EXPECT_EQ(add(1, -2), -1); }\nTEST(AddTest, FailedExample) { EXPECT_EQ(add(1, 2), 4); }\n</code></pre> <p>\u7136\u540e\uff0c\u6211\u4eec\u6539\u5199 <code>CMakeLists.txt</code> \u6587\u4ef6\uff0c\u4f7f\u5176\u652f\u6301 GoogleTest \u6d4b\u8bd5\u6846\u67b6\u3002\u6539\u5199\u540e\u7684 <code>CMakeLists.txt</code> \u6587\u4ef6\u5185\u5bb9\u5982\u4e0b</p> <pre><code>cmake_minimum_required(VERSION 3.16)\n\nproject(Add)\n\nadd_library(add STATIC add.cpp)\n# \u5148\u4e0d\u8981\u7591\u60d1\u4e3a\u4ec0\u4e48 test_add.cpp \u6ca1\u6709 main \u51fd\u6570\u4e5f\u53ef\u4ee5\u7f16\u8bd1\u6210\u53ef\u6267\u884c\u6587\u4ef6\uff0c\u540e\u9762\u4f1a\u89e3\u91ca\nadd_executable(test_add test_add.cpp)\n\nfind_package(GTest REQUIRED) # \u5bfb\u627e GTest \u5e93\ninclude(GoogleTest)          # \u4f7f\u7528 GoogleTest \u63d0\u4f9b\u7684 CMake \u51fd\u6570\n\n# GTest::gtest_main \u63d0\u4f9b\u4e86 main \u51fd\u6570\uff0c\u56e0\u6b64 test_add.cpp \u4e0d\u9700\u8981\u989d\u5916\u63d0\u4f9b main \u51fd\u6570\ntarget_link_libraries(test_add\n  PRIVATE add GTest::gtest_main\n)\n\nenable_testing()\n\n# \u81ea\u52a8\u6dfb\u52a0 GoogleTest \u6d4b\u8bd5\u7528\u4f8b\ngtest_discover_tests(test_add)\n</code></pre>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/12-CTest%20%E5%B7%A5%E5%85%B7/#32","title":"3.2 \u8fd0\u884c\u6d4b\u8bd5","text":"<p>\u5728\u9879\u76ee\u6839\u76ee\u5f55\u4e0b\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\uff0c\u6784\u5efa\u9879\u76ee</p> <pre><code>mkdir build\ncd build\ncmake ..\ncmake --build .\n</code></pre> <p>\u6700\u540e\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u8fd0\u884c\u6d4b\u8bd5</p> <pre><code>ctest\n</code></pre> <p>\u8fd0\u884c\u7ed3\u679c\u5982\u4e0b</p> <pre><code>Test project /path/to/Add/build\n    Start 1: AddTest.Positive\n1/5 Test #1: AddTest.Positive .................   Passed    0.00 sec\n    Start 2: AddTest.Negative\n2/5 Test #2: AddTest.Negative .................   Passed    0.00 sec\n    Start 3: AddTest.Zero\n3/5 Test #3: AddTest.Zero .....................   Passed    0.00 sec\n    Start 4: AddTest.Mixed\n4/5 Test #4: AddTest.Mixed ....................   Passed    0.00 sec\n    Start 5: AddTest.FailedExample\n5/5 Test #5: AddTest.FailedExample ............***Failed    0.00 sec\n\n80% tests passed, 1 tests failed out of 5\n\nTotal Test time (real) =   0.01 sec\n</code></pre>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/13-CPack%20%E5%B7%A5%E5%85%B7/","title":"\u301013\u3011CPack \u5de5\u5177","text":"<p>::: warning \u672a\u5b8c\u6210... :::</p>"},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/13-CPack%20%E5%B7%A5%E5%85%B7/#1","title":"1. \u7b80\u4ecb","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/13-CPack%20%E5%B7%A5%E5%85%B7/#11-cpack","title":"1.1 CPack \u7684\u57fa\u672c\u4ecb\u7ecd","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/13-CPack%20%E5%B7%A5%E5%85%B7/#12-cpack","title":"1.2 CPack \u652f\u6301\u7684\u751f\u6210\u5668","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/13-CPack%20%E5%B7%A5%E5%85%B7/#2-cpack","title":"2. CPack \u7684\u57fa\u672c\u4f7f\u7528","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/13-CPack%20%E5%B7%A5%E5%85%B7/#21-cpack","title":"2.1 \u901a\u7528 CPack \u914d\u7f6e","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/13-CPack%20%E5%B7%A5%E5%85%B7/#22-cpack","title":"2.2 \u90e8\u5206\u751f\u6210\u5668 CPack \u914d\u7f6e","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/13-CPack%20%E5%B7%A5%E5%85%B7/#debian-cpack","title":"Debian \u751f\u6210\u5668 CPack \u4e13\u5c5e\u914d\u7f6e","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/13-CPack%20%E5%B7%A5%E5%85%B7/#nsis-cpack","title":"NSIS \u751f\u6210\u5668 CPack \u4e13\u5c5e\u914d\u7f6e","text":""},{"location":"%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/cmake/13-CPack%20%E5%B7%A5%E5%85%B7/#3-cpack","title":"3. \u9879\u76ee CPack \u6587\u4ef6\u7684\u5199\u6cd5","text":"<p>\u7528\u4e8e\u6253\u5305\u7684 CPack \u914d\u7f6e\u6587\u4ef6\u547d\u540d\u6ca1\u6709\u7279\u522b\u7684\u8bb2\u7a76\uff0c\u6bd4\u65b9\u8bf4 OpenCV \u7684 CPack \u914d\u7f6e\u6587\u4ef6\u547d\u540d\u4e3a <code>OpenCVPackaging.cmake</code>\uff0c\u56e0\u6b64\u6211\u4eec\u53ef\u4ee5\u5c06 CPack \u914d\u7f6e\u6587\u4ef6\u547d\u540d\u4e3a <code>&lt;PackageName&gt;Packaging.cmake</code>\uff0c\u5e76\u653e\u7f6e\u5728\u9879\u76ee <code>cmake</code> \u76ee\u5f55\u4e0b\u3002</p>"}]}